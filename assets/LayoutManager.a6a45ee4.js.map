{"version":3,"file":"LayoutManager.a6a45ee4.js","sources":["../../node_modules/@deck.gl/core/dist/esm/effects/lighting/point-light.js","../../src/components/PlaybackControls.vue","../../src/components/PlaybackControls.vue?vue&type=template&lang.js","../../src/plugins/xmas-kelheim/SettingsPanel.vue","../../src/plugins/xmas-kelheim/SettingsPanel.vue?vue&type=template&lang.js","../../src/plugins/xmas-kelheim/eventParser.ts","../../src/plugins/xmas-kelheim/DrtRequestLayer.tsx","../../src/layers/moving-icons/icon-layer.glsl.vert?raw","../../src/layers/moving-icons/icon-layer.glsl.frag?raw","../../src/layers/moving-icons/icon-manager.ts","../../src/layers/moving-icons/moving-icons-layer.ts","../../src/layers/moving-icons/moving-icons-vehicles-layer.ts","../../src/layers/PathTraceLayer.ts","../../src/plugins/xmas-kelheim/TripViz.tsx","../../src/plugins/xmas-kelheim/VehicleAnimation.vue","../../src/plugins/xmas-kelheim/LegendColors.tsx","../../src/plugins/xmas-kelheim/VehicleAnimation.vue?vue&type=template&lang.js","../../node_modules/lil-gui/dist/lil-gui.esm.js","../../src/components/TimeSlider.vue","../../src/components/TimeSlider.vue?vue&type=template&lang.js","../../src/plugins/event-viewer/EventDeckMap.tsx","../../src/plugins/event-viewer/EventViewer.vue","../../src/plugins/event-viewer/EventViewer.vue?vue&type=template&lang.js","../../src/plugins/vehicle-animation/SettingsPanel.vue","../../src/plugins/vehicle-animation/SettingsPanel.vue?vue&type=template&lang.js","../../src/plugins/vehicle-animation/DrtRequestLayer.tsx","../../src/plugins/vehicle-animation/TripViz.tsx","../../src/plugins/vehicle-animation/VehicleAnimation.vue","../../src/plugins/vehicle-animation/LegendColors.tsx","../../src/plugins/vehicle-animation/VehicleAnimation.vue?vue&type=template&lang.js","../../src/plugins/calculation-table/CalculationTable.vue","../../src/plugins/calculation-table/CalculationTable.vue?vue&type=template&lang.js","../../src/plugins/calculation-table/assets/table.png","../../src/plugins/video-player/VideoPlayer.vue","../../src/plugins/video-player/VideoPlayer.vue?vue&type=template&lang.js","../../src/plugins/image/ImageView.vue","../../src/plugins/image/ImageView.vue?vue&type=template&lang.js","../../src/plugins/xy-time/ScatterplotColorBinsLayer.ts","../../src/plugins/xy-time/XyTimeDeckMap.tsx","../../src/plugins/xy-time/XyTime.vue","../../src/plugins/xy-time/XyTime.vue?vue&type=template&lang.js","../../src/plugins/pluginRegistry.ts","../../node_modules/dompurify/dist/purify.es.js","../../node_modules/medium-zoom/dist/medium-zoom.esm.js","../../src/components/TopsheetsFinder/TopsheetsFinder.vue","../../src/components/TopsheetsFinder/TopsheetsFinder.vue?vue&type=template&lang.js","../../src/layout-manager/FolderBrowser.vue","../../src/layout-manager/FolderBrowser.vue?vue&type=template&lang.js","../../src/layout-manager/TabbedDashboardView.vue","../../src/layout-manager/TabbedDashboardView.vue?vue&type=template&lang.js","../../src/components/FileSystemProjects.vue","../../src/components/FileSystemProjects.vue?vue&type=template&lang.js","../../src/assets/info-bottom.md?vue&type=template&lang.js","../../src/layout-manager/SplashPage.vue","../../src/layout-manager/SplashPage.vue?vue&type=template&lang.js","../../src/assets/simwrapper-logo/SW_logo_yellow.png","../../src/assets/simwrapper-logo/SW_logo_purple.png","../../src/components/left-panels/LeftIconPanel.vue","../../src/assets/icons/files.svg","../../src/assets/icons/issues.svg","../../src/assets/icons/readme.svg","../../src/assets/icons/settings.svg","../../src/components/left-panels/LeftIconPanel.vue?vue&type=template&lang.js","../../src/components/left-panels/ErrorPanel.vue","../../src/components/left-panels/ErrorPanel.vue?vue&type=template&lang.js","../../src/components/left-panels/AddDataSource.vue","../../src/components/left-panels/AddDataSource.vue?vue&type=template&lang.js","../../src/components/left-panels/BrowserPanel.vue","../../src/components/left-panels/BrowserPanel.vue?vue&type=template&lang.js","../../src/components/left-panels/SettingsPanel.vue","../../src/components/left-panels/SettingsPanel.vue?vue&type=template&lang.js","../../src/layout-manager/LayoutManager.vue","../../src/layout-manager/LayoutManager.vue?vue&type=template&lang.js"],"sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { projectPosition } from '../../shaderlib/project/project-functions';\nimport { COORDINATE_SYSTEM } from '../../lib/constants';\nconst DEFAULT_LIGHT_COLOR = [255, 255, 255];\nconst DEFAULT_LIGHT_INTENSITY = 1.0;\nconst DEFAULT_ATTENUATION = [0, 0, 1];\nconst DEFAULT_LIGHT_POSITION = [0.0, 0.0, 1.0];\nlet idCount = 0;\nexport class PointLight {\n  constructor(props = {}) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"color\", void 0);\n\n    _defineProperty(this, \"intensity\", void 0);\n\n    _defineProperty(this, \"type\", 'point');\n\n    _defineProperty(this, \"position\", void 0);\n\n    _defineProperty(this, \"attenuation\", void 0);\n\n    _defineProperty(this, \"projectedLight\", void 0);\n\n    const {\n      color = DEFAULT_LIGHT_COLOR\n    } = props;\n    const {\n      intensity = DEFAULT_LIGHT_INTENSITY\n    } = props;\n    const {\n      position = DEFAULT_LIGHT_POSITION\n    } = props;\n    this.id = props.id || \"point-\".concat(idCount++);\n    this.color = color;\n    this.intensity = intensity;\n    this.type = 'point';\n    this.position = position;\n    this.attenuation = getAttenuation(props);\n    this.projectedLight = { ...this\n    };\n  }\n\n  getProjectedLight({\n    layer\n  }) {\n    const {\n      projectedLight\n    } = this;\n    const viewport = layer.context.viewport;\n    const {\n      coordinateSystem,\n      coordinateOrigin\n    } = layer.props;\n    const position = projectPosition(this.position, {\n      viewport,\n      coordinateSystem,\n      coordinateOrigin,\n      fromCoordinateSystem: viewport.isGeospatial ? COORDINATE_SYSTEM.LNGLAT : COORDINATE_SYSTEM.CARTESIAN,\n      fromCoordinateOrigin: [0, 0, 0]\n    });\n    projectedLight.color = this.color;\n    projectedLight.intensity = this.intensity;\n    projectedLight.position = position;\n    return projectedLight;\n  }\n\n}\n\nfunction getAttenuation(props) {\n  if (props.attenuation) {\n    return props.attenuation;\n  }\n\n  if ('intensity' in props) {\n    return [0, 0, props.intensity || 0];\n  }\n\n  return DEFAULT_ATTENUATION;\n}\n//# sourceMappingURL=point-light.js.map","<template lang=\"pug\">\r\n.slider-thingy\r\n  b-slider.slider(\r\n    v-model=\"sliderValue\"\r\n    v-bind=\"sliderOptions\"\r\n    size=\"is-large\"\r\n    @dragging=\"dragging\"\r\n    @dragstart=\"dragStart\"\r\n    @dragend=\"dragEnd\")\r\n\r\n  .buttons\r\n    .playpause(@click='toggleSimulation')\r\n      i.button-icon.fa.fa-1x.fa-pause(v-if=\"isRunning\")\r\n      i.button-icon.fa.fa-1x.fa-play(v-else)\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport * as timeConvert from 'convert-seconds'\r\n\r\nexport default defineComponent({\r\n  name: 'PlaybackControls',\r\n  props: {\r\n    isRunning: { type: Boolean, required: true },\r\n    timeStart: { type: Number, required: true },\r\n    timeEnd: { type: Number, required: true },\r\n    currentTime: { type: Number, required: true },\r\n  },\r\n  data: () => {\r\n    return {\r\n      pauseWhileDragging: false,\r\n      sliderValue: 0,\r\n      sliderOptions: {\r\n        min: 0,\r\n        max: 1000000,\r\n        clickable: false,\r\n        duration: 0,\r\n        lazy: true,\r\n        tooltip: true,\r\n        'tooltip-placement': 'top',\r\n      } as any,\r\n    }\r\n  },\r\n  mounted() {\r\n    this.sliderOptions['custom-formatter'] = (v: number) => {\r\n      return this.convertSecondsToClockTimeMinutes(v)\r\n    }\r\n    window.addEventListener('keyup', this.onKeyPressed)\r\n  },\r\n\r\n  beforeDestroy() {\r\n    window.removeEventListener('keyup', this.onKeyPressed)\r\n  },\r\n  watch: {\r\n    currentTime() {\r\n      this.sliderValue =\r\n        (1000000.0 * (this.currentTime - this.timeStart)) / (this.timeEnd - this.timeStart)\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    toggleSimulation() {\r\n      this.$emit('click')\r\n    },\r\n\r\n    convertSecondsToClockTimeMinutes(index: number) {\r\n      const seconds = this.getSecondsFromSlider(index)\r\n\r\n      try {\r\n        const hms = timeConvert(seconds)\r\n        const minutes = ('00' + hms.minutes).slice(-2)\r\n        return `${hms.hours}:${minutes}`\r\n      } catch (e) {\r\n        return '00:00'\r\n      }\r\n    },\r\n\r\n    dragStart() {\r\n      if (this.isRunning) {\r\n        this.pauseWhileDragging = true\r\n        this.$emit('click')\r\n      }\r\n    },\r\n\r\n    dragEnd() {\r\n      if (this.pauseWhileDragging) this.$emit('click')\r\n      this.pauseWhileDragging = false\r\n    },\r\n\r\n    dragging(value: number) {\r\n      this.$emit('time', this.getSecondsFromSlider(value))\r\n    },\r\n\r\n    onKeyPressed(ev: KeyboardEvent) {\r\n      if (ev.code === 'Space') this.toggleSimulation()\r\n    },\r\n\r\n    getSecondsFromSlider(value: number) {\r\n      let seconds = ((this.timeEnd - this.timeStart) * value) / 1000000.0\r\n      if (seconds === this.timeEnd) seconds = this.timeEnd - 1\r\n      return seconds\r\n    },\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.slider-thingy {\r\n  display: flex;\r\n  flex-direction: row;\r\n  z-index: 1;\r\n}\r\n\r\n.slider {\r\n  margin: auto 0;\r\n  flex: 1;\r\n  font-weight: bold;\r\n}\r\n\r\n.buttons {\r\n  margin: 0 0 0 2rem;\r\n}\r\n\r\n.playpause {\r\n  width: 3rem;\r\n  height: 3rem;\r\n  border-radius: 50%;\r\n  color: white;\r\n  background-color: $themeColor;\r\n  display: flex;\r\n  text-align: center;\r\n  // box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.25);\r\n  cursor: pointer;\r\n  pointer-events: auto;\r\n}\r\n\r\n.playpause:hover {\r\n  background-color: #39a8f1;\r\n  border: 2px solid white;\r\n}\r\n\r\n.button-icon {\r\n  margin: auto auto;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n  .slider-thingy {\r\n    display: flex;\r\n    flex-direction: row;\r\n  }\r\n\r\n  .slider {\r\n    flex: 1;\r\n    margin: auto 0rem;\r\n  }\r\n\r\n  .buttons {\r\n    margin: 0.25rem 0 0 2rem;\r\n  }\r\n}\r\n</style>\r\n","\r\n.slider-thingy\r\n  b-slider.slider(\r\n    v-model=\"sliderValue\"\r\n    v-bind=\"sliderOptions\"\r\n    size=\"is-large\"\r\n    @dragging=\"dragging\"\r\n    @dragstart=\"dragStart\"\r\n    @dragend=\"dragEnd\")\r\n\r\n  .buttons\r\n    .playpause(@click='toggleSimulation')\r\n      i.button-icon.fa.fa-1x.fa-pause(v-if=\"isRunning\")\r\n      i.button-icon.fa.fa-1x.fa-play(v-else)\r\n\r\n","<template lang=\"pug\">\r\n.settings-panel-content\r\n  h4 {{ $t('showhide')}}\r\n\r\n  .items\r\n    .row(:key=\"label\" v-for=\"label in Object.keys(items)\")\r\n      toggle-button.toggle(\r\n        :width=\"40\"\r\n        :value=\"items[label]\"\r\n        :labels=\"false\"\r\n        :color=\"{checked: '#4b7cc4', unchecked: '#222'}\"\r\n        @change=\"$emit('click',label)\")\r\n      label(v-html=\"$t(label)\")\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      requests: 'DRT&nbsp;Requests',\r\n      passengers: 'Passengers',\r\n      search: 'Search',\r\n      showhide: 'Show/Hide',\r\n      vehicles: 'DRT Vehicles',\r\n      routes: 'Routes',\r\n      speed: 'Speed',\r\n      backgroundTraffic: 'All Traffic',\r\n    },\r\n    de: {\r\n      requests: 'DRT&nbsp;Anfragen',\r\n      passengers: 'Passagiere',\r\n      search: 'Suche',\r\n      showhide: 'Ein-/Ausblenden',\r\n      vehicles: 'DRT Fahrzeuge',\r\n      routes: 'Routen',\r\n      speed: 'Geschwindigkeit',\r\n      backgroundTraffic: 'Alle Fahrzeuge',\r\n    },\r\n  },\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\nimport { ToggleButton } from 'vue-js-toggle-button'\r\n\r\nexport default defineComponent({\r\n  name: 'XmasSettingsPanel',\r\n  i18n,\r\n  components: { ToggleButton },\r\n  props: {\r\n    items: { type: Object, required: true },\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.settings-panel-content {\r\n  margin: 2rem 0.25rem 0 0.25rem;\r\n}\r\n\r\nh4 {\r\n  font-weight: bold;\r\n  font-size: 0.8rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.row {\r\n  display: 'block';\r\n  flex-direction: 'column';\r\n}\r\n\r\nlabel {\r\n  margin: auto 0 auto 0rem;\r\n  text-align: 'left';\r\n}\r\n\r\n.toggle {\r\n  margin-bottom: 0.25rem;\r\n  margin-right: 0.5rem;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n  .items {\r\n    display: flex;\r\n  }\r\n  .items .row {\r\n    flex: 1;\r\n  }\r\n\r\n  .settings-panel-content {\r\n    margin-top: 0;\r\n  }\r\n}\r\n</style>\r\n","\r\n.settings-panel-content\r\n  h4 {{ $t('showhide')}}\r\n\r\n  .items\r\n    .row(:key=\"label\" v-for=\"label in Object.keys(items)\")\r\n      toggle-button.toggle(\r\n        :width=\"40\"\r\n        :value=\"items[label]\"\r\n        :labels=\"false\"\r\n        :color=\"{checked: '#4b7cc4', unchecked: '#222'}\"\r\n        @change=\"$emit('click',label)\")\r\n      label(v-html=\"$t(label)\")\r\n\r\n","// This fetches all folders from all root filesystems, and returns\r\nimport store from '@/store'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\nimport { FileSystemConfig } from '@/Globals'\r\nimport DashboardDataManager, { NetworkLinks } from '@/js/DashboardDataManager'\r\nimport MATSimEventStreamer from '@/workers/MATSimEventStreamer.worker.ts?worker'\r\n\r\nexport default class EventParser {\r\n  private fileApi: HTTPFileSystem\r\n  private linkIdLookup = {} as any\r\n  private network!: NetworkLinks\r\n  private eventWorker: any\r\n  private eventLayers = [] as any[]\r\n  private range = [Infinity, -Infinity]\r\n  private timeRange = [Infinity, -Infinity]\r\n  private $emit: any = () => {}\r\n  private boundBox = [] as number[][]\r\n\r\n  // these must be passed into constructor\r\n  private params: {\r\n    fileSystem: FileSystemConfig\r\n    dataManager: DashboardDataManager\r\n    vizDetails: any\r\n    subfolder: string\r\n  }\r\n\r\n  constructor(props: {\r\n    fileSystem: FileSystemConfig\r\n    dataManager: DashboardDataManager\r\n    vizDetails: any\r\n    subfolder: string\r\n    $emit?: any\r\n    boundBox?: number[][]\r\n  }) {\r\n    this.params = { ...props }\r\n    this.fileApi = new HTTPFileSystem(props.fileSystem)\r\n    if (props.$emit) this.$emit = props.$emit\r\n    if (props.boundBox) this.boundBox = props.boundBox\r\n  }\r\n\r\n  public async loadFiles() {\r\n    const { network, linkIdLookup } = await this.loadNetwork()\r\n    this.network = network\r\n    this.linkIdLookup = linkIdLookup\r\n\r\n    try {\r\n      let filename = `${this.params.subfolder}/${this.params.vizDetails.events}`\r\n      const layers = await this.streamEventFile(filename)\r\n      return layers\r\n    } catch (e) {\r\n      console.error(e)\r\n      throw Error('' + e)\r\n    }\r\n    return []\r\n  }\r\n\r\n  private async loadNetwork() {\r\n    // get network\r\n    let networkFilename = this.params.vizDetails.events.replace('events.xml', 'network.xml')\r\n    const network = await this.params.dataManager.getRoadNetwork(\r\n      networkFilename,\r\n      this.params.subfolder,\r\n      Object.assign({ projection: '25833' }, this.params.vizDetails)\r\n    )\r\n    // build i-based mapping of id strings\r\n    const linkIdLookup = {} as any\r\n    network.linkIds.forEach((link: any, i: number) => {\r\n      linkIdLookup[`${link}`] = i\r\n    })\r\n\r\n    return { network, linkIdLookup }\r\n  }\r\n\r\n  private streamEventFile(filename: string): Promise<any[]> {\r\n    const promise: Promise<any[]> = new Promise((resolve, reject) => {\r\n      const finishedLoadingData = (totalRows: number, data: any) => {\r\n        console.log('FINAL time', this.timeRange)\r\n        this.$emit('finished')\r\n        this.eventWorker.terminate()\r\n        console.log('DONE: layers', this.eventLayers.length)\r\n\r\n        console.log('ALL DONE', { totalRows, data: data.range, time: this.timeRange })\r\n        this.range = data.range\r\n        resolve(this.eventLayers)\r\n      }\r\n\r\n      this.$emit('status', 'Loading file...')\r\n      let totalRows = 0\r\n      this.range = [Infinity, -Infinity]\r\n      this.timeRange = [Infinity, -Infinity]\r\n\r\n      // get the raw unzipped arraybuffer\r\n      if (this.eventWorker) this.eventWorker.terminate()\r\n      this.eventLayers = []\r\n      this.eventWorker = new MATSimEventStreamer()\r\n\r\n      const formatter = Intl.NumberFormat()\r\n\r\n      this.eventWorker.onmessage = async (event: MessageEvent) => {\r\n        const message = event.data\r\n        if (message.status) {\r\n          this.$emit('status', message.status)\r\n        } else if (message.error) {\r\n          throw Error(message.error)\r\n        } else if (message.finished) {\r\n          finishedLoadingData(totalRows, message)\r\n          return\r\n        } else {\r\n          const events = message.events as any[]\r\n\r\n          console.log(events.length)\r\n\r\n          totalRows += events.length\r\n          this.$emit('status', 'Loading ' + formatter.format(totalRows) + ' events...')\r\n\r\n          // minmax all events\r\n          this.timeRange = [\r\n            Math.min(this.timeRange[0], events[0].time),\r\n            Math.max(this.timeRange[1], events[events.length - 1].time),\r\n          ]\r\n\r\n          // minmax vehicle trips specifically\r\n          this.timeRange = [\r\n            Math.min(this.timeRange[0], message.vehicleTrips[0].t0),\r\n            Math.max(this.timeRange[1], message.vehicleTrips[message.vehicleTrips.length - 1].t1),\r\n          ]\r\n\r\n          // VEHICLES -----------\r\n\r\n          // if we have a bounding box, filter the links\r\n          let vehicleTrips = message.vehicleTrips\r\n          console.log('ROIGINAL LENGHT', vehicleTrips.length)\r\n          if (this.boundBox.length) {\r\n            const orig = this.network.source\r\n            const dest = this.network.dest\r\n            vehicleTrips = message.vehicleTrips.filter((trip: any) => {\r\n              const offset = 2 * this.linkIdLookup[trip.link]\r\n              return (\r\n                orig[offset] > this.boundBox[0][0] &&\r\n                orig[offset] < this.boundBox[1][0] &&\r\n                orig[offset + 1] > this.boundBox[0][1] &&\r\n                orig[offset + 1] < this.boundBox[1][1] &&\r\n                dest[offset] > this.boundBox[0][0] &&\r\n                dest[offset] < this.boundBox[1][0] &&\r\n                dest[offset + 1] > this.boundBox[0][1] &&\r\n                dest[offset + 1] < this.boundBox[1][1]\r\n              )\r\n            })\r\n            console.log('FILTERED LENGTH:', vehicleTrips.length)\r\n          }\r\n\r\n          const numTrips = vehicleTrips.length\r\n          const tripData = {\r\n            locO: new Float32Array(2 * numTrips).fill(NaN),\r\n            locD: new Float32Array(2 * numTrips).fill(NaN),\r\n            t0: new Float32Array(numTrips).fill(NaN),\r\n            t1: new Float32Array(numTrips).fill(NaN),\r\n          }\r\n\r\n          for (let i = 0; i < numTrips; i++) {\r\n            const trip = vehicleTrips[i]\r\n            const offset = 2 * this.linkIdLookup[trip.link]\r\n            tripData.locO[i * 2 + 0] = this.network.source[0 + offset]\r\n            tripData.locO[i * 2 + 1] = this.network.source[1 + offset]\r\n            tripData.locD[i * 2 + 0] = this.network.dest[0 + offset]\r\n            tripData.locD[i * 2 + 1] = this.network.dest[1 + offset]\r\n            // enter/leave traffic happen in the middle of the link\r\n            if (i == 0) {\r\n              tripData.locO[i * 2 + 0] = 0.5 * (tripData.locO[i * 2 + 0] + tripData.locD[i * 2 + 0])\r\n              tripData.locO[i * 2 + 1] = 0.5 * (tripData.locO[i * 2 + 1] + tripData.locD[i * 2 + 1])\r\n            } else if (i == numTrips - 1) {\r\n              tripData.locD[i * 2 + 0] = 0.5 * (tripData.locO[i * 2 + 0] + tripData.locD[i * 2 + 0])\r\n              tripData.locD[i * 2 + 1] = 0.5 * (tripData.locO[i * 2 + 1] + tripData.locD[i * 2 + 1])\r\n            }\r\n            tripData.t0[i] = trip.t0\r\n            tripData.t1[i] = trip.t1\r\n          }\r\n\r\n          // ALL DONE --------\r\n          this.eventLayers.push({\r\n            vehicles: tripData,\r\n          })\r\n        }\r\n      }\r\n\r\n      this.eventWorker.postMessage({\r\n        filePath: filename,\r\n        fileSystem: this.params.fileSystem,\r\n        projection: this.params.vizDetails.projection,\r\n        boundBox: this.boundBox,\r\n      })\r\n    })\r\n    return promise\r\n  }\r\n}\r\n","import { ArcLayer } from '@deck.gl/layers'\r\n\r\nconst defaultProps = {\r\n  currentTime: { type: 'number', value: 0, min: 0 },\r\n  getTimeStart: { type: 'accessor', value: null },\r\n  getTimeEnd: { type: 'accessor', value: null },\r\n  searchFlag: { type: 'number', value: 0 },\r\n}\r\n\r\nexport default class DrtRequestArcLayer extends ArcLayer {\r\n  getShaders() {\r\n    const shaders = super.getShaders()\r\n    shaders.inject = {\r\n      // Timestamp of the vertex\r\n      'vs:#decl': `\\\r\n        attribute float timeStart;\r\n        attribute float timeEnd;\r\n        uniform float currentTime;\r\n        uniform float searchFlag;\r\n        varying float vTime;\r\n      `,\r\n      'vs:#main-start': `\\\r\n        if (searchFlag == 1.0) {\r\n          vTime = 999.0;\r\n        } else if (timeEnd == -1.0 || timeStart > currentTime || timeEnd < currentTime ) {\r\n          vTime = -1.0;\r\n          return;\r\n        } else {\r\n          float nearBeginning = currentTime - timeStart;\r\n          float nearEnd = timeEnd - currentTime;\r\n          vTime = min(nearBeginning, nearEnd);\r\n        }\r\n      `,\r\n      'fs:#decl': `\\\r\n        uniform float currentTime;\r\n        uniform float searchFlag;\r\n        varying float vTime;\r\n      `,\r\n      'fs:#main-start': `\\\r\n      if (searchFlag == 0.0 && vTime == -1.0 ) discard;\r\n      `,\r\n      // fade the traces in and out\r\n      'fs:DECKGL_FILTER_COLOR': `\\\r\n        if (vTime <= 10.0) color.a *= (vTime / 10.0);\r\n      `,\r\n    }\r\n    return shaders\r\n  }\r\n\r\n  initializeState(params: any) {\r\n    super.initializeState(params)\r\n\r\n    const attributeManager = this.getAttributeManager()\r\n    attributeManager.addInstanced({\r\n      timeStart: { size: 1, accessor: 'getTimeStart' },\r\n      timeEnd: { size: 1, accessor: 'getTimeEnd' },\r\n    })\r\n  }\r\n\r\n  draw(params: any) {\r\n    const { currentTime } = this.props\r\n\r\n    params.uniforms = Object.assign({}, params.uniforms, {\r\n      currentTime,\r\n    })\r\n\r\n    super.draw(params)\r\n  }\r\n}\r\n\r\nDrtRequestArcLayer.layerName = 'DrtRequestArcLayer'\r\nDrtRequestArcLayer.defaultProps = defaultProps\r\n","export default \"// BC 2021-04-30: this file forked from https://github.com/visgl/deck.gl\\r\\n//\\r\\n// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\\r\\n//\\r\\n// Permission is hereby granted, free of charge, to any person obtaining a copy\\r\\n// of this software and associated documentation files (the \\\"Software\\\"), to deal\\r\\n// in the Software without restriction, including without limitation the rights\\r\\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\\r\\n// copies of the Software, and to permit persons to whom the Software is\\r\\n// furnished to do so, subject to the following conditions:\\r\\n//\\r\\n// The above copyright notice and this permission notice shall be included in\\r\\n// all copies or substantial portions of the Software.\\r\\n//\\r\\n// THE SOFTWARE IS PROVIDED \\\"AS IS\\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\\r\\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\\r\\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\\r\\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\\r\\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\\r\\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\\r\\n// THE SOFTWARE.\\r\\n\\r\\n#define SHADER_NAME icon-layer-vertex-shader\\r\\n\\r\\nattribute vec2 positions;\\r\\n\\r\\nattribute float instanceSizes;\\r\\nattribute vec4 instanceColors;\\r\\nattribute vec3 instancePickingColors;\\r\\nattribute vec4 instanceIconFrames;\\r\\nattribute float instanceColorModes;\\r\\nattribute vec2 instanceOffsets;\\r\\nattribute vec2 instancePixelOffset;\\r\\n\\r\\nuniform float sizeScale;\\r\\nuniform vec2 iconsTextureDim;\\r\\nuniform float sizeMinPixels;\\r\\nuniform float sizeMaxPixels;\\r\\nuniform bool billboard;\\r\\n\\r\\nuniform float currentTime;\\r\\n\\r\\nuniform vec2 iconStillOffsets;\\r\\nuniform vec4 iconStillFrames;\\r\\n\\r\\nattribute float instanceTimestamps;\\r\\nattribute float instanceTimestampsNext;\\r\\nattribute vec2 instanceStartPositions;\\r\\nattribute vec2 instanceEndPositions;\\r\\n\\r\\nvarying float vColorMode;\\r\\nvarying vec4 vColor;\\r\\nvarying vec2 vTextureCoords;\\r\\nvarying vec2 uv;\\r\\nvarying float vPercentComplete;\\r\\n\\r\\n// ------------------------------------------------------------------\\r\\n\\r\\nvec2 rotate_by_angle(vec2 vertex, float angle_radian) {\\r\\n  float cos_angle = cos(angle_radian);\\r\\n  float sin_angle = sin(angle_radian);\\r\\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\\r\\n  return rotationMatrix * vertex;\\r\\n}\\r\\n\\r\\nvec3 interpolate(in vec3 point1, in vec3 point2, in float timestepFraction) {\\r\\n    if (timestepFraction <= 0.0) {\\r\\n        return point1;\\r\\n    } else if (timestepFraction >= 1.0 ) {\\r\\n        return point2;\\r\\n    } else {\\r\\n        vec3 direction = point2 - point1;\\r\\n        return point1 + (direction * timestepFraction);\\r\\n    }\\r\\n}\\r\\n\\r\\nvoid main(void) {\\r\\n\\r\\n  // Calculate progress:\\r\\n  // Skip everything else if this vertex is outside the time window\\r\\n  if (currentTime < instanceTimestamps) {\\r\\n    vPercentComplete = -1.0;\\r\\n    return;\\r\\n  } else if (currentTime > instanceTimestampsNext) {\\r\\n    vPercentComplete = -1.0;\\r\\n    return;\\r\\n  } else {\\r\\n    vPercentComplete = (currentTime - instanceTimestamps) /\\r\\n                       (instanceTimestampsNext - instanceTimestamps);\\r\\n  }\\r\\n\\r\\n  geometry.pickingColor = instancePickingColors;\\r\\n\\r\\n  vec3 startPosition = vec3(instanceStartPositions, 5.0);\\r\\n  vec3 endPosition = vec3(instanceEndPositions, 5.0);\\r\\n\\r\\n  // are we stationary/still\\r\\n  bool still = (instanceStartPositions == instanceEndPositions);\\r\\n\\r\\n  // geometry.uv = positions;\\r\\n  // uv = positions;\\r\\n\\r\\n  // this could be the problem right here;\\r\\n  vec2 iconSize = still ? iconStillFrames.zw : instanceIconFrames.zw;\\r\\n  // convert size in meters to pixels, then scaled and clamp\\r\\n  // project meters to pixels and clamp to limits\\r\\n  float sizePixels = clamp(\\r\\n    project_size_to_pixel(instanceSizes * sizeScale),\\r\\n    sizeMinPixels, sizeMaxPixels\\r\\n  );\\r\\n\\r\\n  // scale icon height to match instanceSize\\r\\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\\r\\n\\r\\n  // // figure out angle based on motion direction\\r\\n  float angle = 0.0;\\r\\n  if (!still) {\\r\\n    vec3 direction = normalize(endPosition - startPosition);\\r\\n    angle = atan( direction.y / direction.x);\\r\\n    if (direction.x < 0.0) angle = angle - PI;\\r\\n  }\\r\\n\\r\\n  // scale and rotate vertex in \\\"pixel\\\" value and convert back to fraction in clipspace\\r\\n  vec2 pixelOffset = positions / 2.0 * iconSize + (still ? iconStillOffsets : instanceOffsets);\\r\\n  pixelOffset = rotate_by_angle(pixelOffset, angle) * instanceScale;\\r\\n  pixelOffset += instancePixelOffset;\\r\\n  pixelOffset.y *= -1.0;\\r\\n\\r\\n  vec3 newPosition = interpolate(startPosition, endPosition, vPercentComplete);\\r\\n\\r\\n  if (billboard)  {\\r\\n    gl_Position = project_position_to_clipspace(newPosition, vec3(0.0), vec3(0.0), geometry.position);\\r\\n    vec3 offset = vec3(pixelOffset, 0.0);\\r\\n    DECKGL_FILTER_SIZE(offset, geometry);\\r\\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\\r\\n\\r\\n  } else {\\r\\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\\r\\n    DECKGL_FILTER_SIZE(offset_common, geometry);\\r\\n    gl_Position = project_position_to_clipspace(newPosition, vec3(0.0), offset_common, geometry.position);\\r\\n  }\\r\\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\\r\\n\\r\\n  vec2 upperleft = (still ? iconStillFrames.xy : instanceIconFrames.xy);\\r\\n\\r\\n  vTextureCoords = mix(\\r\\n    upperleft,\\r\\n    upperleft + iconSize,\\r\\n    (positions.xy + 1.0) / 2.0\\r\\n  ) / iconsTextureDim;\\r\\n\\r\\n  vColor = instanceColors;\\r\\n  DECKGL_FILTER_COLOR(vColor, geometry);\\r\\n\\r\\n  vColorMode = instanceColorModes;\\r\\n}\\r\\n\"","export default \"// BC 2021-04-30: this file forked from https://github.com/visgl/deck.gl\\r\\n//\\r\\n// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\\r\\n//\\r\\n// Permission is hereby granted, free of charge, to any person obtaining a copy\\r\\n// of this software and associated documentation files (the \\\"Software\\\"), to deal\\r\\n// in the Software without restriction, including without limitation the rights\\r\\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\\r\\n// copies of the Software, and to permit persons to whom the Software is\\r\\n// furnished to do so, subject to the following conditions:\\r\\n//\\r\\n// The above copyright notice and this permission notice shall be included in\\r\\n// all copies or substantial portions of the Software.\\r\\n//\\r\\n// THE SOFTWARE IS PROVIDED \\\"AS IS\\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\\r\\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\\r\\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\\r\\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\\r\\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\\r\\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\\r\\n// THE SOFTWARE.\\r\\n\\r\\n#define SHADER_NAME icon-layer-fragment-shader\\r\\n\\r\\nprecision highp float;\\r\\n\\r\\nuniform float opacity;\\r\\nuniform sampler2D iconsTexture;\\r\\nuniform float alphaCutoff;\\r\\n\\r\\nvarying float vColorMode;\\r\\nvarying vec4 vColor;\\r\\nvarying vec2 vTextureCoords;\\r\\nvarying vec2 uv;\\r\\n\\r\\nuniform float currentTime;\\r\\nvarying float vPercentComplete;\\r\\n\\r\\nvoid main(void) {\\r\\n\\r\\n  if (vPercentComplete == -1.0) discard;\\r\\n\\r\\n  geometry.uv = uv;\\r\\n\\r\\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\\r\\n\\r\\n  // if colorMode == 0, use pixel color from the texture\\r\\n  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask\\r\\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\\r\\n  // Take the global opacity and the alpha from vColor into account for the alpha component\\r\\n  float a = texColor.a * opacity * vColor.a;\\r\\n\\r\\n  if (a < alphaCutoff) {\\r\\n    discard;\\r\\n  }\\r\\n\\r\\n  gl_FragColor = vec4(color, a);\\r\\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\\r\\n}\\r\\n\"","// BC 2021-04-30: this file forked from https://github.com/visgl/deck.gl\r\n//\r\n/* global document */\r\nimport GL from '@luma.gl/constants'\r\nimport { Texture2D, copyToTexture, cloneTextureFrom } from '@luma.gl/core'\r\nimport { ImageLoader } from '@loaders.gl/images'\r\nimport { load } from '@loaders.gl/core'\r\nimport { createIterable } from '@deck.gl/core'\r\n\r\nconst DEFAULT_CANVAS_WIDTH = 1024\r\nconst DEFAULT_BUFFER = 4\r\n\r\nconst noop = () => {}\r\n\r\nconst DEFAULT_TEXTURE_PARAMETERS = {\r\n  [GL.TEXTURE_MIN_FILTER]: GL.LINEAR_MIPMAP_LINEAR,\r\n  // GL.LINEAR is the default value but explicitly set it here\r\n  [GL.TEXTURE_MAG_FILTER]: GL.LINEAR,\r\n  // for texture boundary artifact\r\n  [GL.TEXTURE_WRAP_S]: GL.CLAMP_TO_EDGE,\r\n  [GL.TEXTURE_WRAP_T]: GL.CLAMP_TO_EDGE,\r\n}\r\n\r\nfunction nextPowOfTwo(number: number) {\r\n  return Math.pow(2, Math.ceil(Math.log2(number)))\r\n}\r\n\r\n// update comment to create a new texture and copy original data.\r\nfunction resizeImage(ctx: any, imageData: any, width: any, height: any) {\r\n  if (width === imageData.width && height === imageData.height) {\r\n    return imageData\r\n  }\r\n\r\n  ctx.canvas.height = height\r\n  ctx.canvas.width = width\r\n\r\n  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height)\r\n\r\n  // image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight\r\n  ctx.drawImage(imageData, 0, 0, imageData.width, imageData.height, 0, 0, width, height)\r\n\r\n  return ctx.canvas\r\n}\r\n\r\nfunction getIconId(icon: any) {\r\n  return icon && (icon.id || icon.url)\r\n}\r\n\r\n// resize texture without losing original data\r\nfunction resizeTexture(gl: any, texture: any, width: any, height: any) {\r\n  const oldWidth = texture.width\r\n  const oldHeight = texture.height\r\n\r\n  const newTexture = cloneTextureFrom(texture, { width, height })\r\n  copyToTexture(texture, newTexture, {\r\n    targetY: 0,\r\n    width: oldWidth,\r\n    height: oldHeight,\r\n  })\r\n\r\n  texture.delete()\r\n  return newTexture\r\n}\r\n\r\n// traverse icons in a row of icon atlas\r\n// extend each icon with left-top coordinates\r\nfunction buildRowMapping(mapping: any, columns: any, yOffset: any) {\r\n  for (let i = 0; i < columns.length; i++) {\r\n    const { icon, xOffset } = columns[i]\r\n    const id = getIconId(icon)\r\n    mapping[id] = {\r\n      ...icon,\r\n      x: xOffset,\r\n      y: yOffset,\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Generate coordinate mapping to retrieve icon left-top position from an icon atlas\r\n * @param icons {Array<Object>} list of icons, each icon requires url, width, height\r\n * @param buffer {Number} add buffer to the right and bottom side of the image\r\n * @param xOffset {Number} right position of last icon in old mapping\r\n * @param yOffset {Number} top position in last icon in old mapping\r\n * @param rowHeight {Number} rowHeight of the last icon's row\r\n * @param canvasWidth {Number} max width of canvas\r\n * @param mapping {object} old mapping\r\n * @returns {{mapping: {'/icon/1': {url, width, height, ...}},, canvasHeight: {Number}}}\r\n */\r\nexport function buildMapping({\r\n  icons,\r\n  buffer,\r\n  mapping = {},\r\n  xOffset = 0,\r\n  yOffset = 0,\r\n  rowHeight = 0,\r\n  canvasWidth,\r\n}: any) {\r\n  let columns = []\r\n  // Strategy to layout all the icons into a texture:\r\n  // traverse the icons sequentially, layout the icons from left to right, top to bottom\r\n  // when the sum of the icons width is equal or larger than canvasWidth,\r\n  // move to next row starting from total height so far plus max height of the icons in previous row\r\n  // row width is equal to canvasWidth\r\n  // row height is decided by the max height of the icons in that row\r\n  // mapping coordinates of each icon is its left-top position in the texture\r\n  for (let i = 0; i < icons.length; i++) {\r\n    const icon = icons[i]\r\n    const id = getIconId(icon)\r\n\r\n    if (!mapping[id]) {\r\n      const { height, width } = icon\r\n\r\n      // fill one row\r\n      if (xOffset + width + buffer > canvasWidth) {\r\n        buildRowMapping(mapping, columns, yOffset)\r\n\r\n        xOffset = 0\r\n        yOffset = rowHeight + yOffset + buffer\r\n        rowHeight = 0\r\n        columns = []\r\n      }\r\n\r\n      columns.push({\r\n        icon,\r\n        xOffset,\r\n      })\r\n\r\n      xOffset = xOffset + width + buffer\r\n      rowHeight = Math.max(rowHeight, height)\r\n    }\r\n  }\r\n\r\n  if (columns.length > 0) {\r\n    buildRowMapping(mapping, columns, yOffset)\r\n  }\r\n\r\n  return {\r\n    mapping,\r\n    rowHeight,\r\n    xOffset,\r\n    yOffset,\r\n    canvasWidth,\r\n    canvasHeight: nextPowOfTwo(rowHeight + yOffset + buffer),\r\n  }\r\n}\r\n\r\n// extract icons from data\r\n// return icons should be unique, and not cached or cached but url changed\r\nexport function getDiffIcons(data: any, getIcon: any, cachedIcons: any) {\r\n  if (!data || !getIcon) {\r\n    return null\r\n  }\r\n\r\n  cachedIcons = cachedIcons || {}\r\n  const icons = {} as any\r\n  const { iterable, objectInfo } = createIterable(data)\r\n  for (const object of iterable) {\r\n    objectInfo.index++\r\n    const icon = getIcon(object, objectInfo)\r\n    const id = getIconId(icon)\r\n\r\n    if (!icon) {\r\n      throw new Error('Icon is missing.')\r\n    }\r\n\r\n    if (!icon.url) {\r\n      throw new Error('Icon url is missing.')\r\n    }\r\n\r\n    if (!icons[id] && (!cachedIcons[id] || icon.url !== cachedIcons[id].url)) {\r\n      icons[id] = { ...icon, source: object, sourceIndex: objectInfo.index }\r\n    }\r\n  }\r\n  return icons\r\n}\r\n\r\nexport default class IconManager {\r\n  gl: any\r\n  onUpdate: () => void\r\n  onError: (e: any) => any\r\n  _loadOptions: any\r\n  _getIcon: any\r\n  _texture: any\r\n  _externalTexture: any\r\n  _mapping: any\r\n  _pendingCount: number\r\n  _autoPacking: boolean\r\n  _xOffset: number\r\n  _yOffset: number\r\n  _rowHeight: number\r\n  _buffer: number\r\n  _canvasWidth: number\r\n  _canvasHeight: number\r\n  _canvas: any\r\n\r\n  constructor(\r\n    gl: any,\r\n    {\r\n      onUpdate = noop, // notify IconLayer when icon texture update\r\n      onError = noop,\r\n    }\r\n  ) {\r\n    this.gl = gl\r\n    this.onUpdate = onUpdate\r\n    this.onError = onError\r\n\r\n    // load options used for loading images\r\n    this._loadOptions = null\r\n    this._getIcon = null\r\n\r\n    this._texture = null\r\n    this._externalTexture = null\r\n    this._mapping = {}\r\n    // count of pending requests to fetch icons\r\n    this._pendingCount = 0\r\n\r\n    this._autoPacking = false\r\n\r\n    // internal props used when autoPacking applied\r\n    // right position of last icon\r\n    this._xOffset = 0\r\n    // top position of last icon\r\n    this._yOffset = 0\r\n    this._rowHeight = 0\r\n    this._buffer = DEFAULT_BUFFER\r\n    this._canvasWidth = DEFAULT_CANVAS_WIDTH\r\n    this._canvasHeight = 0\r\n    this._canvas = null\r\n  }\r\n\r\n  finalize() {\r\n    this._texture?.delete()\r\n  }\r\n\r\n  getTexture() {\r\n    return this._texture || this._externalTexture\r\n  }\r\n\r\n  getIconMapping(icon: any) {\r\n    const id = this._autoPacking ? getIconId(icon) : icon\r\n    return this._mapping[id] || {}\r\n  }\r\n\r\n  setProps({ loadOptions, autoPacking, iconAtlas, iconMapping, data, getIcon }: any) {\r\n    if (loadOptions) {\r\n      this._loadOptions = loadOptions\r\n    }\r\n\r\n    if (autoPacking !== undefined) {\r\n      this._autoPacking = autoPacking\r\n    }\r\n\r\n    if (getIcon) {\r\n      this._getIcon = getIcon\r\n    }\r\n\r\n    if (iconMapping) {\r\n      this._mapping = iconMapping\r\n    }\r\n\r\n    if (iconAtlas) {\r\n      this._updateIconAtlas(iconAtlas)\r\n    }\r\n\r\n    if (this._autoPacking && (data || getIcon) && typeof document !== 'undefined') {\r\n      this._canvas = this._canvas || document.createElement('canvas')\r\n\r\n      this._updateAutoPacking(data)\r\n    }\r\n  }\r\n\r\n  get isLoaded() {\r\n    return this._pendingCount === 0\r\n  }\r\n\r\n  _updateIconAtlas(iconAtlas: any) {\r\n    this._texture?.delete()\r\n    this._texture = null\r\n    this._externalTexture = iconAtlas\r\n    this.onUpdate()\r\n  }\r\n\r\n  _updateAutoPacking(data: any) {\r\n    const icons = Object.values(getDiffIcons(data, this._getIcon, this._mapping) || {})\r\n\r\n    if (icons.length > 0) {\r\n      // generate icon mapping\r\n      const { mapping, xOffset, yOffset, rowHeight, canvasHeight } = buildMapping({\r\n        icons,\r\n        buffer: this._buffer,\r\n        canvasWidth: this._canvasWidth,\r\n        mapping: this._mapping,\r\n        rowHeight: this._rowHeight,\r\n        xOffset: this._xOffset,\r\n        yOffset: this._yOffset,\r\n      })\r\n\r\n      this._rowHeight = rowHeight\r\n      this._mapping = mapping\r\n      this._xOffset = xOffset\r\n      this._yOffset = yOffset\r\n      this._canvasHeight = canvasHeight\r\n\r\n      // create new texture\r\n      if (!this._texture) {\r\n        this._texture = new Texture2D(this.gl, {\r\n          width: this._canvasWidth,\r\n          height: this._canvasHeight,\r\n          parameters: DEFAULT_TEXTURE_PARAMETERS,\r\n        })\r\n      }\r\n\r\n      if (this._texture.height !== this._canvasHeight) {\r\n        this._texture = resizeTexture(this.gl, this._texture, this._canvasWidth, this._canvasHeight)\r\n      }\r\n\r\n      this.onUpdate()\r\n\r\n      // load images\r\n      this._loadIcons(icons)\r\n    }\r\n  }\r\n\r\n  _loadIcons(icons: any) {\r\n    const ctx = this._canvas.getContext('2d')\r\n\r\n    for (const icon of icons) {\r\n      this._pendingCount++\r\n      load(icon.url, ImageLoader, this._loadOptions)\r\n        .then(imageData => {\r\n          const id = getIconId(icon)\r\n          const { x, y, width, height } = this._mapping[id]\r\n\r\n          const data = resizeImage(ctx, imageData, width, height)\r\n\r\n          this._texture.setSubImageData({\r\n            data,\r\n            x,\r\n            y,\r\n            width,\r\n            height,\r\n          })\r\n\r\n          // Call to regenerate mipmaps after modifying texture(s)\r\n          this._texture.generateMipmap()\r\n\r\n          this.onUpdate()\r\n        })\r\n        .catch(error => {\r\n          this.onError({\r\n            url: icon.url,\r\n            source: icon.source,\r\n            sourceIndex: icon.sourceIndex,\r\n            loadOptions: this._loadOptions,\r\n            error,\r\n          })\r\n        })\r\n        .finally(() => {\r\n          this._pendingCount--\r\n        })\r\n    }\r\n  }\r\n}\r\n","// BC 2021-04-30: this file forked from https://github.com/visgl/deck.gl\r\n//\r\n// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n\r\nimport { Layer, project32, picking, log } from '@deck.gl/core'\r\nimport GL from '@luma.gl/constants'\r\nimport { Model, Geometry } from '@luma.gl/core'\r\n\r\nimport vertShader from './icon-layer.glsl.vert?raw'\r\nimport fragShader from './icon-layer.glsl.frag?raw'\r\n\r\nimport IconManager from './icon-manager'\r\n\r\nconst DEFAULT_COLOR = [0, 0, 0, 255]\r\n\r\nconst defaultProps = {\r\n  iconAtlas: { type: 'image', value: null, async: true },\r\n  iconMapping: { type: 'object', value: {}, async: true },\r\n  sizeScale: { type: 'number', value: 1, min: 0 },\r\n  billboard: false,\r\n  sizeUnits: 'pixels',\r\n  sizeMinPixels: { type: 'number', min: 0, value: 0 }, //  min point radius in pixels\r\n  sizeMaxPixels: { type: 'number', min: 0, value: Number.MAX_SAFE_INTEGER }, // max point radius in pixels\r\n  alphaCutoff: { type: 'number', value: 0.05, min: 0, max: 1 },\r\n  iconStill: { type: 'object', value: null },\r\n\r\n  getIcon: { type: 'accessor', value: (x: any) => x.icon },\r\n  getColor: { type: 'accessor', value: DEFAULT_COLOR },\r\n  getSize: { type: 'accessor', value: 1 },\r\n  getAngle: { type: 'accessor', value: 0 },\r\n  getPixelOffset: { type: 'accessor', value: [0, 0] },\r\n\r\n  getPathStart: { type: 'accessor', value: null },\r\n  getPathEnd: { type: 'accessor', value: null },\r\n  getTimeStart: { type: 'accessor', value: null },\r\n  getTimeEnd: { type: 'accessor', value: null },\r\n  currentTime: { type: 'number', value: 0 },\r\n\r\n  pickable: { type: 'boolean', value: true },\r\n  onIconError: { type: 'function', value: null, compare: false, optional: true },\r\n}\r\n\r\nexport default class IconLayer extends Layer {\r\n  getShaders() {\r\n    return super.getShaders({ vs: vertShader, fs: fragShader, modules: [project32, picking] })\r\n  }\r\n\r\n  initializeState() {\r\n    this.state = {\r\n      iconManager: new IconManager(this.context.gl, {\r\n        onUpdate: this._onUpdate.bind(this),\r\n        onError: this._onError.bind(this) as any,\r\n      }),\r\n    }\r\n\r\n    const attributeManager = this.getAttributeManager()\r\n\r\n    /* eslint-disable max-len */\r\n    attributeManager.addInstanced({\r\n      instanceTimestamps: {\r\n        size: 1,\r\n        accessor: 'getTimeStart',\r\n      },\r\n      instanceTimestampsNext: {\r\n        size: 1,\r\n        accessor: 'getTimeEnd',\r\n      },\r\n      instanceStartPositions: {\r\n        size: 2,\r\n        accessor: 'getPathStart',\r\n      },\r\n      instanceEndPositions: {\r\n        size: 2,\r\n        accessor: 'getPathEnd',\r\n      },\r\n      instanceSizes: {\r\n        size: 1,\r\n        transition: true,\r\n        accessor: 'getSize',\r\n        defaultValue: 1,\r\n      },\r\n      instanceOffsets: { size: 2, accessor: 'getIcon', transform: this.getInstanceOffset },\r\n      instanceIconFrames: { size: 4, accessor: 'getIcon', transform: this.getInstanceIconFrame },\r\n      instanceColorModes: {\r\n        size: 1,\r\n        type: GL.UNSIGNED_BYTE,\r\n        accessor: 'getIcon',\r\n        transform: this.getInstanceColorMode,\r\n      },\r\n      instanceColors: {\r\n        size: this.props.colorFormat.length,\r\n        type: GL.UNSIGNED_BYTE,\r\n        normalized: true,\r\n        transition: true,\r\n        accessor: 'getColor',\r\n        defaultValue: DEFAULT_COLOR,\r\n      },\r\n      instanceAngles: {\r\n        size: 1,\r\n        transition: true,\r\n        accessor: 'getAngle',\r\n      },\r\n      instancePixelOffset: {\r\n        size: 2,\r\n        transition: true,\r\n        accessor: 'getPixelOffset',\r\n      },\r\n    })\r\n    /* eslint-enable max-len */\r\n  }\r\n\r\n  /* eslint-disable max-statements, complexity */\r\n  updateState({ oldProps, props, changeFlags }: any) {\r\n    super.updateState({ props, oldProps, changeFlags })\r\n\r\n    const attributeManager = this.getAttributeManager()\r\n    const { iconAtlas, iconMapping, data, getIcon } = props\r\n    const { iconManager } = this.state\r\n\r\n    iconManager.setProps({ loadOptions: props.loadOptions })\r\n\r\n    let iconMappingChanged = false\r\n    const prePacked = iconAtlas || this.internalState.isAsyncPropLoading('iconAtlas')\r\n\r\n    // prepacked iconAtlas from user\r\n    if (prePacked) {\r\n      if (oldProps.iconAtlas !== props.iconAtlas) {\r\n        iconManager.setProps({ iconAtlas, autoPacking: false })\r\n      }\r\n\r\n      if (oldProps.iconMapping !== props.iconMapping) {\r\n        iconManager.setProps({ iconMapping })\r\n        iconMappingChanged = true\r\n      }\r\n    } else {\r\n      // otherwise, use autoPacking\r\n      iconManager.setProps({ autoPacking: true })\r\n    }\r\n\r\n    // handle data changed\r\n    if (\r\n      changeFlags.dataChanged ||\r\n      (changeFlags.updateTriggersChanged &&\r\n        (changeFlags.updateTriggersChanged.all || changeFlags.updateTriggersChanged.getIcon))\r\n    ) {\r\n      iconManager.setProps({ data, getIcon })\r\n    }\r\n\r\n    if (iconMappingChanged) {\r\n      attributeManager.invalidate('instanceOffsets')\r\n      attributeManager.invalidate('instanceIconFrames')\r\n      attributeManager.invalidate('instanceColorModes')\r\n    }\r\n\r\n    if (changeFlags.extensionsChanged) {\r\n      const { gl } = this.context\r\n      this.state.model?.delete()\r\n      this.state.model = this._getModel(gl)\r\n      attributeManager.invalidateAll()\r\n    }\r\n  }\r\n  /* eslint-enable max-statements, complexity */\r\n\r\n  get isLoaded() {\r\n    return super.isLoaded && this.state.iconManager.isLoaded\r\n  }\r\n\r\n  finalizeState() {\r\n    super.finalizeState()\r\n    // Release resources held by the icon manager\r\n    this.state.iconManager.finalize()\r\n  }\r\n\r\n  draw({ uniforms }: any) {\r\n    const {\r\n      sizeScale,\r\n      sizeMinPixels,\r\n      sizeMaxPixels,\r\n      sizeUnits,\r\n      billboard,\r\n      alphaCutoff,\r\n      currentTime,\r\n      iconStill,\r\n      pickable,\r\n    } = this.props\r\n\r\n    const { iconManager } = this.state\r\n    const { viewport } = this.context\r\n\r\n    const iconsTexture = iconManager.getTexture()\r\n    if (iconsTexture) {\r\n      this.state.model\r\n        .setUniforms(uniforms)\r\n        .setUniforms({\r\n          iconsTexture,\r\n          iconsTextureDim: [iconsTexture.width, iconsTexture.height],\r\n          sizeScale: sizeScale * (sizeUnits === 'pixels' ? viewport.metersPerPixel : 1),\r\n          sizeMinPixels,\r\n          sizeMaxPixels,\r\n          billboard,\r\n          alphaCutoff,\r\n          currentTime,\r\n          pickable,\r\n          iconStillOffsets: this.getInstanceOffset(iconStill),\r\n          iconStillFrames: this.getInstanceIconFrame(iconStill),\r\n        })\r\n        .draw()\r\n    }\r\n  }\r\n\r\n  _getModel(gl: any) {\r\n    // The icon-layer vertex shader uses 2d positions\r\n    // specifed via: attribute vec2 positions;\r\n    const positions = [-1, -1, -1, 1, 1, 1, 1, -1]\r\n\r\n    return new Model(gl, {\r\n      ...this.getShaders(),\r\n      id: this.props.id,\r\n      geometry: new Geometry({\r\n        drawMode: GL.TRIANGLE_FAN,\r\n        attributes: {\r\n          // The size must be explicitly passed here otherwise luma.gl\r\n          // will default to assuming that positions are 3D (x,y,z)\r\n          positions: {\r\n            size: 2,\r\n            value: new Float32Array(positions),\r\n          },\r\n        },\r\n      }),\r\n      isInstanced: true,\r\n    })\r\n  }\r\n\r\n  _onUpdate() {\r\n    this.setNeedsRedraw()\r\n  }\r\n\r\n  _onError(evt: any) {\r\n    const { onIconError } = this.getCurrentLayer().props\r\n    if (onIconError) {\r\n      onIconError(evt)\r\n    } else {\r\n      log.error(evt.error)()\r\n    }\r\n  }\r\n\r\n  getInstanceOffset(icon: any) {\r\n    const rect = this.state.iconManager.getIconMapping(icon)\r\n    return [rect.width / 2 - rect.anchorX || 0, rect.height / 2 - rect.anchorY || 0]\r\n  }\r\n\r\n  getInstanceColorMode(icon: any) {\r\n    const mapping = this.state.iconManager.getIconMapping(icon)\r\n    return mapping.mask ? 1 : 0\r\n  }\r\n\r\n  getInstanceIconFrame(icon: any) {\r\n    const rect = this.state.iconManager.getIconMapping(icon)\r\n    return [rect.x || 0, rect.y || 0, rect.width || 0, rect.height || 0]\r\n  }\r\n}\r\n\r\nIconLayer.layerName = 'FlatIconLayer'\r\nIconLayer.defaultProps = defaultProps\r\n","// BC 2021-04-30: this file forked from https://github.com/visgl/deck.gl\r\n//\r\n// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n\r\nimport { Layer, project32, picking, log } from '@deck.gl/core'\r\nimport GL from '@luma.gl/constants'\r\nimport { Model, Geometry } from '@luma.gl/core'\r\n\r\nimport vertShader from './icon-layer.glsl.vert?raw'\r\nimport fragShader from './icon-layer.glsl.frag?raw'\r\n\r\nimport IconManager from './icon-manager'\r\n\r\nconst DEFAULT_COLOR = [0, 0, 0, 255]\r\n\r\nconst defaultProps = {\r\n  iconAtlas: { type: 'image', value: null, async: true },\r\n  iconMapping: { type: 'object', value: {}, async: true },\r\n  sizeScale: { type: 'number', value: 1, min: 0 },\r\n  billboard: false,\r\n  sizeUnits: 'pixels',\r\n  sizeMinPixels: { type: 'number', min: 0, value: 0 }, //  min point radius in pixels\r\n  sizeMaxPixels: { type: 'number', min: 0, value: Number.MAX_SAFE_INTEGER }, // max point radius in pixels\r\n  alphaCutoff: { type: 'number', value: 0.05, min: 0, max: 1 },\r\n  iconStill: { type: 'object', value: null },\r\n\r\n  getIcon: { type: 'accessor', value: 'vehicle' }, // (x: any) => x.icon },\r\n  getBOffsets: { type: 'accessor', value: [0, 0] }, // (x: any) => x.icon },\r\n  getBIconFrames: { type: 'accessor', value: [128, 128, 128, 128] }, // (x: any) => x.icon },\r\n  getBColorModes: { type: 'accessor', value: 1 }, // (x: any) => x.icon },\r\n\r\n  getColor: { type: 'accessor', value: DEFAULT_COLOR },\r\n  getSize: { type: 'accessor', value: 1 },\r\n  getAngle: { type: 'accessor', value: 0 },\r\n  getPixelOffset: { type: 'accessor', value: [0, 0] },\r\n\r\n  getPathStart: { type: 'accessor', value: null },\r\n  getPathEnd: { type: 'accessor', value: null },\r\n  getTimeStart: { type: 'accessor', value: null },\r\n  getTimeEnd: { type: 'accessor', value: null },\r\n  currentTime: { type: 'number', value: 0 },\r\n\r\n  pickable: { type: 'boolean', value: true },\r\n  onIconError: { type: 'function', value: null, compare: false, optional: true },\r\n}\r\n\r\nexport default class IconLayer extends Layer {\r\n  getShaders() {\r\n    return super.getShaders({ vs: vertShader, fs: fragShader, modules: [project32, picking] })\r\n  }\r\n\r\n  initializeState() {\r\n    this.state = {\r\n      iconManager: new IconManager(this.context.gl, {\r\n        onUpdate: this._onUpdate.bind(this),\r\n        onError: this._onError.bind(this) as any,\r\n      }),\r\n    }\r\n\r\n    const attributeManager = this.getAttributeManager()\r\n\r\n    /* eslint-disable max-len */\r\n    attributeManager.addInstanced({\r\n      instanceTimestamps: {\r\n        size: 1,\r\n        accessor: 'getTimeStart',\r\n      },\r\n      instanceTimestampsNext: {\r\n        size: 1,\r\n        accessor: 'getTimeEnd',\r\n      },\r\n      instanceStartPositions: {\r\n        size: 2,\r\n        accessor: 'getPathStart',\r\n      },\r\n      instanceEndPositions: {\r\n        size: 2,\r\n        accessor: 'getPathEnd',\r\n      },\r\n      instanceSizes: {\r\n        size: 1,\r\n        transition: true,\r\n        accessor: 'getSize',\r\n        defaultValue: 1,\r\n      },\r\n      instanceOffsets: {\r\n        size: 2,\r\n        defaultValue: [0, 0],\r\n        accessor: 'getBOffsets',\r\n        // transform: this.getInstanceOffset\r\n      },\r\n      instanceIconFrames: {\r\n        size: 4,\r\n        defaultValue: [0, 0, 128, 128],\r\n        accessor: 'getBIconFrames',\r\n        // transform: this.getInstanceIconFrame\r\n      },\r\n      instanceColorModes: {\r\n        size: 1,\r\n        type: GL.UNSIGNED_BYTE,\r\n        defaultValue: 1,\r\n        accessor: 'getBColorModes',\r\n        // accessor: 'getIcon',\r\n        // transform: this.getInstanceColorMode,\r\n      },\r\n\r\n      // instanceOffsets: { size: 2, accessor: 'getIcon', transform: this.getInstanceOffset },\r\n      // instanceIconFrames: { size: 4, accessor: 'getIcon', transform: this.getInstanceIconFrame },\r\n      // instanceColorModes: {\r\n      //   size: 1,\r\n      //   type: GL.UNSIGNED_BYTE,\r\n      //   accessor: 'getIcon',\r\n      //   transform: this.getInstanceColorMode,\r\n      // },\r\n      instanceColors: {\r\n        size: this.props.colorFormat.length,\r\n        type: GL.UNSIGNED_BYTE,\r\n        normalized: true,\r\n        transition: true,\r\n        accessor: 'getColor',\r\n        defaultValue: DEFAULT_COLOR,\r\n      },\r\n      instanceAngles: {\r\n        size: 1,\r\n        transition: true,\r\n        accessor: 'getAngle',\r\n      },\r\n      instancePixelOffset: {\r\n        size: 2,\r\n        transition: true,\r\n        accessor: 'getPixelOffset',\r\n      },\r\n    })\r\n    /* eslint-enable max-len */\r\n  }\r\n\r\n  /* eslint-disable max-statements, complexity */\r\n  updateState({ oldProps, props, changeFlags }: any) {\r\n    super.updateState({ props, oldProps, changeFlags })\r\n\r\n    const attributeManager = this.getAttributeManager()\r\n    const { iconAtlas, iconMapping, data, getIcon } = props\r\n    const { iconManager } = this.state\r\n\r\n    iconManager.setProps({ loadOptions: props.loadOptions })\r\n\r\n    let iconMappingChanged = false\r\n    const prePacked = iconAtlas || this.internalState.isAsyncPropLoading('iconAtlas')\r\n\r\n    // prepacked iconAtlas from user\r\n    if (prePacked) {\r\n      if (oldProps.iconAtlas !== props.iconAtlas) {\r\n        iconManager.setProps({ iconAtlas, autoPacking: false })\r\n      }\r\n\r\n      if (oldProps.iconMapping !== props.iconMapping) {\r\n        iconManager.setProps({ iconMapping })\r\n        iconMappingChanged = true\r\n      }\r\n    } else {\r\n      // otherwise, use autoPacking\r\n      iconManager.setProps({ autoPacking: true })\r\n    }\r\n\r\n    // handle data changed\r\n    if (\r\n      changeFlags.dataChanged ||\r\n      (changeFlags.updateTriggersChanged &&\r\n        (changeFlags.updateTriggersChanged.all || changeFlags.updateTriggersChanged.getIcon))\r\n    ) {\r\n      iconManager.setProps({ data, getIcon })\r\n    }\r\n\r\n    if (iconMappingChanged) {\r\n      attributeManager.invalidate('instanceOffsets')\r\n      attributeManager.invalidate('instanceIconFrames')\r\n      attributeManager.invalidate('instanceColorModes')\r\n    }\r\n\r\n    if (changeFlags.extensionsChanged) {\r\n      const { gl } = this.context\r\n      this.state.model?.delete()\r\n      this.state.model = this._getModel(gl)\r\n      attributeManager.invalidateAll()\r\n    }\r\n  }\r\n  /* eslint-enable max-statements, complexity */\r\n\r\n  get isLoaded() {\r\n    return super.isLoaded && this.state.iconManager.isLoaded\r\n  }\r\n\r\n  finalizeState() {\r\n    super.finalizeState()\r\n    // Release resources held by the icon manager\r\n    this.state.iconManager.finalize()\r\n  }\r\n\r\n  draw({ uniforms }: any) {\r\n    const {\r\n      sizeScale,\r\n      sizeMinPixels,\r\n      sizeMaxPixels,\r\n      sizeUnits,\r\n      billboard,\r\n      alphaCutoff,\r\n      currentTime,\r\n      iconStill,\r\n      pickable,\r\n    } = this.props\r\n\r\n    const { iconManager } = this.state\r\n    const { viewport } = this.context\r\n\r\n    const iconsTexture = iconManager.getTexture()\r\n    if (iconsTexture) {\r\n      this.state.model\r\n        .setUniforms(uniforms)\r\n        .setUniforms({\r\n          iconsTexture,\r\n          iconsTextureDim: [iconsTexture.width, iconsTexture.height],\r\n          sizeScale: sizeScale * (sizeUnits === 'pixels' ? viewport.metersPerPixel : 1),\r\n          sizeMinPixels,\r\n          sizeMaxPixels,\r\n          billboard,\r\n          alphaCutoff,\r\n          currentTime,\r\n          pickable,\r\n          iconStillOffsets: this.getInstanceOffset(iconStill),\r\n          iconStillFrames: this.getInstanceIconFrame(iconStill),\r\n        })\r\n        .draw()\r\n    }\r\n  }\r\n\r\n  _getModel(gl: any) {\r\n    // The icon-layer vertex shader uses 2d positions\r\n    // specifed via: attribute vec2 positions;\r\n    const positions = [-1, -1, -1, 1, 1, 1, 1, -1]\r\n\r\n    return new Model(gl, {\r\n      ...this.getShaders(),\r\n      id: this.props.id,\r\n      geometry: new Geometry({\r\n        drawMode: GL.TRIANGLE_FAN,\r\n        attributes: {\r\n          // The size must be explicitly passed here otherwise luma.gl\r\n          // will default to assuming that positions are 3D (x,y,z)\r\n          positions: {\r\n            size: 2,\r\n            value: new Float32Array(positions),\r\n          },\r\n        },\r\n      }),\r\n      isInstanced: true,\r\n    })\r\n  }\r\n\r\n  _onUpdate() {\r\n    this.setNeedsRedraw()\r\n  }\r\n\r\n  _onError(evt: any) {\r\n    const { onIconError } = this.getCurrentLayer().props\r\n    if (onIconError) {\r\n      onIconError(evt)\r\n    } else {\r\n      log.error(evt.error)()\r\n    }\r\n  }\r\n\r\n  getInstanceOffset(icon: any) {\r\n    const rect = this.state.iconManager.getIconMapping(icon)\r\n    return [rect.width / 2 - rect.anchorX || 0, rect.height / 2 - rect.anchorY || 0]\r\n  }\r\n\r\n  getInstanceColorMode(icon: any) {\r\n    const mapping = this.state.iconManager.getIconMapping(icon)\r\n    return mapping.mask ? 1 : 0\r\n  }\r\n\r\n  getInstanceIconFrame(icon: any) {\r\n    const rect = this.state.iconManager.getIconMapping(icon)\r\n    return [rect.x || 0, rect.y || 0, rect.width || 0, rect.height || 0]\r\n  }\r\n}\r\n\r\nIconLayer.layerName = 'FlatIconLayer'\r\nIconLayer.defaultProps = defaultProps\r\n","import { LineLayer } from '@deck.gl/layers'\r\n\r\nconst defaultProps = {\r\n  currentTime: { type: 'number', value: 0, min: 0 },\r\n  getTimeStart: { type: 'accessor', value: null },\r\n  getTimeEnd: { type: 'accessor', value: null },\r\n  searchFlag: { type: 'number', value: 0 },\r\n}\r\n\r\nexport default class PathTraceLayer extends LineLayer {\r\n  getShaders() {\r\n    const shaders = super.getShaders()\r\n    shaders.inject = {\r\n      // Timestamp of the vertex\r\n      'vs:#decl': `\\\r\n        attribute float timeStart;\r\n        attribute float timeEnd;\r\n        uniform float currentTime;\r\n        uniform float searchFlag;\r\n        varying float vTime;\r\n      `,\r\n      'vs:#main-start': `\\\r\n        if (searchFlag == 1.0) {\r\n          vTime = 999.0;\r\n        } else if(timeStart > currentTime || timeEnd < currentTime ) {\r\n          vTime = -1.0;\r\n          return;\r\n        } else {\r\n          float nearBeginning = currentTime - timeStart;\r\n          float nearEnd = timeEnd - currentTime;\r\n          vTime = min(nearBeginning, nearEnd);\r\n        }\r\n      `,\r\n      'fs:#decl': `\\\r\n        uniform float currentTime;\r\n        varying float vTime;\r\n        uniform float searchFlag;\r\n      `,\r\n      'fs:#main-start': `\\\r\n        if (searchFlag == 0.0 && vTime == -1.0 ) discard;\r\n      `,\r\n      // fade the traces in and out\r\n      'fs:DECKGL_FILTER_COLOR': `\\\r\n        if (searchFlag == 0.0 && vTime <= 10.0) color.a *= (vTime / 10.0);\r\n      `,\r\n    }\r\n    return shaders\r\n  }\r\n\r\n  initializeState(params: any) {\r\n    super.initializeState(params)\r\n\r\n    const attributeManager = this.getAttributeManager()\r\n    attributeManager.addInstanced({\r\n      timeStart: { size: 1, accessor: 'getTimeStart' },\r\n      timeEnd: { size: 1, accessor: 'getTimeEnd' },\r\n    })\r\n  }\r\n\r\n  draw(params: any) {\r\n    const { currentTime, searchFlag } = this.props\r\n\r\n    params.uniforms = Object.assign({}, params.uniforms, {\r\n      currentTime,\r\n      searchFlag,\r\n    })\r\n\r\n    super.draw(params)\r\n  }\r\n}\r\n\r\nPathTraceLayer.layerName = 'PathTraceLayer'\r\nPathTraceLayer.defaultProps = defaultProps\r\n","import React, { useState, useMemo, useEffect } from 'react'\r\nimport { StaticMap } from 'react-map-gl'\r\nimport { AmbientLight, PointLight, LightingEffect } from '@deck.gl/core'\r\nimport DeckGL from '@deck.gl/react'\r\n\r\nimport DrtRequestLayer from './DrtRequestLayer'\r\nimport MovingIconsLayer from '@/layers/moving-icons/moving-icons-layer'\r\nimport MovingVehiclesLayer from '@/layers/moving-icons/moving-icons-vehicles-layer'\r\nimport PathTraceLayer from '@/layers/PathTraceLayer'\r\nimport { MAPBOX_TOKEN, REACT_VIEW_HANDLES } from '@/Globals'\r\n\r\nimport globalStore from '@/store'\r\n\r\nconst BASE_URL = import.meta.env.BASE_URL\r\n\r\nconst ICON_MAPPING = {\r\n  marker: { x: 0, y: 0, width: 128, height: 128, mask: true },\r\n  info: { x: 128, y: 0, width: 128, height: 128, mask: true },\r\n  vehicle: { x: 128, y: 128, width: 128, height: 128, mask: true },\r\n  diamond: { x: 0, y: 128, width: 128, height: 128, mask: false },\r\n}\r\n\r\nconst ambientLight = new AmbientLight({\r\n  color: [255, 255, 255],\r\n  intensity: 1.0,\r\n})\r\n\r\nconst pointLight = new PointLight({\r\n  color: [255, 255, 255],\r\n  intensity: 2.0,\r\n  position: [-74.05, 40.7, 8000],\r\n})\r\n\r\nconst lightingEffect = new LightingEffect({ ambientLight, pointLight })\r\n\r\nconst DEFAULT_THEME = {\r\n  vehicleColor: [200, 130, 250],\r\n  trailColor0: [235, 235, 25],\r\n  trailColor1: [23, 184, 190],\r\n  effects: [lightingEffect],\r\n}\r\n\r\nconst DRT_REQUEST = {\r\n  time: 0,\r\n  fromX: 1,\r\n  fromY: 2,\r\n  toX: 3,\r\n  toY: 4,\r\n  veh: 5,\r\n  arrival: 6,\r\n}\r\n\r\nexport default function Component(props: {\r\n  viewId: number\r\n  dark: boolean\r\n  simulationTime: number\r\n  paths: any[]\r\n  drtRequests: any[]\r\n  traces: any[]\r\n  colors: any\r\n  center: [number, number]\r\n  settingsShowLayers: { [label: string]: boolean }\r\n  vehicleLookup: string[]\r\n  searchEnabled: boolean\r\n  onClick: any\r\n  trafficLayers: any[]\r\n}) {\r\n  const {\r\n    simulationTime,\r\n    paths,\r\n    traces,\r\n    drtRequests,\r\n    settingsShowLayers,\r\n    center,\r\n    dark,\r\n    vehicleLookup,\r\n    searchEnabled,\r\n    onClick,\r\n    viewId,\r\n    trafficLayers,\r\n  } = props\r\n\r\n  const theme = DEFAULT_THEME\r\n\r\n  // set initial view\r\n  const [viewState, setViewState] = useState(\r\n    center\r\n      ? ({\r\n          center: [16, 42],\r\n          longitude: center[0],\r\n          latitude: center[1],\r\n          pitch: 0,\r\n          bearing: 0,\r\n          zoom: 10,\r\n        } as any)\r\n      : Object.assign({}, globalStore.state.viewState)\r\n  )\r\n\r\n  // register setViewState in global view updater so we can respond to external map motion\r\n  REACT_VIEW_HANDLES[viewId] = () => {\r\n    setViewState(globalStore.state.viewState)\r\n  }\r\n\r\n  const arcWidth = 2\r\n  const [hoverInfo, setHoverInfo] = useState({} as any)\r\n\r\n  const layers: any = []\r\n\r\n  function handleClick() {\r\n    console.log(hoverInfo)\r\n    // send null as message that blank area was clicked\r\n    if (!hoverInfo.object) {\r\n      onClick(null)\r\n    } else {\r\n      onClick(hoverInfo.object.v)\r\n    }\r\n  }\r\n\r\n  function renderTooltip({ hoverInfo }: any) {\r\n    const { object, x, y } = hoverInfo\r\n\r\n    if (!object) {\r\n      return null\r\n    }\r\n\r\n    const vehicleId = vehicleLookup[object.v]\r\n\r\n    return (\r\n      <div\r\n        className=\"tooltip\"\r\n        style={{\r\n          fontSize: '0.8rem',\r\n          backgroundColor: '#ddddeedd',\r\n          borderLeft: '6px solid green',\r\n          boxShadow: '2.5px 2px 4px rgba(0,0,0,0.25)',\r\n          color: '#223',\r\n          padding: '1rem 1rem',\r\n          position: 'absolute',\r\n          left: x + 40,\r\n          top: y - 30,\r\n        }}\r\n      >\r\n        <big>\r\n          <b>{vehicleId}</b>\r\n        </big>\r\n        <div>Passagiere: {object.occ} </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (settingsShowLayers.backgroundTraffic) {\r\n    // add the vehicle motion layer in each traffic layer\r\n    trafficLayers.forEach((layer: any, layerIndex: number) => {\r\n      // The entire layer can be hidden if all of its points\r\n      // are beyond the timeFilter range that is being shown.\r\n      const outOfRange =\r\n        layer.vehicles.t0[0] > simulationTime ||\r\n        layer.vehicles.t1[layer.vehicles.t1.length - 1] < simulationTime\r\n\r\n      // console.log(outOfRange)\r\n      layers.push(\r\n        //@ts-ignore\r\n        new MovingVehiclesLayer({\r\n          data: {\r\n            length: layer.vehicles.t0.length,\r\n            attributes: {\r\n              getTimeStart: { value: layer.vehicles.t0, size: 1 },\r\n              getTimeEnd: { value: layer.vehicles.t1, size: 1 },\r\n              getPathStart: { value: layer.vehicles.locO, size: 2 },\r\n              getPathEnd: { value: layer.vehicles.locD, size: 2 },\r\n            },\r\n          },\r\n          id: 'vehicles' + layerIndex,\r\n          // getIcon: (d: any) => 'vehicle',\r\n          getColor: [255, 32, 32], // (d: any) => props.colors[d.occ],\r\n          iconMoving: 'vehicle',\r\n          iconStill: 'diamond',\r\n          getSize: 20, // searchEnabled ? 56 : 44,\r\n          opacity: 1,\r\n          currentTime: simulationTime,\r\n          shadowEnabled: true,\r\n          iconAtlas: '/simwrapper/icon-atlas.png',\r\n          iconMapping: ICON_MAPPING,\r\n          sizeScale: 1,\r\n          billboard: false,\r\n          pickable: true,\r\n          depthTest: true,\r\n          autoHighlight: false,\r\n          highlightColor: [255, 0, 255],\r\n          // onHover: setHoverInfo,\r\n          parameters: {\r\n            depthTest: false,\r\n          },\r\n          visible: !outOfRange,\r\n        })\r\n      )\r\n    })\r\n  }\r\n\r\n  if (settingsShowLayers.routes)\r\n    layers.push(\r\n      //@ts-ignore:\r\n      new PathTraceLayer({\r\n        id: 'Routen',\r\n        data: traces,\r\n        currentTime: simulationTime,\r\n        getSourcePosition: (d: any) => d.p0,\r\n        getTargetPosition: (d: any) => d.p1,\r\n        getTimeStart: (d: any) => d.t0,\r\n        getTimeEnd: (d: any) => d.t1,\r\n        getColor: (d: any) => props.colors[d.occ],\r\n        getWidth: 3, // (d: any) => 3.0 * (d.occ + 1) - 1,\r\n        opacity: 0.8,\r\n        widthMinPixels: 1,\r\n        rounded: false,\r\n        shadowEnabled: false,\r\n        searchFlag: searchEnabled ? 1.0 : 0.0,\r\n        pickable: true,\r\n        autoHighlight: true,\r\n        highlightColor: [255, 0, 255],\r\n        onHover: setHoverInfo,\r\n      })\r\n    )\r\n\r\n  if (settingsShowLayers.vehicles)\r\n    layers.push(\r\n      //@ts-ignore\r\n      new MovingIconsLayer({\r\n        id: 'Vehicles',\r\n        data: paths,\r\n        getPathStart: (d: any) => d.p0,\r\n        getPathEnd: (d: any) => d.p1,\r\n        getTimeStart: (d: any) => d.t0,\r\n        getTimeEnd: (d: any) => d.t1,\r\n        getIcon: (d: any) => 'vehicle',\r\n        getColor: (d: any) => props.colors[d.occ],\r\n        iconMoving: 'vehicle',\r\n        iconStill: 'diamond',\r\n        getSize: searchEnabled ? 128 : 128,\r\n        opacity: 1.0,\r\n        currentTime: simulationTime,\r\n        shadowEnabled: false,\r\n        noAlloc: true,\r\n        iconAtlas: '/simwrapper/icon-atlas.png',\r\n        iconMapping: ICON_MAPPING,\r\n        sizeScale: 0.5,\r\n        billboard: false,\r\n        pickable: true,\r\n        depthTest: true,\r\n        autoHighlight: false,\r\n        highlightColor: [255, 0, 255],\r\n        onHover: setHoverInfo,\r\n        parameters: {\r\n          depthTest: false,\r\n        },\r\n      })\r\n    )\r\n\r\n  if (settingsShowLayers.requests)\r\n    layers.push(\r\n      //@ts-ignore:\r\n      new DrtRequestLayer({\r\n        id: 'DRT Requests',\r\n        data: drtRequests,\r\n        currentTime: simulationTime,\r\n        getSourcePosition: (d: any) => [d[DRT_REQUEST.fromX], d[DRT_REQUEST.fromY]],\r\n        getTargetPosition: (d: any) => [d[DRT_REQUEST.toX], d[DRT_REQUEST.toY]],\r\n        getTimeStart: (d: any) => d[DRT_REQUEST.time],\r\n        getTimeEnd: (d: any) => d[DRT_REQUEST.arrival],\r\n        getSourceColor: [0, 255, 64],\r\n        getTargetColor: [0, 255, 64],\r\n        getWidth: arcWidth,\r\n        opacity: 0.5,\r\n        searchFlag: searchEnabled ? 1.0 : 0.0,\r\n      })\r\n    )\r\n\r\n  return (\r\n    <DeckGL\r\n      layers={layers}\r\n      effects={theme.effects}\r\n      pickingRadius={5}\r\n      viewState={viewState}\r\n      controller={true}\r\n      getCursor={() => 'pointer'}\r\n      onClick={handleClick}\r\n      onViewStateChange={(e: any) => {\r\n        globalStore.commit('setMapCamera', e.viewState)\r\n      }}\r\n    >\r\n      {\r\n        /*\r\n        // @ts-ignore */\r\n        <StaticMap mapStyle={globalStore.getters.mapStyle} mapboxApiAccessToken={MAPBOX_TOKEN} />\r\n      }\r\n      {renderTooltip({ hoverInfo })}\r\n    </DeckGL>\r\n  )\r\n}\r\n","<template lang=\"pug\">\r\n.gl-app(:class=\"{'hide-thumbnail': !thumbnail}\"\r\n        :style='{\"background\": urlThumbnail}' oncontextmenu=\"return false\")\r\n\r\n  trip-viz.anim(v-if=\"!thumbnail\"\r\n                :center = \"vizDetails.center\"\r\n                :colors = \"COLOR_OCCUPANCY\"\r\n                :drtRequests = \"$options.drtRequests\"\r\n                :dark = \"globalState.isDarkMode\"\r\n                :paths = \"$options.paths\"\r\n                :settingsShowLayers = \"SETTINGS\"\r\n                :searchEnabled = \"searchEnabled\"\r\n                :simulationTime = \"simulationTime\"\r\n                :traces = \"$options.traces\"\r\n                :vehicleLookup = \"vehicleLookup\"\r\n                :viewId = \"viewId\"\r\n                :onClick = \"handleClick\"\r\n                :trafficLayers = \"trafficLayers\"\r\n  )\r\n\r\n  zoom-buttons(v-if=\"!thumbnail\")\r\n\r\n  .bottom-controls-mobile\r\n    .big.clock: p {{ myState.clock }}\r\n    legend-colors.legend-block(v-if=\"legendItems.length\" :mobile=\"true\"\r\n          :title=\"`${$t('passengers')}:`\" :items=\"legendItems\")\r\n    settings-panel.settings-area(:items=\"SETTINGS\" @click=\"handleSettingChange\")\r\n\r\n  .right-side(v-if=\"isLoaded && !thumbnail\")\r\n    collapsible-panel(direction=\"right\")\r\n      .big.clock: p {{ myState.clock }}\r\n\r\n      .panel-items\r\n        legend-colors.legend-block(v-if=\"legendItems.length\"\r\n          :title=\"`${$t('passengers')}:`\" :items=\"legendItems\")\r\n\r\n        legend-colors.legend-block(:title=\"`${$t('requests')}:`\" :items=\"legendRequests\" :mobile=\"false\")\r\n\r\n        settings-panel.settings-area(:items=\"SETTINGS\" @click=\"handleSettingChange\")\r\n\r\n        .speed-block\r\n          p.speed-label {{ $t('speed') }}:\r\n            br\r\n            | {{ speed }}x\r\n\r\n          b-slider.speed-slider(v-model=\"speed\"\r\n            :min=\"speedStops[0]\"\r\n            :max=\"speedStops[speedStops.length-1]\"\r\n            :duration=\"0\"\r\n            :dotSize=\"20\"\r\n            :tooltip=\"true\"\r\n            tooltip-placement=\"bottom\"\r\n            :tooltip-formatter=\"val => val + 'x'\"\r\n          )\r\n            template(v-for=\"val in speedStops\")\r\n              b-slider-tick(:value=\"val\" :key=\"val\")\r\n\r\n  playback-controls.bottom-area(v-if=\"!thumbnail && isLoaded\"\r\n      @click='toggleSimulation'\r\n      @time='setTime'\r\n      :timeStart = \"timeStart\"\r\n      :timeEnd = \"timeEnd\"\r\n      :isRunning = \"myState.isRunning\"\r\n      :currentTime = \"simulationTime\")\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      requests: 'DRT Requests',\r\n      passengers: 'Passengers',\r\n      search: 'Search',\r\n      showhide: 'Show/Hide',\r\n      vehicles: 'Vehicles',\r\n      routes: 'Routes',\r\n      speed: 'Speed',\r\n    },\r\n    de: {\r\n      requests: 'DRT Anfragen',\r\n      passengers: 'Passagiere',\r\n      search: 'Suche',\r\n      showhide: 'Ein-/Ausblenden',\r\n      vehicles: 'DRT Fahrzeuge',\r\n      routes: 'DRT Routen',\r\n      speed: 'Geschwindigkeit',\r\n    },\r\n  },\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\nimport { ToggleButton } from 'vue-js-toggle-button'\r\nimport readBlob from 'read-blob'\r\nimport YAML from 'yaml'\r\nimport crossfilter from 'crossfilter2'\r\nimport { blobToArrayBuffer, blobToBinaryString } from 'blob-util'\r\nimport * as coroutines from 'js-coroutines'\r\n\r\nimport globalStore from '@/store'\r\nimport pako from '@aftersim/pako'\r\nimport CollapsiblePanel from '@/components/CollapsiblePanel.vue'\r\nimport LegendColors from './LegendColors'\r\nimport PlaybackControls from '@/components/PlaybackControls.vue'\r\nimport SettingsPanel from './SettingsPanel.vue'\r\nimport ZoomButtons from '@/components/ZoomButtons.vue'\r\nimport EventParser from './eventParser'\r\nimport DashboardDataManager, { NetworkLinks } from '@/js/DashboardDataManager'\r\nimport GzipFetcher from '@/workers/GzipFetcher.worker?worker'\r\n\r\nimport {\r\n  ColorScheme,\r\n  FileSystem,\r\n  LegendItem,\r\n  LegendItemType,\r\n  FileSystemConfig,\r\n  VisualizationPlugin,\r\n  LIGHT_MODE,\r\n  DARK_MODE,\r\n  REACT_VIEW_HANDLES,\r\n} from '@/Globals'\r\n\r\nimport TripViz from './TripViz'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\n\r\nconst MyComponent = defineComponent({\r\n  name: 'XmasVehicleAnimation',\r\n  i18n,\r\n  components: {\r\n    CollapsiblePanel,\r\n    SettingsPanel,\r\n    LegendColors,\r\n    TripViz,\r\n    PlaybackControls,\r\n    ToggleButton,\r\n    ZoomButtons,\r\n  },\r\n  props: {\r\n    root: { type: String, required: true },\r\n    subfolder: { type: String, required: true },\r\n    yamlConfig: String,\r\n    config: Object,\r\n    thumbnail: Boolean,\r\n  },\r\n  computed: {\r\n    fileApi(): HTTPFileSystem {\r\n      return new HTTPFileSystem(this.fileSystem, globalStore)\r\n    },\r\n    fileSystem(): FileSystemConfig {\r\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === this.root\r\n      )\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n      return svnProject[0]\r\n    },\r\n\r\n    urlThumbnail(): any {\r\n      return this.thumbnailUrl\r\n    },\r\n\r\n    textColor(): any {\r\n      const lightmode = {\r\n        text: '#3498db',\r\n        bg: '#eeeef480',\r\n      }\r\n\r\n      const darkmode = {\r\n        text: 'white',\r\n        bg: '#181518aa',\r\n      }\r\n\r\n      return this.myState.colorScheme === ColorScheme.DarkMode ? darkmode : lightmode\r\n    },\r\n  },\r\n  data: () => {\r\n    const COLOR_OCCUPANCY = {\r\n      0: [140, 140, 160],\r\n      1: [20, 224, 224],\r\n      2: [240, 240, 40],\r\n      3: [240, 110, 30],\r\n      // 4: [192, 30, 50],\r\n    } as any\r\n\r\n    return {\r\n      viewId: Math.floor(1e12 * Math.random()),\r\n      COLOR_OCCUPANCY,\r\n      SETTINGS: {\r\n        vehicles: true,\r\n        backgroundTraffic: true,\r\n        routes: true,\r\n        requests: true,\r\n      } as any,\r\n      legendItems: Object.keys(COLOR_OCCUPANCY).map((key: string) => {\r\n        return { type: LegendItemType.line, color: COLOR_OCCUPANCY[key], value: key, label: key }\r\n      }),\r\n      legendRequests: [{ type: LegendItemType.line, color: [255, 0, 255], value: 0, label: '' }],\r\n      vizDetails: {\r\n        network: '',\r\n        drtTrips: '',\r\n        projection: '',\r\n        title: '',\r\n        description: '',\r\n        thumbnail: '',\r\n        center: [13.45, 52.5],\r\n        zoom: 12,\r\n        bearing: 0,\r\n        pitch: 20,\r\n        mapIsIndependent: false,\r\n        events: '',\r\n        eventBlobs: [] as string[],\r\n        theme: '',\r\n      },\r\n\r\n      myState: {\r\n        statusMessage: '',\r\n        clock: '00:00',\r\n        colorScheme: ColorScheme.DarkMode,\r\n        isRunning: false,\r\n        isShowingHelp: false,\r\n        subfolder: '',\r\n        yamlConfig: '',\r\n        thumbnail: false,\r\n        data: [] as any[],\r\n      },\r\n\r\n      timeStart: 0,\r\n      timeEnd: 86400,\r\n      traces: crossfilter([]) as crossfilter.Crossfilter<any>,\r\n      traceStart: null as crossfilter.Dimension<any, any> | null,\r\n      traceEnd: null as crossfilter.Dimension<any, any> | null,\r\n      traceVehicle: null as crossfilter.Dimension<any, any> | null,\r\n\r\n      paths: crossfilter([]) as crossfilter.Crossfilter<any>,\r\n      pathStart: null as crossfilter.Dimension<any, any> | null,\r\n      pathEnd: null as crossfilter.Dimension<any, any> | null,\r\n      pathVehicle: null as crossfilter.Dimension<any, any> | null,\r\n\r\n      requests: crossfilter([]) as crossfilter.Crossfilter<any>,\r\n      requestStart: null as crossfilter.Dimension<any, any> | null,\r\n      requestEnd: null as crossfilter.Dimension<any, any> | null,\r\n      requestVehicle: null as crossfilter.Dimension<any, any> | null,\r\n\r\n      simulationTime: 6 * 3600,\r\n      timeElapsedSinceLastFrame: 0,\r\n\r\n      searchTerm: '',\r\n      searchEnabled: false,\r\n\r\n      globalState: globalStore.state,\r\n      isDarkMode: globalStore.state.colorScheme === ColorScheme.DarkMode,\r\n      isLoaded: false,\r\n      showHelp: false,\r\n      speedStops: [-10, -5, -2, -1, -0.5, -0.25, 0, 0.25, 0.5, 1, 2, 5, 10],\r\n      speed: 1,\r\n\r\n      trafficLayers: [] as any[],\r\n      legendBits: [] as any[],\r\n      isEmbedded: false,\r\n      thumbnailUrl: \"url('assets/thumbnail.jpg') no-repeat;\",\r\n      vehicleLookup: [] as string[],\r\n      vehicleLookupString: {} as { [id: string]: number },\r\n      isPausedDueToHiding: false,\r\n    }\r\n  },\r\n  watch: {\r\n    '$store.state.viewState'() {\r\n      if (this.vizDetails.mapIsIndependent) return\r\n\r\n      if (!REACT_VIEW_HANDLES[this.viewId]) return\r\n      REACT_VIEW_HANDLES[this.viewId]()\r\n    },\r\n\r\n    async 'globalState.authAttempts'() {\r\n      console.log('AUTH CHANGED - Reload')\r\n      if (!this.yamlConfig) this.buildRouteFromUrl()\r\n      await this.getVizDetails()\r\n    },\r\n\r\n    'globalState.colorScheme'() {\r\n      this.isDarkMode = this.globalState.colorScheme === ColorScheme.DarkMode\r\n      this.updateLegendColors()\r\n    },\r\n\r\n    searchTerm() {\r\n      const vehicleNumber = this.vehicleLookupString[this.searchTerm]\r\n      if (vehicleNumber > -1) {\r\n        console.log('vehicle', vehicleNumber)\r\n        this.pathVehicle?.filterExact(vehicleNumber)\r\n        this.traceVehicle?.filterExact(vehicleNumber)\r\n        this.requestVehicle?.filterExact(vehicleNumber)\r\n        this.requestStart?.filterAll()\r\n        this.requestEnd?.filterAll()\r\n        this.searchEnabled = true\r\n      } else {\r\n        console.log('nope')\r\n        this.pathVehicle?.filterAll()\r\n        this.traceVehicle?.filterAll()\r\n        this.requestVehicle?.filterAll()\r\n        this.searchEnabled = false\r\n      }\r\n      this.updateDatasetFilters()\r\n    },\r\n  },\r\n  async mounted() {\r\n    globalStore.commit('setFullScreen', !this.thumbnail)\r\n\r\n    this.myState.thumbnail = this.thumbnail\r\n    this.myState.yamlConfig = this.yamlConfig || ''\r\n    this.myState.subfolder = this.subfolder\r\n\r\n    // EMBED MODE?\r\n    this.setEmbeddedMode()\r\n\r\n    await this.getVizDetails()\r\n\r\n    if (this.thumbnail) return\r\n\r\n    this.showHelp = false\r\n    this.updateLegendColors()\r\n\r\n    this.setWallClock()\r\n\r\n    this.myState.statusMessage = '/ Dateien laden...'\r\n    console.log('loading files')\r\n    const { trips, drtRequests } = await this.loadFiles()\r\n\r\n    console.log('parsing vehicle motion')\r\n    this.myState.statusMessage = `${this.$t('vehicles')}...`\r\n    this.paths = await this.parseVehicles(trips)\r\n    this.pathStart = this.paths.dimension((d: any) => d.t0)\r\n    this.pathEnd = this.paths.dimension((d: any) => d.t1)\r\n    this.pathVehicle = this.paths.dimension((d: any) => d.v)\r\n\r\n    console.log('Routes...')\r\n    this.myState.statusMessage = `${this.$t('routes')}...`\r\n    this.traces = await this.parseRouteTraces(trips)\r\n    this.traceStart = this.traces.dimension((d: any) => d.t0)\r\n    this.traceEnd = this.traces.dimension((d: any) => d.t1)\r\n    this.traceVehicle = this.traces.dimension((d: any) => d.v)\r\n\r\n    console.log('Requests...')\r\n    this.myState.statusMessage = `${this.$t('requests')}...`\r\n    this.requests = await this.parseDrtRequests(drtRequests)\r\n    this.requestStart = this.requests.dimension(d => d[0]) // time0\r\n    this.requestEnd = this.requests.dimension(d => d[6]) // arrival\r\n    this.requestVehicle = this.requests.dimension(d => d[5])\r\n\r\n    // ALSO load traffic in the background\r\n    this.loadBackgroundTraffic()\r\n\r\n    console.log('GO!')\r\n    this.myState.statusMessage = ''\r\n\r\n    document.addEventListener('visibilitychange', this.handleVisibilityChange, false)\r\n\r\n    this.myState.isRunning = true\r\n    this.timeElapsedSinceLastFrame = Date.now()\r\n    this.animate()\r\n  },\r\n  beforeDestroy() {\r\n    document.removeEventListener('visibilityChange', this.handleVisibilityChange)\r\n    globalStore.commit('setFullScreen', false)\r\n    this.$store.commit('setFullScreen', false)\r\n    this.myState.isRunning = false\r\n  },\r\n\r\n  methods: {\r\n    handleClick(vehicleNumber: any) {\r\n      // null means empty area clicked: clear map.\r\n      if (vehicleNumber === null) {\r\n        this.searchTerm = ''\r\n        return\r\n      }\r\n\r\n      const vehId = this.vehicleLookup[vehicleNumber]\r\n      console.log(vehId)\r\n\r\n      // set -- or clear -- search box!\r\n      if (this.searchTerm === vehId) this.searchTerm = ''\r\n      else this.searchTerm = vehId\r\n    },\r\n\r\n    arrayBufferToBase64(buffer: any) {\r\n      var binary = ''\r\n      var bytes = new Uint8Array(buffer)\r\n      var len = bytes.byteLength\r\n      for (var i = 0; i < len; i++) {\r\n        binary += String.fromCharCode(bytes[i])\r\n      }\r\n      return window.btoa(binary)\r\n    },\r\n\r\n    updateLegendColors() {\r\n      // const theme = this.myState.colorScheme == ColorScheme.LightMode ? LIGHT_MODE : DARK_MODE\r\n      // this.legendBits = [\r\n      //   { label: 'susceptible', color: theme.susceptible },\r\n      //   { label: 'latently infected', color: theme.infectedButNotContagious },\r\n      //   { label: 'contagious', color: theme.contagious },\r\n      //   { label: 'symptomatic', color: theme.symptomatic },\r\n      //   { label: 'seriously ill', color: theme.seriouslyIll },\r\n      //   { label: 'critical', color: theme.critical },\r\n      //   { label: 'recovered', color: theme.recovered },\r\n      // ]\r\n    },\r\n\r\n    setWallClock() {\r\n      const hour = Math.floor(this.simulationTime / 3600)\r\n      const minute = Math.floor(this.simulationTime / 60) % 60\r\n      this.myState.clock = `${hour < 10 ? '0' : ''}${hour}${minute < 10 ? ':0' : ':'}${minute}`\r\n    },\r\n\r\n    setTime(seconds: number) {\r\n      this.simulationTime = seconds\r\n      this.setWallClock()\r\n\r\n      // only filter if search is disabled and we have data loaded already\r\n      if (this.traceStart && this.pathStart && this.requestStart) {\r\n        this.pathStart.filter([0, this.simulationTime])\r\n        this.pathEnd?.filter([this.simulationTime, Infinity])\r\n\r\n        // scrub vehicles if search is disabled\r\n        if (!this.searchEnabled) {\r\n          this.traceStart.filter([0, this.simulationTime])\r\n          this.traceEnd?.filter([this.simulationTime, Infinity])\r\n          this.requestStart.filter([0, this.simulationTime])\r\n          this.requestEnd?.filter([this.simulationTime, Infinity])\r\n        }\r\n      }\r\n\r\n      //@ts-ignore\r\n      this.$options.paths = this.paths.allFiltered()\r\n      //@ts-ignore\r\n      this.$options.traces = this.traces.allFiltered()\r\n      //@ts-ignore\r\n      this.$options.drtRequests = this.requests.allFiltered()\r\n    },\r\n\r\n    toggleSimulation() {\r\n      console.log('CLICK !!!')\r\n      this.myState.isRunning = !this.myState.isRunning\r\n      this.timeElapsedSinceLastFrame = Date.now()\r\n\r\n      // ok so, many times I mashed the play/pause wondering why things wouldn't\r\n      // start moving. Turns out a 0x speed is not very helpful! Help the user\r\n      // out and switch the speed up if they press play.\r\n      if (this.myState.isRunning && this.speed === 0.0) this.speed = 1.0\r\n\r\n      // and begin!\r\n      if (this.myState.isRunning) this.animate()\r\n    },\r\n\r\n    /** Load background traffic.\r\n     * If saved as binary chunks in eventBlobs, load them sequentially.\r\n     * If it's a raw MATSim event file, export the chunks after loading! */\r\n    async loadBackgroundTraffic() {\r\n      if (this.vizDetails.eventBlobs) {\r\n        for (const blobFilename of this.vizDetails.eventBlobs) {\r\n          const layer = await this.loadBackgroundChunk(blobFilename)\r\n          this.trafficLayers.push(layer)\r\n        }\r\n      } else if (this.vizDetails.events) {\r\n        const parser = new EventParser({\r\n          fileSystem: this.fileSystem as any,\r\n          dataManager: new DashboardDataManager(this.root, this.subfolder),\r\n          vizDetails: this.vizDetails,\r\n          subfolder: this.subfolder,\r\n          // boundBox: [\r\n          //   [11.2, 48.6],\r\n          //   [12.3, 49.1],\r\n          // ],\r\n        })\r\n        const layers = await parser.loadFiles()\r\n        this.trafficLayers = layers\r\n        this.exportJSON(layers)\r\n      }\r\n    },\r\n\r\n    /** Load one binary-encoded traffic chunk */\r\n    async loadBackgroundChunk(blobFilename: string): Promise<any> {\r\n      return new Promise((resolve, reject) => {\r\n        console.log('load chunk:', blobFilename)\r\n        const gzipFetcher = new GzipFetcher()\r\n        gzipFetcher.onmessage = (event: MessageEvent) => {\r\n          const floats = new Float32Array(event.data.buffer)\r\n          const size = floats.length / 6\r\n          const bytes = 4\r\n\r\n          const layer = {\r\n            vehicles: {\r\n              locO: new Float32Array(event.data.buffer, 0, size * 2),\r\n              locD: new Float32Array(event.data.buffer, bytes * size * 2, size * 2),\r\n              t0: new Float32Array(event.data.buffer, bytes * size * 4, size),\r\n              t1: new Float32Array(event.data.buffer, bytes * size * 5, size),\r\n            },\r\n          }\r\n          resolve(layer)\r\n        }\r\n        gzipFetcher.postMessage({\r\n          filePath: this.myState.subfolder + '/' + blobFilename,\r\n          fileSystem: this.fileSystem,\r\n        })\r\n      })\r\n    },\r\n\r\n    exportJSON(layers: any[]) {\r\n      for (const layer of layers) {\r\n        const blob = new Blob(\r\n          [layer.vehicles.locO, layer.vehicles.locD, layer.vehicles.t0, layer.vehicles.t1],\r\n          { type: 'octet/stream' }\r\n        )\r\n        const blobURL = URL.createObjectURL(blob)\r\n\r\n        let element = document.createElement('a')\r\n        element.setAttribute('href', blobURL)\r\n        element.setAttribute('download', 'events.blob')\r\n        element.style.display = 'none'\r\n        document.body.appendChild(element)\r\n\r\n        element.click()\r\n\r\n        document.body.removeChild(element)\r\n      }\r\n    },\r\n\r\n    setEmbeddedMode() {\r\n      if ('embed' in this.$route.query) {\r\n        console.log('EMBEDDED MODE')\r\n        this.isEmbedded = true\r\n        this.$store.commit('setShowLeftBar', false)\r\n        this.$store.commit('setFullWidth', true)\r\n      }\r\n    },\r\n\r\n    async handleSettingChange(label: string) {\r\n      console.log(label)\r\n      this.SETTINGS[label] = !this.SETTINGS[label]\r\n      this.updateDatasetFilters()\r\n      this.simulationTime += 1 // this will force a redraw\r\n    },\r\n\r\n    // this happens if viz is the full page, not a thumbnail on a project page\r\n    buildRouteFromUrl() {\r\n      const params = this.$route.params\r\n      if (!params.project || !params.pathMatch) {\r\n        console.log('I CANT EVEN: NO PROJECT/PARHMATCH')\r\n        return\r\n      }\r\n\r\n      // subfolder and config file\r\n      const sep = 1 + params.pathMatch.lastIndexOf('/')\r\n      const subfolder = params.pathMatch.substring(0, sep)\r\n      const config = params.pathMatch.substring(sep)\r\n\r\n      this.myState.subfolder = subfolder\r\n      this.myState.yamlConfig = config\r\n    },\r\n\r\n    async getVizDetails() {\r\n      console.log('GETVIZ')\r\n\r\n      // first get config\r\n      try {\r\n        // might be a project config:\r\n        const filename =\r\n          this.myState.yamlConfig.indexOf('/') > -1\r\n            ? this.myState.yamlConfig\r\n            : this.myState.subfolder + '/' + this.myState.yamlConfig\r\n\r\n        const text = await this.fileApi.getFileText(filename)\r\n        this.vizDetails = YAML.parse(text)\r\n      } catch (err) {\r\n        console.log('failed')\r\n        const e = err as any\r\n        // maybe it failed because password?\r\n        if (this.fileSystem.needPassword && e.status === 401) {\r\n          globalStore.commit('requestLogin', this.fileSystem.slug)\r\n        }\r\n      }\r\n\r\n      // initial view\r\n      if (this.vizDetails.theme) this.$store.commit('setTheme', this.vizDetails.theme)\r\n\r\n      if (this.vizDetails.center) {\r\n        this.$store.commit('setMapCamera', {\r\n          longitude: this.vizDetails.center[0],\r\n          latitude: this.vizDetails.center[1],\r\n          zoom: this.vizDetails.zoom || 11,\r\n          pitch: this.vizDetails.pitch || 20,\r\n          bearing: this.vizDetails.bearing || 0,\r\n          jump: true,\r\n        })\r\n      }\r\n\r\n      // title\r\n      const t = this.vizDetails.title ? this.vizDetails.title : 'Agent Animation'\r\n      this.$emit('title', t)\r\n\r\n      this.buildThumbnail()\r\n      this.isLoaded = true\r\n    },\r\n\r\n    async buildThumbnail() {\r\n      if (this.thumbnail && this.vizDetails.thumbnail) {\r\n        try {\r\n          const blob = await this.fileApi.getFileBlob(\r\n            this.myState.subfolder + '/' + this.vizDetails.thumbnail\r\n          )\r\n          const buffer = await readBlob.arraybuffer(blob)\r\n          const base64 = this.arrayBufferToBase64(buffer)\r\n          if (base64)\r\n            this.thumbnailUrl = `center / cover no-repeat url(data:image/png;base64,${base64})`\r\n        } catch (e) {\r\n          console.error(e)\r\n        }\r\n      }\r\n    },\r\n    async parseDrtRequests(requests: any[]) {\r\n      if (this.vehicleLookup.length) {\r\n        for (const request of requests) {\r\n          try {\r\n            request[5] = this.vehicleLookupString[request[5]]\r\n          } catch (e) {}\r\n        }\r\n      }\r\n\r\n      return crossfilter(requests)\r\n    },\r\n\r\n    async parseVehicles(trips: any[]) {\r\n      const allTrips: any[] = []\r\n      let vehNumber = -1\r\n\r\n      await coroutines.forEachAsync(trips, (trip: any) => {\r\n        const path = trip.path\r\n        const timestamps = trip.timestamps\r\n        const passengers = trip.passengers\r\n\r\n        // attach vehicle ID to each segment so we can click\r\n        vehNumber++\r\n        this.vehicleLookup[vehNumber] = trip.id\r\n        this.vehicleLookupString[trip.id] = vehNumber\r\n\r\n        for (let i = 0; i < trip.path.length - 1; i++) {\r\n          allTrips.push({\r\n            t0: timestamps[i],\r\n            t1: timestamps[i + 1],\r\n            p0: path[i],\r\n            p1: path[i + 1],\r\n            v: vehNumber,\r\n            occ: passengers[i],\r\n          })\r\n        }\r\n      })\r\n      return crossfilter(allTrips)\r\n    },\r\n\r\n    updateDatasetFilters() {\r\n      // dont' filter if we haven't loaded yet\r\n      if (!this.traceStart || !this.pathStart || !this.requestStart) return\r\n\r\n      // filter out all traces that havent started or already finished\r\n      if (this.SETTINGS.routes) {\r\n        if (this.searchEnabled) {\r\n          this.traceStart.filterAll()\r\n          this.traceEnd?.filterAll()\r\n        } else {\r\n          this.traceStart.filter([0, this.simulationTime])\r\n          this.traceEnd?.filter([this.simulationTime, Infinity])\r\n        }\r\n        //@ts-ignore\r\n        this.$options.traces = this.traces.allFiltered()\r\n      }\r\n\r\n      if (this.SETTINGS.vehicles) {\r\n        this.pathStart.filter([0, this.simulationTime])\r\n        this.pathEnd?.filter([this.simulationTime, Infinity])\r\n        //@ts-ignore:\r\n        this.$options.paths = this.paths.allFiltered()\r\n      }\r\n\r\n      if (this.SETTINGS.requests) {\r\n        if (this.searchEnabled) {\r\n          this.requestStart.filterAll()\r\n          this.requestEnd?.filterAll()\r\n        } else {\r\n          this.requestStart.filter([0, this.simulationTime])\r\n          this.requestEnd?.filter([this.simulationTime, Infinity])\r\n        }\r\n        //@ts-ignore\r\n        this.$options.drtRequests = this.requests.allFiltered()\r\n      }\r\n    },\r\n\r\n    animate() {\r\n      if (this.myState.isRunning) {\r\n        const elapsed = Date.now() - this.timeElapsedSinceLastFrame\r\n        this.timeElapsedSinceLastFrame += elapsed\r\n        this.simulationTime += elapsed * this.speed * 0.05\r\n\r\n        this.updateDatasetFilters()\r\n        this.setWallClock()\r\n        window.requestAnimationFrame(this.animate)\r\n      }\r\n    },\r\n\r\n    handleVisibilityChange() {\r\n      if (this.isPausedDueToHiding && !document.hidden) {\r\n        console.log('unpausing')\r\n        this.isPausedDueToHiding = false\r\n        this.toggleSimulation()\r\n      } else if (this.myState.isRunning && document.hidden) {\r\n        console.log('pausing')\r\n        this.isPausedDueToHiding = true\r\n        this.toggleSimulation()\r\n      }\r\n    },\r\n\r\n    // convert path/timestamp info into path traces we can use\r\n    async parseRouteTraces(trips: any[]) {\r\n      let countTraces = 0\r\n      let vehNumber = -1\r\n\r\n      const traces: any = []\r\n\r\n      await coroutines.forEachAsync(trips, (vehicle: any) => {\r\n        vehNumber++\r\n\r\n        let time = vehicle.timestamps[0]\r\n        let nextTime = vehicle.timestamps[0]\r\n\r\n        let segments: any[] = []\r\n\r\n        for (let i = 1; i < vehicle.path.length; i++) {\r\n          nextTime = vehicle.timestamps[i]\r\n\r\n          // same point? start of new path.\r\n          if (\r\n            vehicle.path[i][0] === vehicle.path[i - 1][0] &&\r\n            vehicle.path[i][1] === vehicle.path[i - 1][1]\r\n          ) {\r\n            segments.forEach(segment => {\r\n              segment.t1 = vehicle.timestamps[i - 1]\r\n            })\r\n\r\n            traces.push(...segments)\r\n\r\n            segments = []\r\n            time = nextTime\r\n          } else {\r\n            segments.push({\r\n              t0: time,\r\n              p0: vehicle.path[i - 1],\r\n              p1: vehicle.path[i],\r\n              v: vehNumber,\r\n              occ: vehicle.passengers[i - 1],\r\n            })\r\n          }\r\n        }\r\n\r\n        // save final segments\r\n        segments.forEach(segment => {\r\n          segment.t1 = nextTime\r\n        })\r\n        traces.push(...segments)\r\n      })\r\n\r\n      return crossfilter(traces)\r\n    },\r\n\r\n    async loadFiles() {\r\n      if (!this.fileApi) return { trips: [], drtRequests: {} }\r\n\r\n      let trips: any[] = []\r\n      let drtRequests: any = []\r\n\r\n      try {\r\n        if (this.vizDetails.drtTrips.endsWith('json')) {\r\n          const json = await this.fileApi.getFileJson(\r\n            this.myState.subfolder + '/' + this.vizDetails.drtTrips\r\n          )\r\n          trips = json.trips\r\n          drtRequests = json.drtRequests\r\n        } else if (this.vizDetails.drtTrips.endsWith('gz')) {\r\n          const blob = await this.fileApi.getFileBlob(\r\n            this.myState.subfolder + '/' + this.vizDetails.drtTrips\r\n          )\r\n          const blobString = blob ? await blobToBinaryString(blob) : null\r\n          let text = await coroutines.run(pako.inflateAsync(blobString, { to: 'string' }))\r\n          const json = JSON.parse(text)\r\n\r\n          trips = json.trips\r\n          drtRequests = json.drtRequests\r\n        }\r\n      } catch (e) {\r\n        console.error(e)\r\n        this.myState.statusMessage = '' + e\r\n      }\r\n      return { trips, drtRequests }\r\n    },\r\n\r\n    toggleLoaded(loaded: boolean) {\r\n      this.isLoaded = loaded\r\n    },\r\n\r\n    rotateColors() {\r\n      this.myState.colorScheme =\r\n        this.myState.colorScheme === ColorScheme.DarkMode\r\n          ? ColorScheme.LightMode\r\n          : ColorScheme.DarkMode\r\n      localStorage.setItem('plugin/agent-animation/colorscheme', this.myState.colorScheme)\r\n    },\r\n  },\r\n})\r\n\r\n// !register plugin!\r\nglobalStore.commit('registerPlugin', {\r\n  kebabName: 'xmas-kelheim',\r\n  prettyName: 'Trip Viewer',\r\n  description: 'Deck.gl based trip viewer',\r\n  filePatterns: ['**/xmas-kelheim*.y?(a)ml'],\r\n  component: MyComponent,\r\n} as VisualizationPlugin)\r\n\r\nexport default MyComponent\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '~/vue-slider-component/theme/default.css';\r\n@import '@/styles.scss';\r\n\r\n.gl-app {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  display: grid;\r\n  pointer-events: none;\r\n  min-height: $thumbnailHeight;\r\n  background: url('assets/thumbnail.jpg') no-repeat;\r\n  background-size: cover;\r\n  grid-template-columns: 1fr min-content;\r\n  grid-template-rows: auto auto 1fr auto;\r\n  grid-template-areas:\r\n    'title         clock'\r\n    '.         rightside'\r\n    'playback  rightside'\r\n    'mobile      mobile';\r\n}\r\n\r\n.gl-app.hide-thumbnail {\r\n  background: none;\r\n}\r\n\r\n.nav {\r\n  z-index: 5;\r\n  grid-column: 1 / 4;\r\n  grid-row: 1 / 4;\r\n  box-shadow: 0px 2px 10px #22222266;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin: auto auto 0 0;\r\n  background-color: var(--bgPanel);\r\n  padding: 0rem 3rem;\r\n\r\n  a {\r\n    color: white;\r\n    text-decoration: none;\r\n\r\n    &.router-link-exact-active {\r\n      color: white;\r\n    }\r\n  }\r\n\r\n  p {\r\n    margin: auto 0.5rem auto 0;\r\n    font-weight: normal;\r\n    padding: 0 0;\r\n    color: var(--textFancy);\r\n  }\r\n}\r\n\r\n.speed-block {\r\n  margin-top: 1rem;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.legend-block {\r\n  margin-top: 1rem;\r\n}\r\n\r\n.speed-slider {\r\n  flex: 1;\r\n  width: 100%;\r\n  margin: 0.5rem 0.25rem 0.25rem 0rem;\r\n  padding: 0 0.5rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.big {\r\n  padding: 0rem 0;\r\n  font-size: 2.5rem;\r\n  line-height: 3.75rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.right-side {\r\n  width: 11rem;\r\n  grid-area: rightside;\r\n  display: flex;\r\n  flex-direction: column;\r\n  font-size: 0.8rem;\r\n  pointer-events: auto;\r\n  margin-top: auto;\r\n  margin-bottom: 35px;\r\n  z-index: 5;\r\n}\r\n\r\n.bottom-area {\r\n  grid-area: playback;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin-top: auto;\r\n  margin-bottom: 35px;\r\n  padding: 0.5rem 1rem;\r\n  pointer-events: auto;\r\n  width: 100%;\r\n}\r\n\r\n.settings-area {\r\n  z-index: 20;\r\n  pointer-events: auto;\r\n  font-size: 0.8rem;\r\n  padding: 0.25rem 0;\r\n  margin: 0.5rem 0rem 0 0;\r\n}\r\n\r\n.anim {\r\n  position: relative;\r\n  grid-column: 1 / 3;\r\n  grid-row: 1 / 4;\r\n  pointer-events: auto;\r\n}\r\n\r\n.speed-label {\r\n  font-size: 0.8rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.clock {\r\n  color: white;\r\n  width: 100%;\r\n  background-color: #000000cc;\r\n  border: 3px solid white;\r\n  color: white;\r\n}\r\n\r\n.clock p {\r\n  text-align: center;\r\n  padding: 5px 1.5rem;\r\n}\r\n\r\n.tooltip {\r\n  padding: 5rem 5rem;\r\n  background-color: #ccc;\r\n}\r\n\r\n.panel-items {\r\n  margin: 0.5rem 0.5rem;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\ninput {\r\n  border: none;\r\n  background-color: var(--bgCream);\r\n  color: #ccc;\r\n}\r\n\r\n.left-side {\r\n  grid-column: 1/4;\r\n  grid-row: 1/4;\r\n  display: flex;\r\n  flex-direction: column;\r\n  font-size: 0.8rem;\r\n  pointer-events: auto;\r\n  margin: 0 auto 0 0;\r\n  z-index: 1;\r\n}\r\n\r\n.bottom-controls-mobile {\r\n  display: none;\r\n  z-index: 2;\r\n  grid-column: 1 / 4;\r\n  grid-row: 4 / 5;\r\n  padding: 0 0.5rem;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n  .right-side {\r\n    display: none;\r\n  }\r\n\r\n  .bottom-controls-mobile {\r\n    display: inherit;\r\n  }\r\n\r\n  .legend-block {\r\n    margin-top: 0;\r\n  }\r\n\r\n  .nav {\r\n    padding: 0.5rem 0.5rem;\r\n  }\r\n\r\n  .clock {\r\n    text-align: center;\r\n  }\r\n\r\n  .right-side {\r\n    font-size: 0.7rem;\r\n    margin-right: 0.25rem;\r\n  }\r\n\r\n  .big {\r\n    padding: 0 0rem;\r\n    margin-top: 0.5rem;\r\n    font-size: 1.3rem;\r\n    line-height: 2rem;\r\n  }\r\n\r\n  .side-section {\r\n    margin-left: 0;\r\n  }\r\n\r\n  .extra-buttons {\r\n    margin-right: 1rem;\r\n  }\r\n  .playback-stuff {\r\n    padding-right: 1rem;\r\n  }\r\n\r\n  .bottom-area {\r\n    margin-bottom: 32px;\r\n  }\r\n}\r\n</style>\r\n","import { LegendItem } from '@/Globals'\r\nimport React from 'react'\r\n\r\nexport default function Component(props: {\r\n  title: string\r\n  description?: string\r\n  values: number[]\r\n  items: LegendItem[]\r\n  mobile: boolean\r\n}) {\r\n  const regStyle = { display: 'flex' } as any\r\n  const mobileStyle = { boxSizing: 'border-box', float: 'left', marginRight: '0.5rem' } as any\r\n\r\n  const listItems = props.items.map(item => (\r\n    <li key={item.value + item.value[0]} style={props.mobile ? mobileStyle : regStyle}>\r\n      {item.label && (\r\n        <div\r\n          style={{\r\n            margin: '0 0.5rem 0.0rem 0',\r\n            fontWeight: 'bold',\r\n          }}\r\n        >\r\n          {item.label}\r\n        </div>\r\n      )}\r\n      <div\r\n        style={{\r\n          width: props.mobile ? '3rem' : '100%',\r\n          height: `3px`,\r\n          marginTop: '0.5rem',\r\n          backgroundColor: `rgb(${item.color})`,\r\n        }}\r\n      ></div>\r\n    </li>\r\n  ))\r\n\r\n  return (\r\n    <div>\r\n      <h4\r\n        style={{\r\n          textAlign: 'left',\r\n          fontWeight: 'bold',\r\n          margin: '1rem 0 0.25rem 0',\r\n          fontSize: '0.8rem',\r\n        }}\r\n      >\r\n        {props.title}\r\n      </h4>\r\n      <p>{props.description}</p>\r\n      <ul style={{ listStyle: 'none', padding: 0, margin: 0 }}>{listItems}</ul>\r\n    </div>\r\n  )\r\n}\r\n","\r\n.gl-app(:class=\"{'hide-thumbnail': !thumbnail}\"\r\n        :style='{\"background\": urlThumbnail}' oncontextmenu=\"return false\")\r\n\r\n  trip-viz.anim(v-if=\"!thumbnail\"\r\n                :center = \"vizDetails.center\"\r\n                :colors = \"COLOR_OCCUPANCY\"\r\n                :drtRequests = \"$options.drtRequests\"\r\n                :dark = \"globalState.isDarkMode\"\r\n                :paths = \"$options.paths\"\r\n                :settingsShowLayers = \"SETTINGS\"\r\n                :searchEnabled = \"searchEnabled\"\r\n                :simulationTime = \"simulationTime\"\r\n                :traces = \"$options.traces\"\r\n                :vehicleLookup = \"vehicleLookup\"\r\n                :viewId = \"viewId\"\r\n                :onClick = \"handleClick\"\r\n                :trafficLayers = \"trafficLayers\"\r\n  )\r\n\r\n  zoom-buttons(v-if=\"!thumbnail\")\r\n\r\n  .bottom-controls-mobile\r\n    .big.clock: p {{ myState.clock }}\r\n    legend-colors.legend-block(v-if=\"legendItems.length\" :mobile=\"true\"\r\n          :title=\"`${$t('passengers')}:`\" :items=\"legendItems\")\r\n    settings-panel.settings-area(:items=\"SETTINGS\" @click=\"handleSettingChange\")\r\n\r\n  .right-side(v-if=\"isLoaded && !thumbnail\")\r\n    collapsible-panel(direction=\"right\")\r\n      .big.clock: p {{ myState.clock }}\r\n\r\n      .panel-items\r\n        legend-colors.legend-block(v-if=\"legendItems.length\"\r\n          :title=\"`${$t('passengers')}:`\" :items=\"legendItems\")\r\n\r\n        legend-colors.legend-block(:title=\"`${$t('requests')}:`\" :items=\"legendRequests\" :mobile=\"false\")\r\n\r\n        settings-panel.settings-area(:items=\"SETTINGS\" @click=\"handleSettingChange\")\r\n\r\n        .speed-block\r\n          p.speed-label {{ $t('speed') }}:\r\n            br\r\n            | {{ speed }}x\r\n\r\n          b-slider.speed-slider(v-model=\"speed\"\r\n            :min=\"speedStops[0]\"\r\n            :max=\"speedStops[speedStops.length-1]\"\r\n            :duration=\"0\"\r\n            :dotSize=\"20\"\r\n            :tooltip=\"true\"\r\n            tooltip-placement=\"bottom\"\r\n            :tooltip-formatter=\"val => val + 'x'\"\r\n          )\r\n            template(v-for=\"val in speedStops\")\r\n              b-slider-tick(:value=\"val\" :key=\"val\")\r\n\r\n  playback-controls.bottom-area(v-if=\"!thumbnail && isLoaded\"\r\n      @click='toggleSimulation'\r\n      @time='setTime'\r\n      :timeStart = \"timeStart\"\r\n      :timeEnd = \"timeEnd\"\r\n      :isRunning = \"myState.isRunning\"\r\n      :currentTime = \"simulationTime\")\r\n\r\n","/**\n * lil-gui\n * https://lil-gui.georgealways.com\n * @version 0.17.0\n * @author George Michael Brower\n * @license MIT\n */\n\n/**\n * Base class for all controllers.\n */\nclass Controller {\n\n\tconstructor( parent, object, property, className, widgetTag = 'div' ) {\n\n\t\t/**\n\t\t * The GUI that contains this controller.\n\t\t * @type {GUI}\n\t\t */\n\t\tthis.parent = parent;\n\n\t\t/**\n\t\t * The object this controller will modify.\n\t\t * @type {object}\n\t\t */\n\t\tthis.object = object;\n\n\t\t/**\n\t\t * The name of the property to control.\n\t\t * @type {string}\n\t\t */\n\t\tthis.property = property;\n\n\t\t/**\n\t\t * Used to determine if the controller is disabled.\n\t\t * Use `controller.disable( true|false )` to modify this value\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._disabled = false;\n\n\t\t/**\n\t\t * Used to determine if the Controller is hidden.\n\t\t * Use `controller.show()` or `controller.hide()` to change this.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._hidden = false;\n\n\t\t/**\n\t\t * The value of `object[ property ]` when the controller was created.\n\t\t * @type {any}\n\t\t */\n\t\tthis.initialValue = this.getValue();\n\n\t\t/**\n\t\t * The outermost container DOM element for this controller.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.domElement = document.createElement( 'div' );\n\t\tthis.domElement.classList.add( 'controller' );\n\t\tthis.domElement.classList.add( className );\n\n\t\t/**\n\t\t * The DOM element that contains the controller's name.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$name = document.createElement( 'div' );\n\t\tthis.$name.classList.add( 'name' );\n\n\t\tController.nextNameID = Controller.nextNameID || 0;\n\t\tthis.$name.id = `lil-gui-name-${++Controller.nextNameID}`;\n\n\t\t/**\n\t\t * The DOM element that contains the controller's \"widget\" (which differs by controller type).\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$widget = document.createElement( widgetTag );\n\t\tthis.$widget.classList.add( 'widget' );\n\n\t\t/**\n\t\t * The DOM element that receives the disabled attribute when using disable()\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$disable = this.$widget;\n\n\t\tthis.domElement.appendChild( this.$name );\n\t\tthis.domElement.appendChild( this.$widget );\n\n\t\tthis.parent.children.push( this );\n\t\tthis.parent.controllers.push( this );\n\n\t\tthis.parent.$children.appendChild( this.domElement );\n\n\t\tthis._listenCallback = this._listenCallback.bind( this );\n\n\t\tthis.name( property );\n\n\t}\n\n\t/**\n\t * Sets the name of the controller and its label in the GUI.\n\t * @param {string} name\n\t * @returns {this}\n\t */\n\tname( name ) {\n\t\t/**\n\t\t * The controller's name. Use `controller.name( 'Name' )` to modify this value.\n\t\t * @type {string}\n\t\t */\n\t\tthis._name = name;\n\t\tthis.$name.innerHTML = name;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Pass a function to be called whenever the value is modified by this controller.\n\t * The function receives the new value as its first parameter. The value of `this` will be the\n\t * controller.\n\t * @param {Function} callback\n\t * @returns {this}\n\t * @example\n\t * const controller = gui.add( object, 'property' );\n\t *\n\t * controller.onChange( function( v ) {\n\t * \tconsole.log( 'The value is now ' + v );\n\t * \tconsole.assert( this === controller );\n\t * } );\n\t */\n\tonChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onChange` events. Don't modify this value directly.\n\t\t * Use the `controller.onChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onChange = callback;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Calls the onChange methods of this controller and its parent GUI.\n\t * @protected\n\t */\n\t_callOnChange() {\n\n\t\tthis.parent._callOnChange( this );\n\n\t\tif ( this._onChange !== undefined ) {\n\t\t\tthis._onChange.call( this, this.getValue() );\n\t\t}\n\n\t\tthis._changed = true;\n\n\t}\n\n\t/**\n\t * Pass a function to be called after this controller has been modified and loses focus.\n\t * @param {Function} callback\n\t * @returns {this}\n\t * @example\n\t * const controller = gui.add( object, 'property' );\n\t *\n\t * controller.onFinishChange( function( v ) {\n\t * \tconsole.log( 'Changes complete: ' + v );\n\t * \tconsole.assert( this === controller );\n\t * } );\n\t */\n\tonFinishChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onFinishChange` events. Don't modify this value\n\t\t * directly. Use the `controller.onFinishChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onFinishChange = callback;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Should be called by Controller when its widgets lose focus.\n\t * @protected\n\t */\n\t_callOnFinishChange() {\n\n\t\tif ( this._changed ) {\n\n\t\t\tthis.parent._callOnFinishChange( this );\n\n\t\t\tif ( this._onFinishChange !== undefined ) {\n\t\t\t\tthis._onFinishChange.call( this, this.getValue() );\n\t\t\t}\n\n\t\t}\n\n\t\tthis._changed = false;\n\n\t}\n\n\t/**\n\t * Sets the controller back to its initial value.\n\t * @returns {this}\n\t */\n\treset() {\n\t\tthis.setValue( this.initialValue );\n\t\tthis._callOnFinishChange();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Enables this controller.\n\t * @param {boolean} enabled\n\t * @returns {this}\n\t * @example\n\t * controller.enable();\n\t * controller.enable( false ); // disable\n\t * controller.enable( controller._disabled ); // toggle\n\t */\n\tenable( enabled = true ) {\n\t\treturn this.disable( !enabled );\n\t}\n\n\t/**\n\t * Disables this controller.\n\t * @param {boolean} disabled\n\t * @returns {this}\n\t * @example\n\t * controller.disable();\n\t * controller.disable( false ); // enable\n\t * controller.disable( !controller._disabled ); // toggle\n\t */\n\tdisable( disabled = true ) {\n\n\t\tif ( disabled === this._disabled ) return this;\n\n\t\tthis._disabled = disabled;\n\n\t\tthis.domElement.classList.toggle( 'disabled', disabled );\n\t\tthis.$disable.toggleAttribute( 'disabled', disabled );\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Shows the Controller after it's been hidden.\n\t * @param {boolean} show\n\t * @returns {this}\n\t * @example\n\t * controller.show();\n\t * controller.show( false ); // hide\n\t * controller.show( controller._hidden ); // toggle\n\t */\n\tshow( show = true ) {\n\n\t\tthis._hidden = !show;\n\n\t\tthis.domElement.style.display = this._hidden ? 'none' : '';\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Hides the Controller.\n\t * @returns {this}\n\t */\n\thide() {\n\t\treturn this.show( false );\n\t}\n\n\t/**\n\t * Destroys this controller and replaces it with a new option controller. Provided as a more\n\t * descriptive syntax for `gui.add`, but primarily for compatibility with dat.gui.\n\t *\n\t * Use caution, as this method will destroy old references to this controller. It will also\n\t * change controller order if called out of sequence, moving the option controller to the end of\n\t * the GUI.\n\t * @example\n\t * // safe usage\n\t *\n\t * gui.add( object1, 'property' ).options( [ 'a', 'b', 'c' ] );\n\t * gui.add( object2, 'property' );\n\t *\n\t * // danger\n\t *\n\t * const c = gui.add( object1, 'property' );\n\t * gui.add( object2, 'property' );\n\t *\n\t * c.options( [ 'a', 'b', 'c' ] );\n\t * // controller is now at the end of the GUI even though it was added first\n\t *\n\t * assert( c.parent.children.indexOf( c ) === -1 )\n\t * // c references a controller that no longer exists\n\t *\n\t * @param {object|Array} options\n\t * @returns {Controller}\n\t */\n\toptions( options ) {\n\t\tconst controller = this.parent.add( this.object, this.property, options );\n\t\tcontroller.name( this._name );\n\t\tthis.destroy();\n\t\treturn controller;\n\t}\n\n\t/**\n\t * Sets the minimum value. Only works on number controllers.\n\t * @param {number} min\n\t * @returns {this}\n\t */\n\tmin( min ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the maximum value. Only works on number controllers.\n\t * @param {number} max\n\t * @returns {this}\n\t */\n\tmax( max ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Values set by this controller will be rounded to multiples of `step`. Only works on number\n\t * controllers.\n\t * @param {number} step\n\t * @returns {this}\n\t */\n\tstep( step ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Rounds the displayed value to a fixed number of decimals, without affecting the actual value\n\t * like `step()`. Only works on number controllers.\n\t * @example\n\t * gui.add( object, 'property' ).listen().decimals( 4 );\n\t * @param {number} decimals\n\t * @returns {this}\n\t */\n\tdecimals( decimals ) {\n\t\treturn this;\n\t}\n\n\t/**\n\t * Calls `updateDisplay()` every animation frame. Pass `false` to stop listening.\n\t * @param {boolean} listen\n\t * @returns {this}\n\t */\n\tlisten( listen = true ) {\n\n\t\t/**\n\t\t * Used to determine if the controller is currently listening. Don't modify this value\n\t\t * directly. Use the `controller.listen( true|false )` method instead.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._listening = listen;\n\n\t\tif ( this._listenCallbackID !== undefined ) {\n\t\t\tcancelAnimationFrame( this._listenCallbackID );\n\t\t\tthis._listenCallbackID = undefined;\n\t\t}\n\n\t\tif ( this._listening ) {\n\t\t\tthis._listenCallback();\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t_listenCallback() {\n\n\t\tthis._listenCallbackID = requestAnimationFrame( this._listenCallback );\n\n\t\t// To prevent framerate loss, make sure the value has changed before updating the display.\n\t\t// Note: save() is used here instead of getValue() only because of ColorController. The !== operator\n\t\t// won't work for color objects or arrays, but ColorController.save() always returns a string.\n\n\t\tconst curValue = this.save();\n\n\t\tif ( curValue !== this._listenPrevValue ) {\n\t\t\tthis.updateDisplay();\n\t\t}\n\n\t\tthis._listenPrevValue = curValue;\n\n\t}\n\n\t/**\n\t * Returns `object[ property ]`.\n\t * @returns {any}\n\t */\n\tgetValue() {\n\t\treturn this.object[ this.property ];\n\t}\n\n\t/**\n\t * Sets the value of `object[ property ]`, invokes any `onChange` handlers and updates the display.\n\t * @param {any} value\n\t * @returns {this}\n\t */\n\tsetValue( value ) {\n\t\tthis.object[ this.property ] = value;\n\t\tthis._callOnChange();\n\t\tthis.updateDisplay();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Updates the display to keep it in sync with the current value. Useful for updating your\n\t * controllers when their values have been modified outside of the GUI.\n\t * @returns {this}\n\t */\n\tupdateDisplay() {\n\t\treturn this;\n\t}\n\n\tload( value ) {\n\t\tthis.setValue( value );\n\t\tthis._callOnFinishChange();\n\t\treturn this;\n\t}\n\n\tsave() {\n\t\treturn this.getValue();\n\t}\n\n\t/**\n\t * Destroys this controller and removes it from the parent GUI.\n\t */\n\tdestroy() {\n\t\tthis.listen( false );\n\t\tthis.parent.children.splice( this.parent.children.indexOf( this ), 1 );\n\t\tthis.parent.controllers.splice( this.parent.controllers.indexOf( this ), 1 );\n\t\tthis.parent.$children.removeChild( this.domElement );\n\t}\n\n}\n\nclass BooleanController extends Controller {\n\n\tconstructor( parent, object, property ) {\n\n\t\tsuper( parent, object, property, 'boolean', 'label' );\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'checkbox' );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$widget.appendChild( this.$input );\n\n\t\tthis.$input.addEventListener( 'change', () => {\n\t\t\tthis.setValue( this.$input.checked );\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$disable = this.$input;\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tupdateDisplay() {\n\t\tthis.$input.checked = this.getValue();\n\t\treturn this;\n\t}\n\n}\n\nfunction normalizeColorString( string ) {\n\n\tlet match, result;\n\n\tif ( match = string.match( /(#|0x)?([a-f0-9]{6})/i ) ) {\n\n\t\tresult = match[ 2 ];\n\n\t} else if ( match = string.match( /rgb\\(\\s*(\\d*)\\s*,\\s*(\\d*)\\s*,\\s*(\\d*)\\s*\\)/ ) ) {\n\n\t\tresult = parseInt( match[ 1 ] ).toString( 16 ).padStart( 2, 0 )\n\t\t\t+ parseInt( match[ 2 ] ).toString( 16 ).padStart( 2, 0 )\n\t\t\t+ parseInt( match[ 3 ] ).toString( 16 ).padStart( 2, 0 );\n\n\t} else if ( match = string.match( /^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i ) ) {\n\n\t\tresult = match[ 1 ] + match[ 1 ] + match[ 2 ] + match[ 2 ] + match[ 3 ] + match[ 3 ];\n\n\t}\n\n\tif ( result ) {\n\t\treturn '#' + result;\n\t}\n\n\treturn false;\n\n}\n\nconst STRING = {\n\tisPrimitive: true,\n\tmatch: v => typeof v === 'string',\n\tfromHexString: normalizeColorString,\n\ttoHexString: normalizeColorString\n};\n\nconst INT = {\n\tisPrimitive: true,\n\tmatch: v => typeof v === 'number',\n\tfromHexString: string => parseInt( string.substring( 1 ), 16 ),\n\ttoHexString: value => '#' + value.toString( 16 ).padStart( 6, 0 )\n};\n\nconst ARRAY = {\n\tisPrimitive: false,\n\tmatch: Array.isArray,\n\tfromHexString( string, target, rgbScale = 1 ) {\n\n\t\tconst int = INT.fromHexString( string );\n\n\t\ttarget[ 0 ] = ( int >> 16 & 255 ) / 255 * rgbScale;\n\t\ttarget[ 1 ] = ( int >> 8 & 255 ) / 255 * rgbScale;\n\t\ttarget[ 2 ] = ( int & 255 ) / 255 * rgbScale;\n\n\t},\n\ttoHexString( [ r, g, b ], rgbScale = 1 ) {\n\n\t\trgbScale = 255 / rgbScale;\n\n\t\tconst int = ( r * rgbScale ) << 16 ^\n\t\t\t( g * rgbScale ) << 8 ^\n\t\t\t( b * rgbScale ) << 0;\n\n\t\treturn INT.toHexString( int );\n\n\t}\n};\n\nconst OBJECT = {\n\tisPrimitive: false,\n\tmatch: v => Object( v ) === v,\n\tfromHexString( string, target, rgbScale = 1 ) {\n\n\t\tconst int = INT.fromHexString( string );\n\n\t\ttarget.r = ( int >> 16 & 255 ) / 255 * rgbScale;\n\t\ttarget.g = ( int >> 8 & 255 ) / 255 * rgbScale;\n\t\ttarget.b = ( int & 255 ) / 255 * rgbScale;\n\n\t},\n\ttoHexString( { r, g, b }, rgbScale = 1 ) {\n\n\t\trgbScale = 255 / rgbScale;\n\n\t\tconst int = ( r * rgbScale ) << 16 ^\n\t\t\t( g * rgbScale ) << 8 ^\n\t\t\t( b * rgbScale ) << 0;\n\n\t\treturn INT.toHexString( int );\n\n\t}\n};\n\nconst FORMATS = [ STRING, INT, ARRAY, OBJECT ];\n\nfunction getColorFormat( value ) {\n\treturn FORMATS.find( format => format.match( value ) );\n}\n\nclass ColorController extends Controller {\n\n\tconstructor( parent, object, property, rgbScale ) {\n\n\t\tsuper( parent, object, property, 'color' );\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'color' );\n\t\tthis.$input.setAttribute( 'tabindex', -1 );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$text = document.createElement( 'input' );\n\t\tthis.$text.setAttribute( 'type', 'text' );\n\t\tthis.$text.setAttribute( 'spellcheck', 'false' );\n\t\tthis.$text.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$display = document.createElement( 'div' );\n\t\tthis.$display.classList.add( 'display' );\n\n\t\tthis.$display.appendChild( this.$input );\n\t\tthis.$widget.appendChild( this.$display );\n\t\tthis.$widget.appendChild( this.$text );\n\n\t\tthis._format = getColorFormat( this.initialValue );\n\t\tthis._rgbScale = rgbScale;\n\n\t\tthis._initialValueHexString = this.save();\n\t\tthis._textFocused = false;\n\n\t\tthis.$input.addEventListener( 'input', () => {\n\t\t\tthis._setValueFromHexString( this.$input.value );\n\t\t} );\n\n\t\tthis.$input.addEventListener( 'blur', () => {\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$text.addEventListener( 'input', () => {\n\t\t\tconst tryParse = normalizeColorString( this.$text.value );\n\t\t\tif ( tryParse ) {\n\t\t\t\tthis._setValueFromHexString( tryParse );\n\t\t\t}\n\t\t} );\n\n\t\tthis.$text.addEventListener( 'focus', () => {\n\t\t\tthis._textFocused = true;\n\t\t\tthis.$text.select();\n\t\t} );\n\n\t\tthis.$text.addEventListener( 'blur', () => {\n\t\t\tthis._textFocused = false;\n\t\t\tthis.updateDisplay();\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$disable = this.$text;\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\treset() {\n\t\tthis._setValueFromHexString( this._initialValueHexString );\n\t\treturn this;\n\t}\n\n\t_setValueFromHexString( value ) {\n\n\t\tif ( this._format.isPrimitive ) {\n\n\t\t\tconst newValue = this._format.fromHexString( value );\n\t\t\tthis.setValue( newValue );\n\n\t\t} else {\n\n\t\t\tthis._format.fromHexString( value, this.getValue(), this._rgbScale );\n\t\t\tthis._callOnChange();\n\t\t\tthis.updateDisplay();\n\n\t\t}\n\n\t}\n\n\tsave() {\n\t\treturn this._format.toHexString( this.getValue(), this._rgbScale );\n\t}\n\n\tload( value ) {\n\t\tthis._setValueFromHexString( value );\n\t\tthis._callOnFinishChange();\n\t\treturn this;\n\t}\n\n\tupdateDisplay() {\n\t\tthis.$input.value = this._format.toHexString( this.getValue(), this._rgbScale );\n\t\tif ( !this._textFocused ) {\n\t\t\tthis.$text.value = this.$input.value.substring( 1 );\n\t\t}\n\t\tthis.$display.style.backgroundColor = this.$input.value;\n\t\treturn this;\n\t}\n\n}\n\nclass FunctionController extends Controller {\n\n\tconstructor( parent, object, property ) {\n\n\t\tsuper( parent, object, property, 'function' );\n\n\t\t// Buttons are the only case where widget contains name\n\t\tthis.$button = document.createElement( 'button' );\n\t\tthis.$button.appendChild( this.$name );\n\t\tthis.$widget.appendChild( this.$button );\n\n\t\tthis.$button.addEventListener( 'click', e => {\n\t\t\te.preventDefault();\n\t\t\tthis.getValue().call( this.object );\n\t\t} );\n\n\t\t// enables :active pseudo class on mobile\n\t\tthis.$button.addEventListener( 'touchstart', () => {}, { passive: true } );\n\n\t\tthis.$disable = this.$button;\n\n\t}\n\n}\n\nclass NumberController extends Controller {\n\n\tconstructor( parent, object, property, min, max, step ) {\n\n\t\tsuper( parent, object, property, 'number' );\n\n\t\tthis._initInput();\n\n\t\tthis.min( min );\n\t\tthis.max( max );\n\n\t\tconst stepExplicit = step !== undefined;\n\t\tthis.step( stepExplicit ? step : this._getImplicitStep(), stepExplicit );\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tdecimals( decimals ) {\n\t\tthis._decimals = decimals;\n\t\tthis.updateDisplay();\n\t\treturn this;\n\t}\n\n\tmin( min ) {\n\t\tthis._min = min;\n\t\tthis._onUpdateMinMax();\n\t\treturn this;\n\t}\n\n\tmax( max ) {\n\t\tthis._max = max;\n\t\tthis._onUpdateMinMax();\n\t\treturn this;\n\t}\n\n\tstep( step, explicit = true ) {\n\t\tthis._step = step;\n\t\tthis._stepExplicit = explicit;\n\t\treturn this;\n\t}\n\n\tupdateDisplay() {\n\n\t\tconst value = this.getValue();\n\n\t\tif ( this._hasSlider ) {\n\n\t\t\tlet percent = ( value - this._min ) / ( this._max - this._min );\n\t\t\tpercent = Math.max( 0, Math.min( percent, 1 ) );\n\n\t\t\tthis.$fill.style.width = percent * 100 + '%';\n\n\t\t}\n\n\t\tif ( !this._inputFocused ) {\n\t\t\tthis.$input.value = this._decimals === undefined ? value : value.toFixed( this._decimals );\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t_initInput() {\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'number' );\n\t\tthis.$input.setAttribute( 'step', 'any' );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$widget.appendChild( this.$input );\n\n\t\tthis.$disable = this.$input;\n\n\t\tconst onInput = () => {\n\n\t\t\tlet value = parseFloat( this.$input.value );\n\n\t\t\tif ( isNaN( value ) ) return;\n\n\t\t\tif ( this._stepExplicit ) {\n\t\t\t\tvalue = this._snap( value );\n\t\t\t}\n\n\t\t\tthis.setValue( this._clamp( value ) );\n\n\t\t};\n\n\t\t// Keys & mouse wheel\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst increment = delta => {\n\n\t\t\tconst value = parseFloat( this.$input.value );\n\n\t\t\tif ( isNaN( value ) ) return;\n\n\t\t\tthis._snapClampSetValue( value + delta );\n\n\t\t\t// Force the input to updateDisplay when it's focused\n\t\t\tthis.$input.value = this.getValue();\n\n\t\t};\n\n\t\tconst onKeyDown = e => {\n\t\t\tif ( e.code === 'Enter' ) {\n\t\t\t\tthis.$input.blur();\n\t\t\t}\n\t\t\tif ( e.code === 'ArrowUp' ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tincrement( this._step * this._arrowKeyMultiplier( e ) );\n\t\t\t}\n\t\t\tif ( e.code === 'ArrowDown' ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tincrement( this._step * this._arrowKeyMultiplier( e ) * -1 );\n\t\t\t}\n\t\t};\n\n\t\tconst onWheel = e => {\n\t\t\tif ( this._inputFocused ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tincrement( this._step * this._normalizeMouseWheel( e ) );\n\t\t\t}\n\t\t};\n\n\t\t// Vertical drag\n\t\t// ---------------------------------------------------------------------\n\n\t\tlet testingForVerticalDrag = false,\n\t\t\tinitClientX,\n\t\t\tinitClientY,\n\t\t\tprevClientY,\n\t\t\tinitValue,\n\t\t\tdragDelta;\n\n\t\t// Once the mouse is dragged more than DRAG_THRESH px on any axis, we decide\n\t\t// on the user's intent: horizontal means highlight, vertical means drag.\n\t\tconst DRAG_THRESH = 5;\n\n\t\tconst onMouseDown = e => {\n\n\t\t\tinitClientX = e.clientX;\n\t\t\tinitClientY = prevClientY = e.clientY;\n\t\t\ttestingForVerticalDrag = true;\n\n\t\t\tinitValue = this.getValue();\n\t\t\tdragDelta = 0;\n\n\t\t\twindow.addEventListener( 'mousemove', onMouseMove );\n\t\t\twindow.addEventListener( 'mouseup', onMouseUp );\n\n\t\t};\n\n\t\tconst onMouseMove = e => {\n\n\t\t\tif ( testingForVerticalDrag ) {\n\n\t\t\t\tconst dx = e.clientX - initClientX;\n\t\t\t\tconst dy = e.clientY - initClientY;\n\n\t\t\t\tif ( Math.abs( dy ) > DRAG_THRESH ) {\n\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.$input.blur();\n\t\t\t\t\ttestingForVerticalDrag = false;\n\t\t\t\t\tthis._setDraggingStyle( true, 'vertical' );\n\n\t\t\t\t} else if ( Math.abs( dx ) > DRAG_THRESH ) {\n\n\t\t\t\t\tonMouseUp();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// This isn't an else so that the first move counts towards dragDelta\n\t\t\tif ( !testingForVerticalDrag ) {\n\n\t\t\t\tconst dy = e.clientY - prevClientY;\n\n\t\t\t\tdragDelta -= dy * this._step * this._arrowKeyMultiplier( e );\n\n\t\t\t\t// Clamp dragDelta so we don't have 'dead space' after dragging past bounds.\n\t\t\t\t// We're okay with the fact that bounds can be undefined here.\n\t\t\t\tif ( initValue + dragDelta > this._max ) {\n\t\t\t\t\tdragDelta = this._max - initValue;\n\t\t\t\t} else if ( initValue + dragDelta < this._min ) {\n\t\t\t\t\tdragDelta = this._min - initValue;\n\t\t\t\t}\n\n\t\t\t\tthis._snapClampSetValue( initValue + dragDelta );\n\n\t\t\t}\n\n\t\t\tprevClientY = e.clientY;\n\n\t\t};\n\n\t\tconst onMouseUp = () => {\n\t\t\tthis._setDraggingStyle( false, 'vertical' );\n\t\t\tthis._callOnFinishChange();\n\t\t\twindow.removeEventListener( 'mousemove', onMouseMove );\n\t\t\twindow.removeEventListener( 'mouseup', onMouseUp );\n\t\t};\n\n\t\t// Focus state & onFinishChange\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst onFocus = () => {\n\t\t\tthis._inputFocused = true;\n\t\t};\n\n\t\tconst onBlur = () => {\n\t\t\tthis._inputFocused = false;\n\t\t\tthis.updateDisplay();\n\t\t\tthis._callOnFinishChange();\n\t\t};\n\n\t\tthis.$input.addEventListener( 'input', onInput );\n\t\tthis.$input.addEventListener( 'keydown', onKeyDown );\n\t\tthis.$input.addEventListener( 'wheel', onWheel, { passive: false } );\n\t\tthis.$input.addEventListener( 'mousedown', onMouseDown );\n\t\tthis.$input.addEventListener( 'focus', onFocus );\n\t\tthis.$input.addEventListener( 'blur', onBlur );\n\n\t}\n\n\t_initSlider() {\n\n\t\tthis._hasSlider = true;\n\n\t\t// Build DOM\n\t\t// ---------------------------------------------------------------------\n\n\t\tthis.$slider = document.createElement( 'div' );\n\t\tthis.$slider.classList.add( 'slider' );\n\n\t\tthis.$fill = document.createElement( 'div' );\n\t\tthis.$fill.classList.add( 'fill' );\n\n\t\tthis.$slider.appendChild( this.$fill );\n\t\tthis.$widget.insertBefore( this.$slider, this.$input );\n\n\t\tthis.domElement.classList.add( 'hasSlider' );\n\n\t\t// Map clientX to value\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst map = ( v, a, b, c, d ) => {\n\t\t\treturn ( v - a ) / ( b - a ) * ( d - c ) + c;\n\t\t};\n\n\t\tconst setValueFromX = clientX => {\n\t\t\tconst rect = this.$slider.getBoundingClientRect();\n\t\t\tlet value = map( clientX, rect.left, rect.right, this._min, this._max );\n\t\t\tthis._snapClampSetValue( value );\n\t\t};\n\n\t\t// Mouse drag\n\t\t// ---------------------------------------------------------------------\n\n\t\tconst mouseDown = e => {\n\t\t\tthis._setDraggingStyle( true );\n\t\t\tsetValueFromX( e.clientX );\n\t\t\twindow.addEventListener( 'mousemove', mouseMove );\n\t\t\twindow.addEventListener( 'mouseup', mouseUp );\n\t\t};\n\n\t\tconst mouseMove = e => {\n\t\t\tsetValueFromX( e.clientX );\n\t\t};\n\n\t\tconst mouseUp = () => {\n\t\t\tthis._callOnFinishChange();\n\t\t\tthis._setDraggingStyle( false );\n\t\t\twindow.removeEventListener( 'mousemove', mouseMove );\n\t\t\twindow.removeEventListener( 'mouseup', mouseUp );\n\t\t};\n\n\t\t// Touch drag\n\t\t// ---------------------------------------------------------------------\n\n\t\tlet testingForScroll = false, prevClientX, prevClientY;\n\n\t\tconst beginTouchDrag = e => {\n\t\t\te.preventDefault();\n\t\t\tthis._setDraggingStyle( true );\n\t\t\tsetValueFromX( e.touches[ 0 ].clientX );\n\t\t\ttestingForScroll = false;\n\t\t};\n\n\t\tconst onTouchStart = e => {\n\n\t\t\tif ( e.touches.length > 1 ) return;\n\n\t\t\t// If we're in a scrollable container, we should wait for the first\n\t\t\t// touchmove to see if the user is trying to slide or scroll.\n\t\t\tif ( this._hasScrollBar ) {\n\n\t\t\t\tprevClientX = e.touches[ 0 ].clientX;\n\t\t\t\tprevClientY = e.touches[ 0 ].clientY;\n\t\t\t\ttestingForScroll = true;\n\n\t\t\t} else {\n\n\t\t\t\t// Otherwise, we can set the value straight away on touchstart.\n\t\t\t\tbeginTouchDrag( e );\n\n\t\t\t}\n\n\t\t\twindow.addEventListener( 'touchmove', onTouchMove, { passive: false } );\n\t\t\twindow.addEventListener( 'touchend', onTouchEnd );\n\n\t\t};\n\n\t\tconst onTouchMove = e => {\n\n\t\t\tif ( testingForScroll ) {\n\n\t\t\t\tconst dx = e.touches[ 0 ].clientX - prevClientX;\n\t\t\t\tconst dy = e.touches[ 0 ].clientY - prevClientY;\n\n\t\t\t\tif ( Math.abs( dx ) > Math.abs( dy ) ) {\n\n\t\t\t\t\t// We moved horizontally, set the value and stop checking.\n\t\t\t\t\tbeginTouchDrag( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// This was, in fact, an attempt to scroll. Abort.\n\t\t\t\t\twindow.removeEventListener( 'touchmove', onTouchMove );\n\t\t\t\t\twindow.removeEventListener( 'touchend', onTouchEnd );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\te.preventDefault();\n\t\t\t\tsetValueFromX( e.touches[ 0 ].clientX );\n\n\t\t\t}\n\n\t\t};\n\n\t\tconst onTouchEnd = () => {\n\t\t\tthis._callOnFinishChange();\n\t\t\tthis._setDraggingStyle( false );\n\t\t\twindow.removeEventListener( 'touchmove', onTouchMove );\n\t\t\twindow.removeEventListener( 'touchend', onTouchEnd );\n\t\t};\n\n\t\t// Mouse wheel\n\t\t// ---------------------------------------------------------------------\n\n\t\t// We have to use a debounced function to call onFinishChange because\n\t\t// there's no way to tell when the user is \"done\" mouse-wheeling.\n\t\tconst callOnFinishChange = this._callOnFinishChange.bind( this );\n\t\tconst WHEEL_DEBOUNCE_TIME = 400;\n\t\tlet wheelFinishChangeTimeout;\n\n\t\tconst onWheel = e => {\n\n\t\t\t// ignore vertical wheels if there's a scrollbar\n\t\t\tconst isVertical = Math.abs( e.deltaX ) < Math.abs( e.deltaY );\n\t\t\tif ( isVertical && this._hasScrollBar ) return;\n\n\t\t\te.preventDefault();\n\n\t\t\t// set value\n\t\t\tconst delta = this._normalizeMouseWheel( e ) * this._step;\n\t\t\tthis._snapClampSetValue( this.getValue() + delta );\n\n\t\t\t// force the input to updateDisplay when it's focused\n\t\t\tthis.$input.value = this.getValue();\n\n\t\t\t// debounce onFinishChange\n\t\t\tclearTimeout( wheelFinishChangeTimeout );\n\t\t\twheelFinishChangeTimeout = setTimeout( callOnFinishChange, WHEEL_DEBOUNCE_TIME );\n\n\t\t};\n\n\t\tthis.$slider.addEventListener( 'mousedown', mouseDown );\n\t\tthis.$slider.addEventListener( 'touchstart', onTouchStart, { passive: false } );\n\t\tthis.$slider.addEventListener( 'wheel', onWheel, { passive: false } );\n\n\t}\n\n\t_setDraggingStyle( active, axis = 'horizontal' ) {\n\t\tif ( this.$slider ) {\n\t\t\tthis.$slider.classList.toggle( 'active', active );\n\t\t}\n\t\tdocument.body.classList.toggle( 'lil-gui-dragging', active );\n\t\tdocument.body.classList.toggle( `lil-gui-${axis}`, active );\n\t}\n\n\t_getImplicitStep() {\n\n\t\tif ( this._hasMin && this._hasMax ) {\n\t\t\treturn ( this._max - this._min ) / 1000;\n\t\t}\n\n\t\treturn 0.1;\n\n\t}\n\n\t_onUpdateMinMax() {\n\n\t\tif ( !this._hasSlider && this._hasMin && this._hasMax ) {\n\n\t\t\t// If this is the first time we're hearing about min and max\n\t\t\t// and we haven't explicitly stated what our step is, let's\n\t\t\t// update that too.\n\t\t\tif ( !this._stepExplicit ) {\n\t\t\t\tthis.step( this._getImplicitStep(), false );\n\t\t\t}\n\n\t\t\tthis._initSlider();\n\t\t\tthis.updateDisplay();\n\n\t\t}\n\n\t}\n\n\t_normalizeMouseWheel( e ) {\n\n\t\tlet { deltaX, deltaY } = e;\n\n\t\t// Safari and Chrome report weird non-integral values for a notched wheel,\n\t\t// but still expose actual lines scrolled via wheelDelta. Notched wheels\n\t\t// should behave the same way as arrow keys.\n\t\tif ( Math.floor( e.deltaY ) !== e.deltaY && e.wheelDelta ) {\n\t\t\tdeltaX = 0;\n\t\t\tdeltaY = -e.wheelDelta / 120;\n\t\t\tdeltaY *= this._stepExplicit ? 1 : 10;\n\t\t}\n\n\t\tconst wheel = deltaX + -deltaY;\n\n\t\treturn wheel;\n\n\t}\n\n\t_arrowKeyMultiplier( e ) {\n\n\t\tlet mult = this._stepExplicit ? 1 : 10;\n\n\t\tif ( e.shiftKey ) {\n\t\t\tmult *= 10;\n\t\t} else if ( e.altKey ) {\n\t\t\tmult /= 10;\n\t\t}\n\n\t\treturn mult;\n\n\t}\n\n\t_snap( value ) {\n\n\t\t// This would be the logical way to do things, but floating point errors.\n\t\t// return Math.round( value / this._step ) * this._step;\n\n\t\t// Using inverse step solves a lot of them, but not all\n\t\t// const inverseStep = 1 / this._step;\n\t\t// return Math.round( value * inverseStep ) / inverseStep;\n\n\t\t// Not happy about this, but haven't seen it break.\n\t\tconst r = Math.round( value / this._step ) * this._step;\n\t\treturn parseFloat( r.toPrecision( 15 ) );\n\n\t}\n\n\t_clamp( value ) {\n\t\t// either condition is false if min or max is undefined\n\t\tif ( value < this._min ) value = this._min;\n\t\tif ( value > this._max ) value = this._max;\n\t\treturn value;\n\t}\n\n\t_snapClampSetValue( value ) {\n\t\tthis.setValue( this._clamp( this._snap( value ) ) );\n\t}\n\n\tget _hasScrollBar() {\n\t\tconst root = this.parent.root.$children;\n\t\treturn root.scrollHeight > root.clientHeight;\n\t}\n\n\tget _hasMin() {\n\t\treturn this._min !== undefined;\n\t}\n\n\tget _hasMax() {\n\t\treturn this._max !== undefined;\n\t}\n\n}\n\nclass OptionController extends Controller {\n\n\tconstructor( parent, object, property, options ) {\n\n\t\tsuper( parent, object, property, 'option' );\n\n\t\tthis.$select = document.createElement( 'select' );\n\t\tthis.$select.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$display = document.createElement( 'div' );\n\t\tthis.$display.classList.add( 'display' );\n\n\t\tthis._values = Array.isArray( options ) ? options : Object.values( options );\n\t\tthis._names = Array.isArray( options ) ? options : Object.keys( options );\n\n\t\tthis._names.forEach( name => {\n\t\t\tconst $option = document.createElement( 'option' );\n\t\t\t$option.innerHTML = name;\n\t\t\tthis.$select.appendChild( $option );\n\t\t} );\n\n\t\tthis.$select.addEventListener( 'change', () => {\n\t\t\tthis.setValue( this._values[ this.$select.selectedIndex ] );\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$select.addEventListener( 'focus', () => {\n\t\t\tthis.$display.classList.add( 'focus' );\n\t\t} );\n\n\t\tthis.$select.addEventListener( 'blur', () => {\n\t\t\tthis.$display.classList.remove( 'focus' );\n\t\t} );\n\n\t\tthis.$widget.appendChild( this.$select );\n\t\tthis.$widget.appendChild( this.$display );\n\n\t\tthis.$disable = this.$select;\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tupdateDisplay() {\n\t\tconst value = this.getValue();\n\t\tconst index = this._values.indexOf( value );\n\t\tthis.$select.selectedIndex = index;\n\t\tthis.$display.innerHTML = index === -1 ? value : this._names[ index ];\n\t\treturn this;\n\t}\n\n}\n\nclass StringController extends Controller {\n\n\tconstructor( parent, object, property ) {\n\n\t\tsuper( parent, object, property, 'string' );\n\n\t\tthis.$input = document.createElement( 'input' );\n\t\tthis.$input.setAttribute( 'type', 'text' );\n\t\tthis.$input.setAttribute( 'aria-labelledby', this.$name.id );\n\n\t\tthis.$input.addEventListener( 'input', () => {\n\t\t\tthis.setValue( this.$input.value );\n\t\t} );\n\n\t\tthis.$input.addEventListener( 'keydown', e => {\n\t\t\tif ( e.code === 'Enter' ) {\n\t\t\t\tthis.$input.blur();\n\t\t\t}\n\t\t} );\n\n\t\tthis.$input.addEventListener( 'blur', () => {\n\t\t\tthis._callOnFinishChange();\n\t\t} );\n\n\t\tthis.$widget.appendChild( this.$input );\n\n\t\tthis.$disable = this.$input;\n\n\t\tthis.updateDisplay();\n\n\t}\n\n\tupdateDisplay() {\n\t\tthis.$input.value = this.getValue();\n\t\treturn this;\n\t}\n\n}\n\nconst stylesheet = `.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  background-color: var(--background-color);\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, \"Droid Sans Mono\", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean .widget {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: \" \";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: \"lil-gui\";\n  content: \"↕\";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background-color: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background-color: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background-color: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: \"lil-gui\";\n  content: \"▾\";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: \"▸\";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: \"Empty\";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui input {\n  -webkit-tap-highlight-color: transparent;\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input::-webkit-outer-spin-button,\n.lil-gui input::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n.lil-gui input[type=number] {\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  -webkit-appearance: none;\n  height: var(--checkbox-size);\n  width: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: \"lil-gui\";\n  content: \"✓\";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: 1px solid var(--widget-color);\n  text-align: center;\n  line-height: calc(var(--widget-height) - 4px);\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n    border-color: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    border-color: var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: \"lil-gui\";\n  src: url(\"data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==\") format(\"woff\");\n}`;\n\nfunction _injectStyles( cssContent ) {\n\tconst injected = document.createElement( 'style' );\n\tinjected.innerHTML = cssContent;\n\tconst before = document.querySelector( 'head link[rel=stylesheet], head style' );\n\tif ( before ) {\n\t\tdocument.head.insertBefore( injected, before );\n\t} else {\n\t\tdocument.head.appendChild( injected );\n\t}\n}\n\nlet stylesInjected = false;\n\nclass GUI {\n\n\t/**\n\t * Creates a panel that holds controllers.\n\t * @example\n\t * new GUI();\n\t * new GUI( { container: document.getElementById( 'custom' ) } );\n\t *\n\t * @param {object} [options]\n\t * @param {boolean} [options.autoPlace=true]\n\t * Adds the GUI to `document.body` and fixes it to the top right of the page.\n\t *\n\t * @param {HTMLElement} [options.container]\n\t * Adds the GUI to this DOM element. Overrides `autoPlace`.\n\t *\n\t * @param {number} [options.width=245]\n\t * Width of the GUI in pixels, usually set when name labels become too long. Note that you can make\n\t * name labels wider in CSS with `.lil‑gui { ‑‑name‑width: 55% }`\n\t *\n\t * @param {string} [options.title=Controls]\n\t * Name to display in the title bar.\n\t *\n\t * @param {boolean} [options.injectStyles=true]\n\t * Injects the default stylesheet into the page if this is the first GUI.\n\t * Pass `false` to use your own stylesheet.\n\t *\n\t * @param {number} [options.touchStyles=true]\n\t * Makes controllers larger on touch devices. Pass `false` to disable touch styles.\n\t *\n\t * @param {GUI} [options.parent]\n\t * Adds this GUI as a child in another GUI. Usually this is done for you by `addFolder()`.\n\t *\n\t */\n\tconstructor( {\n\t\tparent,\n\t\tautoPlace = parent === undefined,\n\t\tcontainer,\n\t\twidth,\n\t\ttitle = 'Controls',\n\t\tinjectStyles = true,\n\t\ttouchStyles = true\n\t} = {} ) {\n\n\t\t/**\n\t\t * The GUI containing this folder, or `undefined` if this is the root GUI.\n\t\t * @type {GUI}\n\t\t */\n\t\tthis.parent = parent;\n\n\t\t/**\n\t\t * The top level GUI containing this folder, or `this` if this is the root GUI.\n\t\t * @type {GUI}\n\t\t */\n\t\tthis.root = parent ? parent.root : this;\n\n\t\t/**\n\t\t * The list of controllers and folders contained by this GUI.\n\t\t * @type {Array<GUI|Controller>}\n\t\t */\n\t\tthis.children = [];\n\n\t\t/**\n\t\t * The list of controllers contained by this GUI.\n\t\t * @type {Array<Controller>}\n\t\t */\n\t\tthis.controllers = [];\n\n\t\t/**\n\t\t * The list of folders contained by this GUI.\n\t\t * @type {Array<GUI>}\n\t\t */\n\t\tthis.folders = [];\n\n\t\t/**\n\t\t * Used to determine if the GUI is closed. Use `gui.open()` or `gui.close()` to change this.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._closed = false;\n\n\t\t/**\n\t\t * Used to determine if the GUI is hidden. Use `gui.show()` or `gui.hide()` to change this.\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._hidden = false;\n\n\t\t/**\n\t\t * The outermost container element.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.domElement = document.createElement( 'div' );\n\t\tthis.domElement.classList.add( 'lil-gui' );\n\n\t\t/**\n\t\t * The DOM element that contains the title.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$title = document.createElement( 'div' );\n\t\tthis.$title.classList.add( 'title' );\n\t\tthis.$title.setAttribute( 'role', 'button' );\n\t\tthis.$title.setAttribute( 'aria-expanded', true );\n\t\tthis.$title.setAttribute( 'tabindex', 0 );\n\n\t\tthis.$title.addEventListener( 'click', () => this.openAnimated( this._closed ) );\n\t\tthis.$title.addEventListener( 'keydown', e => {\n\t\t\tif ( e.code === 'Enter' || e.code === 'Space' ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.$title.click();\n\t\t\t}\n\t\t} );\n\n\t\t// enables :active pseudo class on mobile\n\t\tthis.$title.addEventListener( 'touchstart', () => {}, { passive: true } );\n\n\t\t/**\n\t\t * The DOM element that contains children.\n\t\t * @type {HTMLElement}\n\t\t */\n\t\tthis.$children = document.createElement( 'div' );\n\t\tthis.$children.classList.add( 'children' );\n\n\t\tthis.domElement.appendChild( this.$title );\n\t\tthis.domElement.appendChild( this.$children );\n\n\t\tthis.title( title );\n\n\t\tif ( touchStyles ) {\n\t\t\tthis.domElement.classList.add( 'allow-touch-styles' );\n\t\t}\n\n\t\tif ( this.parent ) {\n\n\t\t\tthis.parent.children.push( this );\n\t\t\tthis.parent.folders.push( this );\n\n\t\t\tthis.parent.$children.appendChild( this.domElement );\n\n\t\t\t// Stop the constructor early, everything onward only applies to root GUI's\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.domElement.classList.add( 'root' );\n\n\t\t// Inject stylesheet if we haven't done that yet\n\t\tif ( !stylesInjected && injectStyles ) {\n\t\t\t_injectStyles( stylesheet );\n\t\t\tstylesInjected = true;\n\t\t}\n\n\t\tif ( container ) {\n\n\t\t\tcontainer.appendChild( this.domElement );\n\n\t\t} else if ( autoPlace ) {\n\n\t\t\tthis.domElement.classList.add( 'autoPlace' );\n\t\t\tdocument.body.appendChild( this.domElement );\n\n\t\t}\n\n\t\tif ( width ) {\n\t\t\tthis.domElement.style.setProperty( '--width', width + 'px' );\n\t\t}\n\n\t\t// Don't fire global key events while typing in the GUI:\n\t\tthis.domElement.addEventListener( 'keydown', e => e.stopPropagation() );\n\t\tthis.domElement.addEventListener( 'keyup', e => e.stopPropagation() );\n\n\t}\n\n\t/**\n\t * Adds a controller to the GUI, inferring controller type using the `typeof` operator.\n\t * @example\n\t * gui.add( object, 'property' );\n\t * gui.add( object, 'number', 0, 100, 1 );\n\t * gui.add( object, 'options', [ 1, 2, 3 ] );\n\t *\n\t * @param {object} object The object the controller will modify.\n\t * @param {string} property Name of the property to control.\n\t * @param {number|object|Array} [$1] Minimum value for number controllers, or the set of\n\t * selectable values for a dropdown.\n\t * @param {number} [max] Maximum value for number controllers.\n\t * @param {number} [step] Step value for number controllers.\n\t * @returns {Controller}\n\t */\n\tadd( object, property, $1, max, step ) {\n\n\t\tif ( Object( $1 ) === $1 ) {\n\n\t\t\treturn new OptionController( this, object, property, $1 );\n\n\t\t}\n\n\t\tconst initialValue = object[ property ];\n\n\t\tswitch ( typeof initialValue ) {\n\n\t\t\tcase 'number':\n\n\t\t\t\treturn new NumberController( this, object, property, $1, max, step );\n\n\t\t\tcase 'boolean':\n\n\t\t\t\treturn new BooleanController( this, object, property );\n\n\t\t\tcase 'string':\n\n\t\t\t\treturn new StringController( this, object, property );\n\n\t\t\tcase 'function':\n\n\t\t\t\treturn new FunctionController( this, object, property );\n\n\t\t}\n\n\t\tconsole.error( `gui.add failed\n\tproperty:`, property, `\n\tobject:`, object, `\n\tvalue:`, initialValue );\n\n\t}\n\n\t/**\n\t * Adds a color controller to the GUI.\n\t * @example\n\t * params = {\n\t * \tcssColor: '#ff00ff',\n\t * \trgbColor: { r: 0, g: 0.2, b: 0.4 },\n\t * \tcustomRange: [ 0, 127, 255 ],\n\t * };\n\t *\n\t * gui.addColor( params, 'cssColor' );\n\t * gui.addColor( params, 'rgbColor' );\n\t * gui.addColor( params, 'customRange', 255 );\n\t *\n\t * @param {object} object The object the controller will modify.\n\t * @param {string} property Name of the property to control.\n\t * @param {number} rgbScale Maximum value for a color channel when using an RGB color. You may\n\t * need to set this to 255 if your colors are too bright.\n\t * @returns {Controller}\n\t */\n\taddColor( object, property, rgbScale = 1 ) {\n\t\treturn new ColorController( this, object, property, rgbScale );\n\t}\n\n\t/**\n\t * Adds a folder to the GUI, which is just another GUI. This method returns\n\t * the nested GUI so you can add controllers to it.\n\t * @example\n\t * const folder = gui.addFolder( 'Position' );\n\t * folder.add( position, 'x' );\n\t * folder.add( position, 'y' );\n\t * folder.add( position, 'z' );\n\t *\n\t * @param {string} title Name to display in the folder's title bar.\n\t * @returns {GUI}\n\t */\n\taddFolder( title ) {\n\t\treturn new GUI( { parent: this, title } );\n\t}\n\n\t/**\n\t * Recalls values that were saved with `gui.save()`.\n\t * @param {object} obj\n\t * @param {boolean} recursive Pass false to exclude folders descending from this GUI.\n\t * @returns {this}\n\t */\n\tload( obj, recursive = true ) {\n\n\t\tif ( obj.controllers ) {\n\n\t\t\tthis.controllers.forEach( c => {\n\n\t\t\t\tif ( c instanceof FunctionController ) return;\n\n\t\t\t\tif ( c._name in obj.controllers ) {\n\t\t\t\t\tc.load( obj.controllers[ c._name ] );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( recursive && obj.folders ) {\n\n\t\t\tthis.folders.forEach( f => {\n\n\t\t\t\tif ( f._title in obj.folders ) {\n\t\t\t\t\tf.load( obj.folders[ f._title ] );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Returns an object mapping controller names to values. The object can be passed to `gui.load()` to\n\t * recall these values.\n\t * @example\n\t * {\n\t * \tcontrollers: {\n\t * \t\tprop1: 1,\n\t * \t\tprop2: 'value',\n\t * \t\t...\n\t * \t},\n\t * \tfolders: {\n\t * \t\tfolderName1: { controllers, folders },\n\t * \t\tfolderName2: { controllers, folders }\n\t * \t\t...\n\t * \t}\n\t * }\n\t *\n\t * @param {boolean} recursive Pass false to exclude folders descending from this GUI.\n\t * @returns {object}\n\t */\n\tsave( recursive = true ) {\n\n\t\tconst obj = {\n\t\t\tcontrollers: {},\n\t\t\tfolders: {}\n\t\t};\n\n\t\tthis.controllers.forEach( c => {\n\n\t\t\tif ( c instanceof FunctionController ) return;\n\n\t\t\tif ( c._name in obj.controllers ) {\n\t\t\t\tthrow new Error( `Cannot save GUI with duplicate property \"${c._name}\"` );\n\t\t\t}\n\n\t\t\tobj.controllers[ c._name ] = c.save();\n\n\t\t} );\n\n\t\tif ( recursive ) {\n\n\t\t\tthis.folders.forEach( f => {\n\n\t\t\t\tif ( f._title in obj.folders ) {\n\t\t\t\t\tthrow new Error( `Cannot save GUI with duplicate folder \"${f._title}\"` );\n\t\t\t\t}\n\n\t\t\t\tobj.folders[ f._title ] = f.save();\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn obj;\n\n\t}\n\n\t/**\n\t * Opens a GUI or folder. GUI and folders are open by default.\n\t * @param {boolean} open Pass false to close\n\t * @returns {this}\n\t * @example\n\t * gui.open(); // open\n\t * gui.open( false ); // close\n\t * gui.open( gui._closed ); // toggle\n\t */\n\topen( open = true ) {\n\n\t\tthis._closed = !open;\n\n\t\tthis.$title.setAttribute( 'aria-expanded', !this._closed );\n\t\tthis.domElement.classList.toggle( 'closed', this._closed );\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Closes the GUI.\n\t * @returns {this}\n\t */\n\tclose() {\n\t\treturn this.open( false );\n\t}\n\n\t/**\n\t * Shows the GUI after it's been hidden.\n\t * @param {boolean} show\n\t * @returns {this}\n\t * @example\n\t * gui.show();\n\t * gui.show( false ); // hide\n\t * gui.show( gui._hidden ); // toggle\n\t */\n\tshow( show = true ) {\n\n\t\tthis._hidden = !show;\n\n\t\tthis.domElement.style.display = this._hidden ? 'none' : '';\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Hides the GUI.\n\t * @returns {this}\n\t */\n\thide() {\n\t\treturn this.show( false );\n\t}\n\n\topenAnimated( open = true ) {\n\n\t\t// set state immediately\n\t\tthis._closed = !open;\n\n\t\tthis.$title.setAttribute( 'aria-expanded', !this._closed );\n\n\t\t// wait for next frame to measure $children\n\t\trequestAnimationFrame( () => {\n\n\t\t\t// explicitly set initial height for transition\n\t\t\tconst initialHeight = this.$children.clientHeight;\n\t\t\tthis.$children.style.height = initialHeight + 'px';\n\n\t\t\tthis.domElement.classList.add( 'transition' );\n\n\t\t\tconst onTransitionEnd = e => {\n\t\t\t\tif ( e.target !== this.$children ) return;\n\t\t\t\tthis.$children.style.height = '';\n\t\t\t\tthis.domElement.classList.remove( 'transition' );\n\t\t\t\tthis.$children.removeEventListener( 'transitionend', onTransitionEnd );\n\t\t\t};\n\n\t\t\tthis.$children.addEventListener( 'transitionend', onTransitionEnd );\n\n\t\t\t// todo: this is wrong if children's scrollHeight makes for a gui taller than maxHeight\n\t\t\tconst targetHeight = !open ? 0 : this.$children.scrollHeight;\n\n\t\t\tthis.domElement.classList.toggle( 'closed', !open );\n\n\t\t\trequestAnimationFrame( () => {\n\t\t\t\tthis.$children.style.height = targetHeight + 'px';\n\t\t\t} );\n\n\t\t} );\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Change the title of this GUI.\n\t * @param {string} title\n\t * @returns {this}\n\t */\n\ttitle( title ) {\n\t\t/**\n\t\t * Current title of the GUI. Use `gui.title( 'Title' )` to modify this value.\n\t\t * @type {string}\n\t\t */\n\t\tthis._title = title;\n\t\tthis.$title.innerHTML = title;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Resets all controllers to their initial values.\n\t * @param {boolean} recursive Pass false to exclude folders descending from this GUI.\n\t * @returns {this}\n\t */\n\treset( recursive = true ) {\n\t\tconst controllers = recursive ? this.controllersRecursive() : this.controllers;\n\t\tcontrollers.forEach( c => c.reset() );\n\t\treturn this;\n\t}\n\n\t/**\n\t * Pass a function to be called whenever a controller in this GUI changes.\n\t * @param {function({object:object, property:string, value:any, controller:Controller})} callback\n\t * @returns {this}\n\t * @example\n\t * gui.onChange( event => {\n\t * \tevent.object     // object that was modified\n\t * \tevent.property   // string, name of property\n\t * \tevent.value      // new value of controller\n\t * \tevent.controller // controller that was modified\n\t * } );\n\t */\n\tonChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onChange` events. Don't modify this value\n\t\t * directly. Use the `gui.onChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onChange = callback;\n\t\treturn this;\n\t}\n\n\t_callOnChange( controller ) {\n\n\t\tif ( this.parent ) {\n\t\t\tthis.parent._callOnChange( controller );\n\t\t}\n\n\t\tif ( this._onChange !== undefined ) {\n\t\t\tthis._onChange.call( this, {\n\t\t\t\tobject: controller.object,\n\t\t\t\tproperty: controller.property,\n\t\t\t\tvalue: controller.getValue(),\n\t\t\t\tcontroller\n\t\t\t} );\n\t\t}\n\t}\n\n\t/**\n\t * Pass a function to be called whenever a controller in this GUI has finished changing.\n\t * @param {function({object:object, property:string, value:any, controller:Controller})} callback\n\t * @returns {this}\n\t * @example\n\t * gui.onFinishChange( event => {\n\t * \tevent.object     // object that was modified\n\t * \tevent.property   // string, name of property\n\t * \tevent.value      // new value of controller\n\t * \tevent.controller // controller that was modified\n\t * } );\n\t */\n\tonFinishChange( callback ) {\n\t\t/**\n\t\t * Used to access the function bound to `onFinishChange` events. Don't modify this value\n\t\t * directly. Use the `gui.onFinishChange( callback )` method instead.\n\t\t * @type {Function}\n\t\t */\n\t\tthis._onFinishChange = callback;\n\t\treturn this;\n\t}\n\n\t_callOnFinishChange( controller ) {\n\n\t\tif ( this.parent ) {\n\t\t\tthis.parent._callOnFinishChange( controller );\n\t\t}\n\n\t\tif ( this._onFinishChange !== undefined ) {\n\t\t\tthis._onFinishChange.call( this, {\n\t\t\t\tobject: controller.object,\n\t\t\t\tproperty: controller.property,\n\t\t\t\tvalue: controller.getValue(),\n\t\t\t\tcontroller\n\t\t\t} );\n\t\t}\n\t}\n\n\t/**\n\t * Destroys all DOM elements and event listeners associated with this GUI\n\t */\n\tdestroy() {\n\n\t\tif ( this.parent ) {\n\t\t\tthis.parent.children.splice( this.parent.children.indexOf( this ), 1 );\n\t\t\tthis.parent.folders.splice( this.parent.folders.indexOf( this ), 1 );\n\t\t}\n\n\t\tif ( this.domElement.parentElement ) {\n\t\t\tthis.domElement.parentElement.removeChild( this.domElement );\n\t\t}\n\n\t\tArray.from( this.children ).forEach( c => c.destroy() );\n\n\t}\n\n\t/**\n\t * Returns an array of controllers contained by this GUI and its descendents.\n\t * @returns {Controller[]}\n\t */\n\tcontrollersRecursive() {\n\t\tlet controllers = Array.from( this.controllers );\n\t\tthis.folders.forEach( f => {\n\t\t\tcontrollers = controllers.concat( f.controllersRecursive() );\n\t\t} );\n\t\treturn controllers;\n\t}\n\n\t/**\n\t * Returns an array of folders contained by this GUI and its descendents.\n\t * @returns {GUI[]}\n\t */\n\tfoldersRecursive() {\n\t\tlet folders = Array.from( this.folders );\n\t\tthis.folders.forEach( f => {\n\t\t\tfolders = folders.concat( f.foldersRecursive() );\n\t\t} );\n\t\treturn folders;\n\t}\n\n}\n\nexport default GUI;\nexport { BooleanController, ColorController, Controller, FunctionController, GUI, NumberController, OptionController, StringController };\n","<template lang=\"pug\">\r\n.time-slider-component(v-if=\"hasNonZeroTimeRange\" :id=\"`id-${id}`\")\r\n  .label-area\r\n    p.p1 {{ state.labels[0] }}\r\n    p.p2(v-show=\"state.labels[1] !== undefined\") &nbsp;-&nbsp;{{ state.labels[1] }}\r\n\r\n  .slider-area\r\n    button.button.play-button(size=\"is-small\" type=\"is-link\"\r\n      @click=\"$emit('toggleAnimation')\"\r\n      ) {{ isAnimating ? '|&nbsp;|' : '>' }}\r\n\r\n    .time-slider-dragger(ref=\"slider\" @mousemove=\"dragging\")\r\n      .active-region(:style=\"calculateActiveMargins\"\r\n        @mousedown=\"dragStart\" @mouseup.stop=\"dragEnd\" @mousemove.stop=\"dragging\"\r\n      )\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport type { PropType } from 'vue'\r\n\r\nconst GRAB_HANDLE_WIDTH = 6\r\n\r\nenum DRAGTYPE {\r\n  SLIDE,\r\n  START,\r\n  END,\r\n}\r\n\r\nexport default defineComponent({\r\n  name: 'TimeSlider',\r\n  props: {\r\n    labels: Array as PropType<string[]>,\r\n    range: Array as PropType<number[]>,\r\n    activeTimeExtent: Array as PropType<number[]>,\r\n    isAnimating: Boolean,\r\n  },\r\n  data: () => {\r\n    return {\r\n      state: {\r\n        componentWidth: 0,\r\n        dragStartX: 0,\r\n        dragType: DRAGTYPE.SLIDE,\r\n        isDragging: false,\r\n        isSetupComplete: false,\r\n        // always 0.0-1.0 :\r\n        leftPosition: 0,\r\n        rightPosition: 1,\r\n        // the datasetRange is the extent of the time values in the dataset, e.g. 0-86400\r\n        datasetRange: [0, 86400],\r\n        labels: ['', ''],\r\n      },\r\n      id: 'id-' + Math.floor(1e12 * Math.random()),\r\n      resizer: null as ResizeObserver | null,\r\n    }\r\n  },\r\n  computed: {\r\n    fullDatasetTimeSpan(): number {\r\n      return this.state.datasetRange[1] - this.state.datasetRange[0]\r\n    },\r\n\r\n    extentLeftToRight(): number {\r\n      return this.state.rightPosition - this.state.leftPosition\r\n    },\r\n\r\n    hasNonZeroTimeRange(): boolean {\r\n      // return false if the start and finish of the range are identical\r\n      return !!this.fullDatasetTimeSpan\r\n    },\r\n    calculateActiveMargins(): any {\r\n      const usableWidth = this.state.componentWidth - 2 * GRAB_HANDLE_WIDTH\r\n      const marginLeft = Math.floor(usableWidth * this.state.leftPosition)\r\n      const marginRight = Math.floor(usableWidth * (1.0 - this.state.rightPosition))\r\n\r\n      // console.log({ usableWidth, marginLeft, marginRight })\r\n\r\n      return {\r\n        marginLeft: `${marginLeft}px`,\r\n        marginRight: `${marginRight}px`,\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getDimensions()\r\n    this.setupInitialValues()\r\n    this.setupResizer()\r\n\r\n    window.addEventListener('mouseup', this.dragEnd)\r\n    window.addEventListener('mousemove', this.dragging)\r\n  },\r\n\r\n  beforeDestroy() {\r\n    window.removeEventListener('mouseup', this.dragEnd)\r\n    window.removeEventListener('mousemove', this.dragging)\r\n  },\r\n  watch: {\r\n    activeTimeExtent() {\r\n      this.updateExtent()\r\n    },\r\n    labels() {\r\n      this.updateLabels()\r\n    },\r\n    'state.leftPosition'() {\r\n      this.emitValues()\r\n    },\r\n    'state.rightPosition'() {\r\n      this.emitValues()\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    setupResizer() {\r\n      try {\r\n        this.resizer = new ResizeObserver(this.getDimensions)\r\n        const sliderElement = document.getElementById(`id-${this.id}`) as HTMLElement\r\n        this.resizer.observe(sliderElement)\r\n      } catch (e) {\r\n        console.error('' + e)\r\n      }\r\n    },\r\n\r\n    setupInitialValues() {\r\n      try {\r\n        if (this.range) this.state.datasetRange = this.range\r\n\r\n        if (this.fullDatasetTimeSpan === 0) {\r\n          this.state.leftPosition = 0\r\n          this.state.rightPosition = 1\r\n        } else {\r\n          this.updateExtent()\r\n        }\r\n      } catch (e) {\r\n        console.error('' + e)\r\n        // divide by zero, oh well\r\n      } finally {\r\n        this.state.isSetupComplete = true\r\n      }\r\n    },\r\n\r\n    updateExtent() {\r\n      if (!this.activeTimeExtent) return\r\n\r\n      this.state.leftPosition =\r\n        (this.activeTimeExtent[0] - this.state.datasetRange[0]) / this.fullDatasetTimeSpan\r\n      this.state.rightPosition =\r\n        (this.activeTimeExtent[1] - this.state.datasetRange[0]) / this.fullDatasetTimeSpan\r\n    },\r\n\r\n    updateLabels() {\r\n      if (this.labels) this.state.labels = this.labels\r\n    },\r\n\r\n    emitValues() {\r\n      if (!this.state.isSetupComplete) return\r\n\r\n      const start = this.state.datasetRange[0] + this.state.leftPosition * this.fullDatasetTimeSpan\r\n      const end = this.state.datasetRange[0] + this.state.rightPosition * this.fullDatasetTimeSpan\r\n      this.$emit('timeExtent', [start, end])\r\n    },\r\n\r\n    getDimensions() {\r\n      //@ts-ignore - ref doesn't know about clientWidth\r\n      this.state.componentWidth = this.$refs.slider?.clientWidth || 0\r\n    },\r\n\r\n    dragStart(e: MouseEvent) {\r\n      this.$emit('drag')\r\n      this.state.isDragging = true\r\n      this.state.dragStartX = e.clientX\r\n\r\n      const usableWidth = this.state.componentWidth - 2 * GRAB_HANDLE_WIDTH\r\n      const marginLeft = Math.floor(usableWidth * this.state.leftPosition)\r\n      const marginRight = Math.floor(usableWidth * (1.0 - this.state.rightPosition))\r\n\r\n      const durationWidth =\r\n        this.state.componentWidth - marginRight - marginLeft - 2 * GRAB_HANDLE_WIDTH\r\n\r\n      // console.log({ usableWidth, durationWidth, marginLeft, marginRight })\r\n\r\n      if (e.offsetX >= 0 && e.offsetX < durationWidth) this.state.dragType = DRAGTYPE.SLIDE\r\n      else if (e.offsetX < 0) this.state.dragType = DRAGTYPE.START\r\n      else if (e.offsetX > durationWidth) this.state.dragType = DRAGTYPE.END\r\n    },\r\n\r\n    dragging(e: MouseEvent) {\r\n      if (!this.state.isDragging) return\r\n\r\n      const deltaX = e.clientX - this.state.dragStartX\r\n      const usableWidth = this.state.componentWidth - 2 * GRAB_HANDLE_WIDTH\r\n\r\n      // are we moving the time duration window\r\n      if (DRAGTYPE.SLIDE == this.state.dragType) {\r\n        const currentExtent = this.extentLeftToRight\r\n        let newLeft = (usableWidth * this.state.leftPosition + deltaX) / usableWidth\r\n        let newRight = newLeft + currentExtent\r\n\r\n        // don't scroll past the left edge\r\n        if (newLeft < 0) {\r\n          newLeft = 0\r\n          newRight = currentExtent\r\n        }\r\n\r\n        // don't scroll past the right edge\r\n        if (newRight > 1) {\r\n          newRight = 1\r\n          newLeft = newRight - currentExtent\r\n        }\r\n\r\n        this.state.leftPosition = newLeft\r\n        this.state.rightPosition = newRight\r\n\r\n        this.state.dragStartX = e.clientX\r\n        return\r\n      }\r\n\r\n      // are we moving the start-time\r\n      if (DRAGTYPE.START == this.state.dragType) {\r\n        const newLeft = usableWidth * this.state.leftPosition + deltaX\r\n        this.state.leftPosition = Math.max(0, newLeft / usableWidth)\r\n        if (this.state.leftPosition > this.state.rightPosition) {\r\n          this.state.rightPosition = this.state.leftPosition\r\n        }\r\n        this.state.dragStartX = e.clientX\r\n        return\r\n      }\r\n\r\n      // are we moving the end-time\r\n      if (DRAGTYPE.END == this.state.dragType) {\r\n        const newRight = usableWidth * this.state.rightPosition + deltaX\r\n        this.state.rightPosition = Math.min(1, newRight / usableWidth)\r\n        if (this.state.leftPosition > this.state.rightPosition) {\r\n          this.state.leftPosition = this.state.rightPosition\r\n        }\r\n        this.state.dragStartX = e.clientX\r\n        return\r\n      }\r\n    },\r\n\r\n    dragEnd(e: any) {\r\n      this.state.isDragging = false\r\n    },\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.time-slider-component {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.slider-area {\r\n  background-color: var(--bgPanel);\r\n  padding: 1rem 1rem;\r\n  display: flex;\r\n  flex-direction: row;\r\n}\r\n\r\n.time-slider-dragger {\r\n  user-select: none;\r\n  height: 1.5rem;\r\n  background-color: #66669933;\r\n  border-radius: 4px;\r\n  max-width: 100%;\r\n  flex: 1;\r\n  overflow: hidden;\r\n}\r\n\r\n.active-region {\r\n  cursor: ew-resize;\r\n  color: white;\r\n  background-color: var(--sliderThumb);\r\n  height: 100%;\r\n  border-radius: 4px;\r\n  border-left: 6px solid var(--linkHover);\r\n  border-right: 6px solid var(--linkHover);\r\n  font-size: 1rem;\r\n  line-height: 0.6rem;\r\n}\r\n\r\n.label-area {\r\n  margin: 0 0;\r\n  font-size: 1.3rem;\r\n  font-weight: bold;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin-right: auto;\r\n}\r\n\r\n.p1 {\r\n  padding: 0 0;\r\n  padding-left: 1rem;\r\n  background-color: var(--bgPanel);\r\n}\r\n\r\n.p2 {\r\n  padding: 0 0;\r\n  padding-right: 1rem;\r\n  background-color: var(--bgPanel);\r\n}\r\n\r\n.play-button {\r\n  width: 2.4rem;\r\n  height: 1.5rem;\r\n  margin-right: 1rem;\r\n  font-weight: bold;\r\n  font-size: 0.8rem;\r\n  line-height: 0.8rem;\r\n  padding: 0 0;\r\n}\r\n</style>\r\n","\r\n.time-slider-component(v-if=\"hasNonZeroTimeRange\" :id=\"`id-${id}`\")\r\n  .label-area\r\n    p.p1 {{ state.labels[0] }}\r\n    p.p2(v-show=\"state.labels[1] !== undefined\") &nbsp;-&nbsp;{{ state.labels[1] }}\r\n\r\n  .slider-area\r\n    button.button.play-button(size=\"is-small\" type=\"is-link\"\r\n      @click=\"$emit('toggleAnimation')\"\r\n      ) {{ isAnimating ? '|&nbsp;|' : '>' }}\r\n\r\n    .time-slider-dragger(ref=\"slider\" @mousemove=\"dragging\")\r\n      .active-region(:style=\"calculateActiveMargins\"\r\n        @mousedown=\"dragStart\" @mouseup.stop=\"dragEnd\" @mousemove.stop=\"dragging\"\r\n      )\r\n\r\n","import React, { useState, useMemo, useEffect } from 'react'\r\nimport DeckGL from '@deck.gl/react'\r\nimport { StaticMap } from 'react-map-gl'\r\nimport { ScatterplotLayer } from '@deck.gl/layers'\r\nimport { DataFilterExtension } from '@deck.gl/extensions'\r\nimport * as timeConvert from 'convert-seconds'\r\n\r\nimport { REACT_VIEW_HANDLES, MAPBOX_TOKEN } from '@/Globals'\r\nimport ScatterplotColorBinsLayer from '@/plugins/xy-time/ScatterplotColorBinsLayer'\r\nimport MovingIconsLayer from '@/layers/moving-icons/moving-icons-vehicles-layer'\r\nimport globalStore from '@/store'\r\nimport { NetworkLinks } from '@/js/DashboardDataManager'\r\n\r\nconst BASE_URL = import.meta.env.BASE_URL\r\n\r\nconst ICON_MAPPING = {\r\n  marker: { x: 0, y: 0, width: 128, height: 128, mask: true },\r\n  info: { x: 128, y: 0, width: 128, height: 128, mask: true },\r\n  vehicle: { x: 128, y: 128, width: 128, height: 128, mask: true },\r\n  diamond: { x: 0, y: 128, width: 128, height: 128, mask: false },\r\n}\r\n\r\nconst dataFilter = new DataFilterExtension({ filterSize: 1 })\r\n\r\nfunction convertSecondsToClockTimeMinutes(index: number) {\r\n  const seconds = index\r\n\r\n  try {\r\n    const hms = timeConvert(seconds)\r\n    const minutes = ('00' + hms.minutes).slice(-2)\r\n    return `${hms.hours}:${minutes}`\r\n  } catch (e) {\r\n    return '00:00'\r\n  }\r\n}\r\n\r\nconst INITIAL_VIEW = {\r\n  pitch: 0,\r\n  zoom: 8,\r\n  bearing: 0,\r\n  longitude: 14,\r\n  latitude: 52.0,\r\n  // longitude: 14.38,\r\n  // latitude: 51.7,\r\n}\r\n\r\n// -------------------------------------------------------------------\r\nexport default function Component({\r\n  viewId = 0,\r\n  eventLayers = [] as any[],\r\n  network = {} as NetworkLinks,\r\n  linkIdLookup = {} as any,\r\n  timeFilter = [] as number[],\r\n  dark = false,\r\n  colors = [\r\n    [1, 0, 0],\r\n    [0.25, 0.25, 1],\r\n  ] as number[][],\r\n  breakpoints = [0.0] as number[],\r\n  radius = 5,\r\n  mapIsIndependent = false,\r\n  simulationTime = 20000,\r\n}) {\r\n  // manage SimWrapper centralized viewState - for linked maps\r\n  const [viewState, setViewState] = useState(INITIAL_VIEW)\r\n\r\n  REACT_VIEW_HANDLES[viewId] = () => {\r\n    setViewState(globalStore.state.viewState)\r\n  }\r\n\r\n  function handleViewState(view: any) {\r\n    if (!view.latitude) return\r\n\r\n    if (!view.center) view.center = [0, 0]\r\n    view.center[0] = view.longitude\r\n    view.center[1] = view.latitude\r\n    setViewState(view)\r\n\r\n    if (!mapIsIndependent) globalStore.commit('setMapCamera', view)\r\n  }\r\n\r\n  function getTooltip(element: any) {\r\n    // console.log(element)\r\n    if (element.index < 0) return null\r\n\r\n    return 'hi'\r\n\r\n    // const layerId = element?.layer?.id\r\n    // if (layerId === undefined) return null\r\n\r\n    // const time = pointLayers[layerId].time[element.index]\r\n    // const humanTime = convertSecondsToClockTimeMinutes(time)\r\n\r\n    // const value = pointLayers[layerId].value[element.index]\r\n    // const cleanValue = Math.round(1e6 * value) / 1e6\r\n    // return {\r\n    //   html: `\\\r\n    //     <table style=\"font-size: 0.9rem\">\r\n    //     <tr>\r\n    //       <td>Value</td>\r\n    //       <td style=\"padding-left: 0.5rem;\"><b>${cleanValue}</b></td>\r\n    //     </tr><tr>\r\n    //       <td style=\"text-align: right;\">Time</td>\r\n    //       <td style=\"padding-left: 0.5rem;\"><b>${humanTime}</b></td>\r\n    //     </tr>\r\n    //     </table>\r\n    //   `,\r\n    //   style: dark\r\n    //     ? { color: '#ccc', backgroundColor: '#2a3c4f' }\r\n    //     : { color: '#223', backgroundColor: 'white' },\r\n    // }\r\n  }\r\n\r\n  // add a scatterplotlayer for each set of points in eventLayers\r\n  const pointLayers = eventLayers.map((layer, layerIndex) => {\r\n    // The entire layer can be hidden if all of its points\r\n    // are beyond the timeFilter range that is being shown.\r\n    const outOfRange =\r\n      layer.times[0] > timeFilter[1] || layer.times[layer.times.length - 1] < timeFilter[0]\r\n\r\n    return new ScatterplotLayer({\r\n      data: {\r\n        length: layer.times.length,\r\n        attributes: {\r\n          getFilterValue: { value: layer.times, size: 1 },\r\n          getPosition: { value: layer.positions, size: 2 },\r\n        },\r\n      },\r\n      autoHighlight: true,\r\n      breakpoints: breakpoints,\r\n      colors: colors,\r\n      extensions: [dataFilter],\r\n      id: 'hello' + layerIndex,\r\n      filled: true,\r\n      filterRange: timeFilter.length ? timeFilter : null,\r\n      getRadius: 20,\r\n      getFillColor: [240, 128, 10],\r\n      highlightColor: [255, 0, 224],\r\n      opacity: 1,\r\n      parameters: { depthTest: false },\r\n      pickable: true,\r\n      radiusScale: 1,\r\n      stroked: false,\r\n      updateTriggers: {\r\n        getPosition: eventLayers,\r\n        //   // getFillColor: pointLayers,\r\n        getFilterValue: timeFilter,\r\n      },\r\n      // transitions: {\r\n      //   getFillColor: 500,\r\n      //   getColor: 500,\r\n      //   getValue: 500,\r\n      //   getFilterValue: 500,\r\n      // },\r\n      // hide layers that are entirely outside the time window filter:\r\n      visible: !outOfRange,\r\n    })\r\n  })\r\n\r\n  // add the vehicle motion layer in each eventLayer\r\n  const vehicleLayers = eventLayers.map((layer, layerIndex) => {\r\n    // The entire layer can be hidden if all of its points\r\n    // are beyond the timeFilter range that is being shown.\r\n    const outOfRange =\r\n      layer.vehicles.t0[0] > timeFilter[1] ||\r\n      layer.vehicles.t1[layer.vehicles.t1.length - 1] < timeFilter[0]\r\n\r\n    // console.log(outOfRange)\r\n    //@ts-ignore\r\n    return new MovingIconsLayer({\r\n      data: {\r\n        length: layer.vehicles.t0.length,\r\n        attributes: {\r\n          getTimeStart: { value: layer.vehicles.t0, size: 1 },\r\n          getTimeEnd: { value: layer.vehicles.t1, size: 1 },\r\n          getPathStart: { value: layer.vehicles.locO, size: 2 },\r\n          getPathEnd: { value: layer.vehicles.locD, size: 2 },\r\n        },\r\n      },\r\n      id: 'vehicles' + layerIndex,\r\n      // getIcon: (d: any) => 'vehicle',\r\n      getColor: [64, 96, 255], // (d: any) => props.colors[d.occ],\r\n      iconMoving: 'vehicle',\r\n      iconStill: 'diamond',\r\n      getSize: 20, // searchEnabled ? 56 : 44,\r\n      opacity: 1.0,\r\n      currentTime: simulationTime,\r\n      shadowEnabled: true,\r\n      iconAtlas: BASE_URL + '/images/icon-atlas.png',\r\n      iconMapping: ICON_MAPPING,\r\n      sizeScale: 1,\r\n      billboard: false,\r\n      pickable: true,\r\n      depthTest: true,\r\n      autoHighlight: false,\r\n      highlightColor: [255, 0, 255],\r\n      // onHover: setHoverInfo,\r\n      parameters: {\r\n        depthTest: false,\r\n      },\r\n      visible: !outOfRange,\r\n    })\r\n  })\r\n\r\n  const allLayers = [...pointLayers, ...vehicleLayers]\r\n\r\n  // initialViewState={initialViewState}\r\n  return (\r\n    <DeckGL\r\n      layers={allLayers}\r\n      controller={true}\r\n      useDevicePixels={true}\r\n      viewState={viewState}\r\n      onViewStateChange={(e: any) => handleViewState(e.viewState)}\r\n      pickingRadius={4}\r\n      onClick={getTooltip}\r\n      getTooltip={getTooltip}\r\n    >\r\n      {\r\n        /*\r\n        // @ts-ignore */\r\n        <StaticMap\r\n          mapStyle={globalStore.getters.mapStyle}\r\n          preventStyleDiffing={true}\r\n          mapboxApiAccessToken={MAPBOX_TOKEN}\r\n        />\r\n      }\r\n    </DeckGL>\r\n  )\r\n}\r\n","<template lang=\"pug\">\r\n.viz-plugin(oncontextmenu=\"return false\" :id=\"`id-${viewId}`\")\r\n\r\n  event-map.map-layer(v-if=\"!thumbnail && isLoaded\"\r\n    :viewId=\"viewId\"\r\n    :eventLayers=\"eventLayers\"\r\n    :network=\"network\"\r\n    :linkIdLookup=\"linkIdLookup\"\r\n    :timeFilter=\"timeFilter\"\r\n    :dark=\"this.$store.state.isDarkMode\"\r\n    :colors=\"this.colors\"\r\n    :breakpoints=\"this.breakpoints\"\r\n    :radius=\"this.guiConfig.radius\"\r\n    :mapIsIndependent=\"false\"\r\n    :simulationTime=\"timeFilter[1]\"\r\n  )\r\n\r\n  zoom-buttons(v-if=\"!thumbnail\" corner=\"bottom\")\r\n\r\n  .top-right\r\n    .gui-config(:id=\"configId\")\r\n\r\n  .bottom-right\r\n    .legend-area(v-if=\"legendStore\")\r\n      legend-box(:legendStore=\"legendStore\")\r\n\r\n  time-slider.time-slider-area(v-if=\"isLoaded\"\r\n    :range=\"timeRange\"\r\n    :activeTimeExtent=\"timeFilter\"\r\n    :labels=\"timeLabels\"\r\n    :isAnimating=\"isAnimating\"\r\n    @timeExtent=\"handleTimeSliderValues\"\r\n    @toggleAnimation=\"toggleAnimation\"\r\n    @drag=\"isAnimating=false\"\r\n  )\r\n\r\n  .message(v-if=\"!thumbnail && myState.statusMessage\")\r\n    p.status-message {{ myState.statusMessage }}\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      loading: 'Loading data...',\r\n      sorting: 'Sorting into bins...',\r\n      aggregate: 'Summary',\r\n      maxHeight: '3D Height',\r\n      showDetails: 'Show Details',\r\n      selection: 'Selection',\r\n      areas: 'Areas',\r\n      count: 'Count',\r\n      promptCRS: `Enter the coordinate reference system, e.g. EPSG:25832\\n\\nThese coordinates are not in long/lat format. To fix this permanently, convert them to long/lat or add \"# EPSG:xxxx\" to your CSV header`,\r\n    },\r\n    de: {\r\n      loading: 'Dateien laden...',\r\n      sorting: 'Sortieren...',\r\n      aggregate: 'Daten',\r\n      maxHeight: '3-D Höhe',\r\n      showDetails: 'Details anzeigen',\r\n      selection: 'Ausgewählt',\r\n      areas: 'Orte',\r\n      count: 'Anzahl',\r\n    },\r\n  },\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\nimport type { PropType } from 'vue'\r\n\r\nimport GUI from 'lil-gui'\r\nimport YAML from 'yaml'\r\nimport colormap from 'colormap'\r\n\r\nimport util from '@/js/util'\r\nimport globalStore from '@/store'\r\nimport CollapsiblePanel from '@/components/CollapsiblePanel.vue'\r\nimport DrawingTool from '@/components/DrawingTool/DrawingTool.vue'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\nimport LegendBox from '@/components/viz-configurator/LegendBox.vue'\r\nimport LegendStore from '@/js/LegendStore'\r\nimport TimeSlider from '@/components/TimeSlider.vue'\r\nimport EventMap from './EventDeckMap'\r\nimport ZoomButtons from '@/components/ZoomButtons.vue'\r\n\r\nimport MATSimEventStreamer from '@/workers/MATSimEventStreamer.worker.ts?worker'\r\n\r\nimport {\r\n  ColorScheme,\r\n  FileSystem,\r\n  LegendItem,\r\n  LegendItemType,\r\n  FileSystemConfig,\r\n  VisualizationPlugin,\r\n  Status,\r\n  REACT_VIEW_HANDLES,\r\n} from '@/Globals'\r\nimport DashboardDataManager, { NetworkLinks } from '@/js/DashboardDataManager'\r\n\r\ninterface VizDetail {\r\n  title: string\r\n  description?: string\r\n  file: string\r\n  projection: any\r\n  thumbnail?: string\r\n  center: any\r\n  zoom: number\r\n}\r\n\r\ninterface PointLayer {\r\n  color: Uint8Array\r\n  value: Float32Array\r\n  coordinates: Float32Array\r\n  time: Float32Array\r\n  timeRange: number[]\r\n}\r\n\r\nconst MyComponent = defineComponent({\r\n  name: 'EventViewerPlugin',\r\n  i18n,\r\n  components: {\r\n    CollapsiblePanel,\r\n    DrawingTool,\r\n    EventMap,\r\n    LegendBox,\r\n    TimeSlider,\r\n    ZoomButtons,\r\n  },\r\n  props: {\r\n    root: { type: String, required: true },\r\n    subfolder: { type: String, required: true },\r\n    yamlConfig: String,\r\n    config: Object as any,\r\n    thumbnail: Boolean,\r\n    datamanager: { type: Object as PropType<DashboardDataManager> },\r\n  },\r\n  data: () => {\r\n    const colorRamps = ['bathymetry', 'electric', 'inferno', 'jet', 'magma', 'par', 'viridis']\r\n\r\n    return {\r\n      myDataManager: null as DashboardDataManager | null,\r\n      network: {\r\n        source: new Float32Array(),\r\n        dest: new Float32Array(),\r\n        linkIds: [],\r\n      } as NetworkLinks,\r\n      linkIdLookup: {} as any,\r\n      guiConfig: {\r\n        buckets: 7,\r\n        exponent: 4,\r\n        radius: 5,\r\n        'clip max': 100,\r\n        'color ramp': 'viridis',\r\n        flip: false,\r\n        colorRamps: colorRamps,\r\n      },\r\n      viewId: ('xyt-id-' + Math.floor(1e12 * Math.random())) as any,\r\n      configId: ('gui-config-' + Math.floor(1e12 * Math.random())) as any,\r\n      timeLabels: [0, 1] as any[],\r\n      startTime: 0,\r\n      isAnimating: false,\r\n      timeFilter: [0, 3599],\r\n      colors: [\r\n        [128, 128, 128],\r\n        [128, 128, 128],\r\n      ] as number[][],\r\n      breakpoints: [0],\r\n      range: [Infinity, -Infinity],\r\n      timeRange: [Infinity, -Infinity],\r\n      legendStore: null as LegendStore | null,\r\n      standaloneYAMLconfig: {\r\n        title: '',\r\n        description: '',\r\n        file: '',\r\n        projection: '',\r\n        thumbnail: '',\r\n        radius: 250,\r\n        maxHeight: 0,\r\n        center: null as any,\r\n        zoom: 9,\r\n      } as any,\r\n      YAMLrequirementsXY: { file: '' },\r\n      columnLookup: [] as number[],\r\n      gzipWorker: null as Worker | null,\r\n      vizDetails: {\r\n        title: '',\r\n        description: '',\r\n        file: '',\r\n        projection: '',\r\n        thumbnail: '',\r\n        center: null as any,\r\n        zoom: 9,\r\n      } as VizDetail,\r\n      myState: {\r\n        statusMessage: '',\r\n        subfolder: '',\r\n        yamlConfig: '',\r\n        thumbnail: false,\r\n      },\r\n      eventLayers: [] as any[],\r\n      isLoaded: false,\r\n      animator: null as any,\r\n      guiController: null as GUI | null,\r\n      resizer: null as ResizeObserver | null,\r\n      thumbnailUrl: \"url('assets/thumbnail.jpg') no-repeat;\",\r\n      ANIMATE_SPEED: 0.25,\r\n      animationElapsedTime: 0,\r\n      animationClockTime: 0,\r\n    }\r\n  },\r\n  computed: {\r\n    fileApi(): HTTPFileSystem {\r\n      return new HTTPFileSystem(this.fileSystem, globalStore)\r\n    },\r\n\r\n    fileSystem(): FileSystemConfig {\r\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === this.root\r\n      )\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n      return svnProject[0]\r\n    },\r\n    urlThumbnail(): any {\r\n      return this.thumbnailUrl\r\n    },\r\n  },\r\n  watch: {\r\n    '$store.state.viewState'() {\r\n      if (REACT_VIEW_HANDLES[this.viewId]) REACT_VIEW_HANDLES[this.viewId]()\r\n    },\r\n  },\r\n  methods: {\r\n    handleTimeSliderValues(timeValues: any[]) {\r\n      this.animationElapsedTime = timeValues[0]\r\n      this.timeFilter = timeValues\r\n      this.timeLabels = [\r\n        this.convertSecondsToClockTimeMinutes(timeValues[0]),\r\n        this.convertSecondsToClockTimeMinutes(timeValues[1]),\r\n      ]\r\n    },\r\n\r\n    setupLogoMover() {\r\n      this.resizer = new ResizeObserver(this.moveLogo)\r\n      const deckmap = document.getElementById(`id-${this.viewId}`) as HTMLElement\r\n      this.resizer.observe(deckmap)\r\n    },\r\n\r\n    moveLogo() {\r\n      const deckmap = document.getElementById(`${this.viewId}`) as HTMLElement\r\n      const logo = deckmap?.querySelector('.mapboxgl-ctrl-bottom-left') as HTMLElement\r\n      if (logo) {\r\n        const right = deckmap.clientWidth > 640 ? '280px' : '36px'\r\n        logo.style.right = right\r\n      }\r\n    },\r\n\r\n    setupGui() {\r\n      this.guiController = new GUI({\r\n        title: 'Color Settings',\r\n        injectStyles: true,\r\n        width: 200,\r\n        container: document.getElementById(this.configId) || undefined,\r\n      })\r\n\r\n      const colors = this.guiController // .addFolder('Colors')\r\n      colors.add(this.guiConfig, 'buckets', 2, 19, 1).onChange(this.setColors)\r\n      colors.add(this.guiConfig, 'exponent', 1, 10, 1).onChange(this.setColors)\r\n      colors.add(this.guiConfig, 'clip max', 0, 100, 1).onChange(this.setColors)\r\n      colors.add(this.guiConfig, 'radius', 1, 20, 1)\r\n      colors.add(this.guiConfig, 'color ramp', this.guiConfig.colorRamps).onChange(this.setColors)\r\n      colors.add(this.guiConfig, 'flip').onChange(this.setColors)\r\n\r\n      // const times = this.guiController.addFolder('Time')\r\n    },\r\n\r\n    async solveProjection() {\r\n      if (this.thumbnail) return\r\n\r\n      console.log('WHAT PROJECTION:')\r\n\r\n      try {\r\n        const text = await this.fileApi.getFileText(\r\n          this.myState.subfolder + '/' + this.myState.yamlConfig\r\n        )\r\n        this.vizDetails = YAML.parse(text)\r\n      } catch (e) {\r\n        console.error(e)\r\n      }\r\n    },\r\n\r\n    async getVizDetails() {\r\n      if (this.config) {\r\n        this.validateYAML()\r\n        this.vizDetails = Object.assign({}, this.config)\r\n        return\r\n      }\r\n\r\n      const hasYaml = new RegExp('.*(yml|yaml)$').test(this.myState.yamlConfig)\r\n\r\n      if (hasYaml) {\r\n        await this.loadStandaloneYAMLConfig()\r\n      } else {\r\n        // console.log('NO YAML WTF')\r\n        this.setConfigForRawCSV()\r\n      }\r\n    },\r\n\r\n    setConfigForRawCSV() {\r\n      let projection = 'EPSG:4326' // Include \"# EPSG:xxx\" in header of CSV to set EPSG\r\n\r\n      // output_trips:\r\n      this.vizDetails = {\r\n        title: 'EVENTS: ' + this.myState.yamlConfig,\r\n        description: this.myState.yamlConfig,\r\n        file: this.myState.yamlConfig,\r\n        projection,\r\n        center: this.vizDetails.center,\r\n        zoom: this.vizDetails.zoom,\r\n      }\r\n      this.$emit('title', this.vizDetails.title || this.vizDetails.file)\r\n      return\r\n    },\r\n\r\n    async loadStandaloneYAMLConfig() {\r\n      if (!this.fileApi) return\r\n      try {\r\n        // might be a project config:\r\n        const filename =\r\n          this.myState.yamlConfig.indexOf('/') > -1\r\n            ? this.myState.yamlConfig\r\n            : this.myState.subfolder + '/' + this.myState.yamlConfig\r\n\r\n        const text = await this.fileApi.getFileText(filename)\r\n        this.standaloneYAMLconfig = Object.assign({}, YAML.parse(text))\r\n        this.validateYAML()\r\n        this.setVizDetails()\r\n      } catch (err) {\r\n        const e = err as any\r\n        console.log('failed')\r\n\r\n        this.$store.commit('setStatus', {\r\n          type: Status.ERROR,\r\n          msg: `File not found`,\r\n          desc: `Could not find: ${this.myState.subfolder}/${this.myState.yamlConfig}`,\r\n        })\r\n      }\r\n    },\r\n\r\n    validateYAML() {\r\n      const hasYaml = new RegExp('.*(yml|yaml)$').test(this.myState.yamlConfig)\r\n      let configuration\r\n\r\n      if (hasYaml) {\r\n        console.log('has yaml')\r\n        configuration = this.standaloneYAMLconfig\r\n      } else {\r\n        console.log('no yaml')\r\n        configuration = this.config\r\n      }\r\n\r\n      for (const key in this.YAMLrequirementsXY) {\r\n        if (key in configuration === false) {\r\n          this.$store.commit('setStatus', {\r\n            type: Status.ERROR,\r\n            msg: `YAML file missing required key: ${key}`,\r\n            desc: 'Check this.YAMLrequirementsXY for required keys',\r\n          })\r\n        }\r\n      }\r\n\r\n      if (configuration.radius == 0) {\r\n        this.$store.commit('setStatus', {\r\n          type: Status.WARNING,\r\n          msg: `Radius set to zero`,\r\n          desc: 'Radius can not be zero, preset value used instead. ',\r\n        })\r\n      }\r\n\r\n      if (configuration.zoom < 5 || configuration.zoom > 20) {\r\n        this.$store.commit('setStatus', {\r\n          type: Status.WARNING,\r\n          msg: `Zoom is out of the recommended range `,\r\n          desc: 'Zoom levels should be between 5 and 20. ',\r\n        })\r\n      }\r\n    },\r\n\r\n    setVizDetails() {\r\n      this.vizDetails = Object.assign({}, this.vizDetails, this.standaloneYAMLconfig)\r\n\r\n      const t = this.vizDetails.title ? this.vizDetails.title : 'EVENTS: ' + this.vizDetails.file\r\n      this.$emit('title', t)\r\n    },\r\n    async buildThumbnail() {\r\n      if (this.thumbnail && this.vizDetails.thumbnail) {\r\n        try {\r\n          const blob = await this.fileApi.getFileBlob(\r\n            this.myState.subfolder + '/' + this.vizDetails.thumbnail\r\n          )\r\n          const buffer = await blob.arrayBuffer()\r\n          const base64 = util.arrayBufferToBase64(buffer)\r\n          if (base64)\r\n            this.thumbnailUrl = `center / cover no-repeat url(data:image/png;base64,${base64})`\r\n        } catch (e) {\r\n          console.error(e)\r\n        }\r\n      }\r\n    },\r\n\r\n    async streamEventFile(filename: string) {\r\n      this.myState.statusMessage = 'Loading file...'\r\n      let totalRows = 0\r\n      this.range = [Infinity, -Infinity]\r\n      this.timeRange = [Infinity, -Infinity]\r\n      this.animationElapsedTime = 0\r\n      this.timeFilter = [0, 59]\r\n\r\n      // get the raw unzipped arraybuffer\r\n      if (this.gzipWorker) this.gzipWorker.terminate()\r\n      this.eventLayers = []\r\n      this.gzipWorker = new MATSimEventStreamer()\r\n\r\n      const formatter = Intl.NumberFormat()\r\n\r\n      this.gzipWorker.onmessage = async (event: MessageEvent) => {\r\n        const message = event.data\r\n        if (message.status) {\r\n          this.myState.statusMessage = message.status\r\n        } else if (message.error) {\r\n          this.myState.statusMessage = message.error\r\n          this.$store.commit('setStatus', {\r\n            type: Status.ERROR,\r\n            msg: `XYT Loading Error`,\r\n            desc: `Error loading: ${this.myState.subfolder}/${this.vizDetails.file}`,\r\n          })\r\n        } else if (message.finished) {\r\n          this.finishedLoadingData(totalRows, message)\r\n        } else {\r\n          const events = message.events as any[]\r\n\r\n          console.log(events.length)\r\n\r\n          totalRows += events.length\r\n          this.myState.statusMessage = 'Loading ' + formatter.format(totalRows) + ' events'\r\n\r\n          // minmax all events\r\n          this.timeRange = [\r\n            Math.min(this.timeRange[0], events[0].time),\r\n            Math.max(this.timeRange[1], events[events.length - 1].time),\r\n          ]\r\n\r\n          // minmax vehicle trips specifically\r\n          this.timeRange = [\r\n            Math.min(this.timeRange[0], message.vehicleTrips[0].t0),\r\n            Math.max(this.timeRange[1], message.vehicleTrips[message.vehicleTrips.length - 1].t1),\r\n          ]\r\n\r\n          // .filter(row => row.link)\r\n          const linkEvents = events.map(row => {\r\n            return {\r\n              time: row.time,\r\n              link: row.link,\r\n            } as any\r\n          })\r\n\r\n          // POSITIONS ----\r\n          const positions = new Float32Array(2 * linkEvents.length).fill(NaN)\r\n          for (let i = 0; i < linkEvents.length; i++) {\r\n            const offset = 2 * this.linkIdLookup[linkEvents[i].link]\r\n            positions[i * 2] = this.network.source[offset]\r\n            positions[i * 2 + 1] = this.network.source[offset + 1]\r\n          }\r\n\r\n          // VEHICLES -----------\r\n          const numTrips = message.vehicleTrips.length\r\n          const tripData = {\r\n            locO: new Float32Array(2 * numTrips).fill(NaN),\r\n            locD: new Float32Array(2 * numTrips).fill(NaN),\r\n            t0: new Float32Array(numTrips).fill(NaN),\r\n            t1: new Float32Array(numTrips).fill(NaN),\r\n          }\r\n\r\n          for (let i = 0; i < numTrips; i++) {\r\n            const trip = message.vehicleTrips[i]\r\n            const offset = 2 * this.linkIdLookup[trip.link]\r\n            tripData.locO[i * 2 + 0] = this.network.source[0 + offset]\r\n            tripData.locO[i * 2 + 1] = this.network.source[1 + offset]\r\n            tripData.locD[i * 2 + 0] = this.network.dest[0 + offset]\r\n            tripData.locD[i * 2 + 1] = this.network.dest[1 + offset]\r\n            // enter/leave traffic happen in the middle of the link\r\n            if (i == 0) {\r\n              tripData.locO[i * 2 + 0] = 0.5 * (tripData.locO[i * 2 + 0] + tripData.locD[i * 2 + 0])\r\n              tripData.locO[i * 2 + 1] = 0.5 * (tripData.locO[i * 2 + 1] + tripData.locD[i * 2 + 1])\r\n            } else if (i == numTrips - 1) {\r\n              tripData.locD[i * 2 + 0] = 0.5 * (tripData.locO[i * 2 + 0] + tripData.locD[i * 2 + 0])\r\n              tripData.locD[i * 2 + 1] = 0.5 * (tripData.locO[i * 2 + 1] + tripData.locD[i * 2 + 1])\r\n            }\r\n            tripData.t0[i] = trip.t0\r\n            tripData.t1[i] = trip.t1\r\n          }\r\n\r\n          // ALL DONE --------\r\n\r\n          this.eventLayers.push({\r\n            events: events.slice(1, 2), // linkEvents.slice(1, 2),\r\n            positions,\r\n            vehicles: tripData,\r\n            times: message.times,\r\n          })\r\n\r\n          // zoom map on first load\r\n          // if (!totalRows) this.setFirstZoom(message.coordinates, rows)\r\n          // // save layer data\r\n          // totalRows += rows\r\n        }\r\n      }\r\n\r\n      this.gzipWorker.postMessage({\r\n        filePath: filename,\r\n        fileSystem: this.fileSystem,\r\n        projection: this.vizDetails.projection,\r\n      })\r\n    },\r\n\r\n    setFirstZoom(coordinates: any[], rows: number) {\r\n      const longitude = 0.5 * (coordinates[0] + coordinates[rows * 2 - 2])\r\n      const latitude = 0.5 * (coordinates[1] + coordinates[rows * 2 - 1])\r\n\r\n      if (Number.isFinite(longitude) && Number.isFinite(latitude)) {\r\n        globalStore.commit(\r\n          'setMapCamera',\r\n          Object.assign({}, globalStore.state.viewState, { longitude, latitude, zoom: 10 })\r\n        )\r\n      }\r\n    },\r\n\r\n    finishedLoadingData(totalRows: number, data: any) {\r\n      this.isLoaded = true\r\n      this.range = data.range\r\n      this.myState.statusMessage = ''\r\n      this.timeFilter = [this.timeRange[0], this.timeRange[0] + 59]\r\n\r\n      if (this.gzipWorker) this.gzipWorker.terminate()\r\n\r\n      this.setColors()\r\n      this.moveLogo()\r\n      // this.eventLayers = [...this.eventLayers]\r\n\r\n      console.log('ALL DONE', {\r\n        totalRows,\r\n        data: data.range,\r\n        time: this.timeRange,\r\n        layers: this.eventLayers.length,\r\n      })\r\n    },\r\n\r\n    toggleAnimation() {\r\n      this.isAnimating = !this.isAnimating\r\n      if (this.isAnimating) {\r\n        this.animationElapsedTime = this.timeFilter[0] - this.timeRange[0]\r\n        this.startTime = Date.now() - this.animationElapsedTime / this.ANIMATE_SPEED\r\n        this.animate()\r\n      }\r\n    },\r\n\r\n    setColors() {\r\n      const EXPONENT = this.guiConfig.exponent // powerFunction // 4 // log-e? not steep enough\r\n\r\n      let colors256 = colormap({\r\n        colormap: this.guiConfig['color ramp'],\r\n        nshades: 256,\r\n        format: 'rba',\r\n        alpha: 1,\r\n      }).map((c: number[]) => [c[0], c[1], c[2]])\r\n\r\n      if (this.guiConfig.flip) colors256 = colors256.reverse()\r\n\r\n      const step = 256 / (this.guiConfig.buckets - 1)\r\n      const colors = []\r\n      for (let i = 0; i < this.guiConfig.buckets - 1; i++) {\r\n        colors.push(colors256[Math.round(step * i)])\r\n      }\r\n      colors.push(colors256[255])\r\n\r\n      // figure out min and max\r\n      const max1 = Math.pow(this.range[1], 1 / EXPONENT)\r\n      const max2 = (max1 * this.guiConfig['clip max']) / 100.0\r\n      // const clippedMin = (this.range[1] * this.clipData[0]) / 100.0\r\n\r\n      // console.log({ max1, max2 })\r\n\r\n      const breakpoints = [] as number[]\r\n      for (let i = 1; i < this.guiConfig.buckets; i++) {\r\n        const raw = (max2 * i) / this.guiConfig.buckets\r\n        const breakpoint = Math.pow(raw, EXPONENT)\r\n        breakpoints.push(breakpoint)\r\n      }\r\n\r\n      // only update legend if we have the full dataset already\r\n      if (this.isLoaded) this.setLegend(colors, breakpoints)\r\n\r\n      this.colors = colors\r\n      this.breakpoints = breakpoints\r\n    },\r\n\r\n    setLegend(colors: any[], breakpoints: number[]) {\r\n      // hide the legend if there is no data to show.\r\n      if (this.range[1] - this.range[0] === 0) return\r\n\r\n      this.legendStore = new LegendStore()\r\n      this.legendStore.setLegendSection({\r\n        section: 'Legend',\r\n        column: 'Legend',\r\n        values: colors.map((rgb, index) => {\r\n          const breakpoint = breakpoints[index == 0 ? index : index - 1]\r\n          let label = '' + Math.round(1e6 * breakpoint) / 1e6\r\n          if (index == 0) label = '< ' + label\r\n          if (index == colors.length - 1) label = '> ' + label\r\n          return { label, value: rgb }\r\n        }),\r\n      })\r\n    },\r\n\r\n    async loadNetwork() {\r\n      if (!this.myDataManager) throw Error('event viewer: no datamanager')\r\n\r\n      let networkFilename = this.vizDetails.file.replace('events.xml', 'network.xml')\r\n      const network = await this.myDataManager.getRoadNetwork(\r\n        networkFilename,\r\n        this.myState.subfolder,\r\n        Object.assign({ projection: '25833' }, this.vizDetails)\r\n      )\r\n\r\n      const linkIdLookup = {} as any\r\n      let i = 0\r\n      for (const link of network.linkIds) {\r\n        linkIdLookup[`${link}`] = i\r\n        i++\r\n      }\r\n\r\n      return { network, linkIdLookup }\r\n    },\r\n\r\n    async loadFiles() {\r\n      const { network, linkIdLookup } = await this.loadNetwork()\r\n      this.network = network\r\n      this.linkIdLookup = linkIdLookup\r\n\r\n      let dataArray: any = []\r\n      if (!this.fileApi) return { dataArray }\r\n\r\n      try {\r\n        let filename = `${this.myState.subfolder}/${this.vizDetails.file}`\r\n        await this.streamEventFile(filename)\r\n      } catch (e) {\r\n        console.error(e)\r\n        this.myState.statusMessage = '' + e\r\n        this.$store.commit('setStatus', {\r\n          type: Status.ERROR,\r\n          msg: `Loading/Parsing Error`,\r\n          desc: 'Error loading/parsing: ${this.myState.subfolder}/${this.vizDetails.file}',\r\n        })\r\n      }\r\n    },\r\n\r\n    animate() {\r\n      if (!this.isAnimating) return\r\n\r\n      this.animationElapsedTime = this.ANIMATE_SPEED * (Date.now() - this.startTime)\r\n\r\n      this.animationClockTime = this.animationElapsedTime + this.timeRange[0]\r\n\r\n      if (this.animationClockTime > this.timeRange[1]) {\r\n        this.startTime = Date.now()\r\n        this.animationElapsedTime = 0 // this.timeRange[0]\r\n      }\r\n\r\n      const span = this.timeFilter[1] - this.timeFilter[0]\r\n      this.timeFilter = [this.animationClockTime, this.animationClockTime + span]\r\n\r\n      this.animator = window.requestAnimationFrame(this.animate)\r\n    },\r\n\r\n    convertSecondsToClockTimeMinutes(index: number) {\r\n      const h = Math.floor(index / 3600)\r\n      const m = Math.floor((index - h * 3600) / 60)\r\n      const s = index - h * 3600 - m * 60\r\n\r\n      const hms = { h: `${h}`, m: `${m}`.padStart(2, '0'), s: `${s}`.padStart(2, '0') }\r\n\r\n      return `${hms.h}:${hms.m}`\r\n    },\r\n  },\r\n\r\n  async mounted() {\r\n    this.$store.commit('setFullScreen', !this.thumbnail)\r\n    this.myState.thumbnail = this.thumbnail\r\n    this.myState.yamlConfig = this.yamlConfig || ''\r\n    this.myState.subfolder = this.subfolder\r\n\r\n    // DataManager might be passed in from the dashboard; or we might be\r\n    // in single-view mode, in which case we need to create one for ourselves\r\n    this.myDataManager = this.datamanager || new DashboardDataManager(this.root, this.subfolder)\r\n\r\n    await this.getVizDetails()\r\n    await this.buildThumbnail()\r\n\r\n    if (this.thumbnail) return\r\n\r\n    this.setupLogoMover()\r\n\r\n    // ----------------------------------------------------\r\n    // this.setupGui()\r\n    this.myState.statusMessage = `${this.$i18n.t('loading')}`\r\n\r\n    if (!this.isLoaded) await this.loadFiles()\r\n  },\r\n\r\n  beforeDestroy() {\r\n    // MUST erase the React view handle to prevent gigantic memory leak!\r\n    REACT_VIEW_HANDLES[this.viewId] = undefined\r\n    delete REACT_VIEW_HANDLES[this.viewId]\r\n\r\n    try {\r\n      if (this.gzipWorker) {\r\n        this.gzipWorker.postMessage({ terminate: true })\r\n        this.gzipWorker.terminate()\r\n      }\r\n      if (this.guiController) this.guiController.destroy()\r\n    } catch (e) {\r\n      console.warn(e)\r\n    }\r\n\r\n    if (this.animator) window.cancelAnimationFrame(this.animator)\r\n\r\n    this.$store.commit('setFullScreen', false)\r\n  },\r\n})\r\n\r\n// !register plugin!\r\nglobalStore.commit('registerPlugin', {\r\n  kebabName: 'events',\r\n  prettyName: 'Event Viewer',\r\n  description: 'MATSim event viewer',\r\n  filePatterns: ['**/viz-events*.y?(a)ml', '**/*events.xml?(.gz)'],\r\n  component: MyComponent,\r\n} as VisualizationPlugin)\r\n\r\nexport default MyComponent\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.viz-plugin {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: $thumbnailHeight;\r\n  background: var(--bgMapPanel);\r\n}\r\n\r\n.message {\r\n  z-index: 5;\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin: auto auto 0 0;\r\n  background-color: var(--bgPanel);\r\n  padding: 0rem 0.5rem;\r\n  border-radius: 0;\r\n\r\n  a {\r\n    color: white;\r\n    text-decoration: none;\r\n\r\n    &.router-link-exact-active {\r\n      color: white;\r\n    }\r\n  }\r\n\r\n  p {\r\n    color: var(--textFancy);\r\n    font-size: 1.2rem;\r\n    font-weight: normal;\r\n    line-height: 1.75rem;\r\n    margin: auto 0.5rem auto 0;\r\n    padding: 0 0;\r\n  }\r\n}\r\n\r\n.map-layer {\r\n  pointer-events: auto;\r\n}\r\n\r\n.drawing-tool {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  pointer-events: none;\r\n}\r\n\r\n.bottom-right {\r\n  position: absolute;\r\n  bottom: 0;\r\n  right: 0;\r\n  margin: auto 7px 15rem auto;\r\n  box-shadow: 0px 0px 5px 3px rgba(128, 128, 128, 0.1);\r\n}\r\n\r\n.legend-area {\r\n  background-color: var(--bgPanel);\r\n  border: 1px solid var(--bgPanel2);\r\n}\r\n\r\n.time-slider-area {\r\n  position: absolute;\r\n  bottom: 2.5rem;\r\n  left: 0;\r\n  right: 0;\r\n  margin: 0 8rem 0 0.5rem;\r\n  filter: $filterShadow;\r\n}\r\n\r\n.buckets {\r\n  color: var(--text);\r\n  padding: 4px 4px 4px 4px;\r\n  display: flex;\r\n}\r\n\r\n.ramp-selector {\r\n  background-color: var(--bgBold);\r\n}\r\n\r\n.configurator {\r\n  user-select: none;\r\n  background-color: var(--bgPanel);\r\n  margin-top: 2rem;\r\n}\r\n\r\n.clip-slider {\r\n  margin: 0 0.5rem;\r\n}\r\n\r\n.top-right {\r\n  background-color: var(--bgPanel2);\r\n  color: white;\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  z-index: 5;\r\n  border-left: 1px solid #66669940;\r\n  border-bottom: 1px solid #66669940;\r\n  box-shadow: 0px 0px 5px 3px rgba(128, 128, 128, 0.1);\r\n}\r\n\r\n* > .number {\r\n  background-color: yellow;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n  .message {\r\n    padding: 0.5rem 0.5rem;\r\n  }\r\n}\r\n</style>\r\n","\r\n.viz-plugin(oncontextmenu=\"return false\" :id=\"`id-${viewId}`\")\r\n\r\n  event-map.map-layer(v-if=\"!thumbnail && isLoaded\"\r\n    :viewId=\"viewId\"\r\n    :eventLayers=\"eventLayers\"\r\n    :network=\"network\"\r\n    :linkIdLookup=\"linkIdLookup\"\r\n    :timeFilter=\"timeFilter\"\r\n    :dark=\"this.$store.state.isDarkMode\"\r\n    :colors=\"this.colors\"\r\n    :breakpoints=\"this.breakpoints\"\r\n    :radius=\"this.guiConfig.radius\"\r\n    :mapIsIndependent=\"false\"\r\n    :simulationTime=\"timeFilter[1]\"\r\n  )\r\n\r\n  zoom-buttons(v-if=\"!thumbnail\" corner=\"bottom\")\r\n\r\n  .top-right\r\n    .gui-config(:id=\"configId\")\r\n\r\n  .bottom-right\r\n    .legend-area(v-if=\"legendStore\")\r\n      legend-box(:legendStore=\"legendStore\")\r\n\r\n  time-slider.time-slider-area(v-if=\"isLoaded\"\r\n    :range=\"timeRange\"\r\n    :activeTimeExtent=\"timeFilter\"\r\n    :labels=\"timeLabels\"\r\n    :isAnimating=\"isAnimating\"\r\n    @timeExtent=\"handleTimeSliderValues\"\r\n    @toggleAnimation=\"toggleAnimation\"\r\n    @drag=\"isAnimating=false\"\r\n  )\r\n\r\n  .message(v-if=\"!thumbnail && myState.statusMessage\")\r\n    p.status-message {{ myState.statusMessage }}\r\n\r\n","<template lang=\"pug\">\r\n.settings-panel-content\r\n  h4 {{ $t('showhide')}}\r\n\r\n  .row(:key=\"label\" v-for=\"label in Object.keys(items)\")\r\n    toggle-button.toggle(\r\n      :width=\"40\"\r\n      :value=\"items[label]\"\r\n      :labels=\"false\"\r\n      :color=\"{checked: '#4b7cc4', unchecked: '#222'}\"\r\n      @change=\"$emit('click',label)\")\r\n    label(v-html=\"$t(label)\")\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      requests: 'DRT&nbsp;Requests',\r\n      passengers: 'Passengers',\r\n      search: 'Search',\r\n      showhide: 'Show/Hide',\r\n      vehicles: 'DRT Vehicles',\r\n      routes: 'Routes',\r\n      speed: 'Speed',\r\n      backgroundTraffic: 'All Traffic',\r\n    },\r\n    de: {\r\n      requests: 'DRT&nbsp;Anfragen',\r\n      passengers: 'Passagiere',\r\n      search: 'Suche',\r\n      showhide: 'Ein-/Ausblenden',\r\n      vehicles: 'DRT Fahrzeuge',\r\n      routes: 'Routen',\r\n      speed: 'Geschwindigkeit',\r\n      backgroundTraffic: 'Alle Fahrzeuge',\r\n    },\r\n  },\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\nimport { ToggleButton } from 'vue-js-toggle-button'\r\n\r\nexport default defineComponent({\r\n  name: 'XmasSettingsPanel',\r\n  i18n,\r\n  components: { ToggleButton },\r\n  props: {\r\n    items: { type: Object, required: true },\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.settings-panel-content {\r\n  margin: 2rem 0.25rem 0 0.25rem;\r\n}\r\n\r\nh4 {\r\n  font-weight: bold;\r\n  font-size: 0.8rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.row {\r\n  display: 'grid';\r\n  grid-template-columns: 'auto 1fr';\r\n}\r\n\r\nlabel {\r\n  margin: auto 0 auto 0rem;\r\n  text-align: 'left';\r\n}\r\n\r\n.toggle {\r\n  margin-bottom: 0.25rem;\r\n  margin-right: 0.5rem;\r\n}\r\n</style>\r\n","\r\n.settings-panel-content\r\n  h4 {{ $t('showhide')}}\r\n\r\n  .row(:key=\"label\" v-for=\"label in Object.keys(items)\")\r\n    toggle-button.toggle(\r\n      :width=\"40\"\r\n      :value=\"items[label]\"\r\n      :labels=\"false\"\r\n      :color=\"{checked: '#4b7cc4', unchecked: '#222'}\"\r\n      @change=\"$emit('click',label)\")\r\n    label(v-html=\"$t(label)\")\r\n\r\n","import { ArcLayer } from '@deck.gl/layers'\r\n\r\nconst defaultProps = {\r\n  currentTime: { type: 'number', value: 0, min: 0 },\r\n  getTimeStart: { type: 'accessor', value: null },\r\n  getTimeEnd: { type: 'accessor', value: null },\r\n  searchFlag: { type: 'number', value: 0 },\r\n}\r\n\r\nexport default class DrtRequestArcLayer extends ArcLayer {\r\n  getShaders() {\r\n    const shaders = super.getShaders()\r\n    shaders.inject = {\r\n      // Timestamp of the vertex\r\n      'vs:#decl': `\\\r\n        attribute float timeStart;\r\n        attribute float timeEnd;\r\n        uniform float currentTime;\r\n        uniform float searchFlag;\r\n        varying float vTime;\r\n      `,\r\n      'vs:#main-start': `\\\r\n        if (searchFlag == 1.0) {\r\n          vTime = 999.0;\r\n        } else if (timeEnd == -1.0 || timeStart > currentTime || timeEnd < currentTime ) {\r\n          vTime = -1.0;\r\n          return;\r\n        } else {\r\n          float nearBeginning = currentTime - timeStart;\r\n          float nearEnd = timeEnd - currentTime;\r\n          vTime = min(nearBeginning, nearEnd);\r\n        }\r\n      `,\r\n      'fs:#decl': `\\\r\n        uniform float currentTime;\r\n        uniform float searchFlag;\r\n        varying float vTime;\r\n      `,\r\n      'fs:#main-start': `\\\r\n      if (searchFlag == 0.0 && vTime == -1.0 ) discard;\r\n      `,\r\n      // fade the traces in and out\r\n      'fs:DECKGL_FILTER_COLOR': `\\\r\n        if (vTime <= 10.0) color.a *= (vTime / 10.0);\r\n      `,\r\n    }\r\n    return shaders\r\n  }\r\n\r\n  initializeState(params: any) {\r\n    super.initializeState(params)\r\n\r\n    const attributeManager = this.getAttributeManager()\r\n    attributeManager.addInstanced({\r\n      timeStart: { size: 1, accessor: 'getTimeStart' },\r\n      timeEnd: { size: 1, accessor: 'getTimeEnd' },\r\n    })\r\n  }\r\n\r\n  draw(params: any) {\r\n    const { currentTime } = this.props\r\n\r\n    params.uniforms = Object.assign({}, params.uniforms, {\r\n      currentTime,\r\n    })\r\n\r\n    super.draw(params)\r\n  }\r\n}\r\n\r\nDrtRequestArcLayer.layerName = 'DrtRequestArcLayer'\r\nDrtRequestArcLayer.defaultProps = defaultProps\r\n","import React, { useState, useMemo, useEffect } from 'react'\r\nimport { StaticMap } from 'react-map-gl'\r\nimport { AmbientLight, PointLight, LightingEffect } from '@deck.gl/core'\r\nimport DeckGL from '@deck.gl/react'\r\n\r\nimport DrtRequestLayer from './DrtRequestLayer'\r\nimport MovingIconsLayer from '@/layers/moving-icons/moving-icons-layer'\r\nimport PathTraceLayer from '@/layers/PathTraceLayer'\r\nimport { MAPBOX_TOKEN, REACT_VIEW_HANDLES } from '@/Globals'\r\n\r\nimport globalStore from '@/store'\r\n\r\nconst BASE_URL = import.meta.env.BASE_URL\r\n\r\nconst ICON_MAPPING = {\r\n  marker: { x: 0, y: 0, width: 128, height: 128, mask: true },\r\n  info: { x: 128, y: 0, width: 128, height: 128, mask: true },\r\n  vehicle: { x: 128, y: 128, width: 128, height: 128, mask: true },\r\n  diamond: { x: 0, y: 128, width: 128, height: 128, mask: false },\r\n}\r\n\r\nconst ambientLight = new AmbientLight({\r\n  color: [255, 255, 255],\r\n  intensity: 1.0,\r\n})\r\n\r\nconst pointLight = new PointLight({\r\n  color: [255, 255, 255],\r\n  intensity: 2.0,\r\n  position: [-74.05, 40.7, 8000],\r\n})\r\n\r\nconst lightingEffect = new LightingEffect({ ambientLight, pointLight })\r\n\r\nconst DEFAULT_THEME = {\r\n  vehicleColor: [200, 130, 250],\r\n  trailColor0: [235, 235, 25],\r\n  trailColor1: [23, 184, 190],\r\n  effects: [lightingEffect],\r\n}\r\n\r\nconst DRT_REQUEST = {\r\n  time: 0,\r\n  fromX: 1,\r\n  fromY: 2,\r\n  toX: 3,\r\n  toY: 4,\r\n  veh: 5,\r\n  arrival: 6,\r\n}\r\n\r\nexport default function Component(props: {\r\n  viewId: number\r\n  dark: boolean\r\n  simulationTime: number\r\n  paths: any[]\r\n  drtRequests: any[]\r\n  traces: any[]\r\n  colors: any\r\n  center: [number, number]\r\n  settingsShowLayers: { [label: string]: boolean }\r\n  vehicleLookup: string[]\r\n  searchEnabled: boolean\r\n  onClick: any\r\n}) {\r\n  const {\r\n    simulationTime,\r\n    paths,\r\n    traces,\r\n    drtRequests,\r\n    settingsShowLayers,\r\n    center,\r\n    dark,\r\n    vehicleLookup,\r\n    searchEnabled,\r\n    onClick,\r\n    viewId,\r\n  } = props\r\n\r\n  const theme = DEFAULT_THEME\r\n\r\n  // set initial view\r\n  const [viewState, setViewState] = useState(\r\n    center\r\n      ? ({\r\n          center: [16, 42],\r\n          longitude: center[0],\r\n          latitude: center[1],\r\n          pitch: 0,\r\n          bearing: 0,\r\n          zoom: 10,\r\n        } as any)\r\n      : Object.assign({}, globalStore.state.viewState)\r\n  )\r\n\r\n  // register setViewState in global view updater so we can respond to external map motion\r\n  REACT_VIEW_HANDLES[viewId] = () => {\r\n    setViewState(globalStore.state.viewState)\r\n  }\r\n\r\n  const arcWidth = 1\r\n  const [hoverInfo, setHoverInfo] = useState({} as any)\r\n\r\n  const layers: any = []\r\n\r\n  function handleClick() {\r\n    console.log(hoverInfo)\r\n    // send null as message that blank area was clicked\r\n    if (!hoverInfo.object) {\r\n      onClick(null)\r\n    } else {\r\n      onClick(hoverInfo.object.v)\r\n    }\r\n  }\r\n\r\n  function renderTooltip({ hoverInfo }: any) {\r\n    const { object, x, y } = hoverInfo\r\n\r\n    if (!object) {\r\n      return null\r\n    }\r\n\r\n    const vehicleId = vehicleLookup[object.v]\r\n\r\n    return (\r\n      <div\r\n        className=\"tooltip\"\r\n        style={{\r\n          fontSize: '0.8rem',\r\n          backgroundColor: '#ddddeedd',\r\n          borderLeft: '6px solid green',\r\n          boxShadow: '2.5px 2px 4px rgba(0,0,0,0.25)',\r\n          color: '#223',\r\n          padding: '1rem 1rem',\r\n          position: 'absolute',\r\n          left: x + 40,\r\n          top: y - 30,\r\n        }}\r\n      >\r\n        <big>\r\n          <b>{vehicleId}</b>\r\n        </big>\r\n        <div>Passagiere: {object.occ} </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (settingsShowLayers.routes)\r\n    layers.push(\r\n      //@ts-ignore:\r\n      new PathTraceLayer({\r\n        id: 'Routen',\r\n        data: traces,\r\n        currentTime: simulationTime,\r\n        getSourcePosition: (d: any) => d.p0,\r\n        getTargetPosition: (d: any) => d.p1,\r\n        getTimeStart: (d: any) => d.t0,\r\n        getTimeEnd: (d: any) => d.t1,\r\n        getColor: (d: any) => props.colors[d.occ],\r\n        getWidth: 1, // (d: any) => 3.0 * (d.occ + 1) - 1,\r\n        opacity: 0.8,\r\n        widthMinPixels: 1,\r\n        rounded: false,\r\n        shadowEnabled: false,\r\n        searchFlag: searchEnabled ? 1.0 : 0.0,\r\n        pickable: true,\r\n        autoHighlight: true,\r\n        highlightColor: [255, 0, 255],\r\n        onHover: setHoverInfo,\r\n      })\r\n    )\r\n\r\n  if (settingsShowLayers.vehicles)\r\n    layers.push(\r\n      //@ts-ignore\r\n      new MovingIconsLayer({\r\n        id: 'Vehicles',\r\n        data: paths,\r\n        getPathStart: (d: any) => d.p0,\r\n        getPathEnd: (d: any) => d.p1,\r\n        getTimeStart: (d: any) => d.t0,\r\n        getTimeEnd: (d: any) => d.t1,\r\n        getIcon: (d: any) => 'vehicle',\r\n        getColor: (d: any) => props.colors[d.occ],\r\n        iconMoving: 'vehicle',\r\n        iconStill: 'diamond',\r\n        getSize: searchEnabled ? 72 : 64,\r\n        opacity: 1.0,\r\n        currentTime: simulationTime,\r\n        shadowEnabled: false,\r\n        noAlloc: true,\r\n        iconAtlas: BASE_URL + '/images/icon-atlas.png',\r\n        iconMapping: ICON_MAPPING,\r\n        sizeScale: 0.5,\r\n        billboard: false,\r\n        pickable: true,\r\n        depthTest: true,\r\n        autoHighlight: false,\r\n        highlightColor: [255, 0, 255],\r\n        onHover: setHoverInfo,\r\n        parameters: {\r\n          depthTest: false,\r\n        },\r\n      })\r\n    )\r\n\r\n  if (settingsShowLayers.requests)\r\n    layers.push(\r\n      //@ts-ignore:\r\n      new DrtRequestLayer({\r\n        id: 'DRT Requests',\r\n        data: drtRequests,\r\n        currentTime: simulationTime,\r\n        getSourcePosition: (d: any) => [d[DRT_REQUEST.fromX], d[DRT_REQUEST.fromY]],\r\n        getTargetPosition: (d: any) => [d[DRT_REQUEST.toX], d[DRT_REQUEST.toY]],\r\n        getTimeStart: (d: any) => d[DRT_REQUEST.time],\r\n        getTimeEnd: (d: any) => d[DRT_REQUEST.arrival],\r\n        getSourceColor: [255, 0, 255],\r\n        getTargetColor: [200, 255, 255],\r\n        getWidth: arcWidth,\r\n        opacity: 0.5,\r\n        searchFlag: searchEnabled ? 1.0 : 0.0,\r\n      })\r\n    )\r\n\r\n  return (\r\n    <DeckGL\r\n      layers={layers}\r\n      effects={theme.effects}\r\n      pickingRadius={5}\r\n      viewState={viewState}\r\n      controller={true}\r\n      getCursor={() => 'pointer'}\r\n      onClick={handleClick}\r\n      onViewStateChange={(e: any) => {\r\n        globalStore.commit('setMapCamera', e.viewState)\r\n      }}\r\n    >\r\n      {\r\n        /*\r\n        // @ts-ignore */\r\n        <StaticMap mapStyle={globalStore.getters.mapStyle} mapboxApiAccessToken={MAPBOX_TOKEN} />\r\n      }\r\n      {renderTooltip({ hoverInfo })}\r\n    </DeckGL>\r\n  )\r\n}\r\n","<template lang=\"pug\">\r\n.gl-app(:class=\"{'hide-thumbnail': !thumbnail}\"\r\n        :style='{\"background\": urlThumbnail}' oncontextmenu=\"return false\")\r\n\r\n  trip-viz.anim(v-if=\"!thumbnail\"\r\n                :center = \"vizDetails.center\"\r\n                :colors = \"COLOR_OCCUPANCY\"\r\n                :drtRequests = \"$options.drtRequests\"\r\n                :dark = \"globalState.isDarkMode\"\r\n                :paths = \"$options.paths\"\r\n                :settingsShowLayers = \"SETTINGS\"\r\n                :searchEnabled = \"searchEnabled\"\r\n                :simulationTime = \"simulationTime\"\r\n                :traces = \"$options.traces\"\r\n                :vehicleLookup = \"vehicleLookup\"\r\n                :viewId = \"viewId\"\r\n                :onClick = \"handleClick\")\r\n\r\n  zoom-buttons(v-if=\"!thumbnail\")\r\n\r\n  //- isLoaded && !thumbnail\")\r\n  .right-side(v-if=\"isLoaded && !thumbnail\")\r\n    collapsible-panel(direction=\"right\")\r\n      .big.clock\r\n        p {{ myState.clock }}\r\n\r\n      .panel-items\r\n        legend-colors.legend-block(v-if=\"legendItems.length\"\r\n          :title=\"`${$t('passengers')}:`\" :items=\"legendItems\")\r\n\r\n        legend-colors.legend-block(:title=\"`${$t('requests')}:`\" :items=\"legendRequests\")\r\n\r\n        .search-panel\r\n          p.speed-label(:style=\"{margin: '1rem 0 0 0'}\") {{ $t('search') }}\r\n          form(autocomplete=\"off\")\r\n          .field\r\n            p.control.has-icons-left\r\n              input.input.is-small(type=\"email\" :placeholder=\"`${$t('search')}...`\" v-model=\"searchTerm\")\r\n              span.icon.is-small.is-left\r\n                i.fas.fa-search\r\n\r\n        settings-panel.settings-area(:items=\"SETTINGS\" @click=\"handleSettingChange\")\r\n\r\n        .speed-block\r\n          p.speed-label {{ $t('speed') }}:\r\n            br\r\n            | {{ speed }}x\r\n\r\n          b-slider.speed-slider(v-model=\"speed\"\r\n            :min=\"speedStops[0]\"\r\n            :max=\"speedStops[speedStops.length-1]\"\r\n            :duration=\"0\"\r\n            :dotSize=\"20\"\r\n            :tooltip=\"true\"\r\n            tooltip-placement=\"bottom\"\r\n            :tooltip-formatter=\"val => val + 'x'\"\r\n          )\r\n            template(v-for=\"val in speedStops\")\r\n              b-slider-tick(:value=\"val\" :key=\"val\")\r\n\r\n  playback-controls.bottom-area(v-if=\"!thumbnail && isLoaded\"\r\n      @click='toggleSimulation'\r\n      @time='setTime'\r\n      :timeStart = \"timeStart\"\r\n      :timeEnd = \"timeEnd\"\r\n      :isRunning = \"myState.isRunning\"\r\n      :currentTime = \"simulationTime\")\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      requests: 'DRT Requests',\r\n      passengers: 'Passengers',\r\n      search: 'Search',\r\n      showhide: 'Show/Hide',\r\n      vehicles: 'Vehicles',\r\n      routes: 'Routes',\r\n      speed: 'Speed',\r\n    },\r\n    de: {\r\n      requests: 'DRT Anfragen',\r\n      passengers: 'Passagiere',\r\n      search: 'Suche',\r\n      showhide: 'Ein-/Ausblenden',\r\n      vehicles: 'DRT Fahrzeuge',\r\n      routes: 'DRT Routen',\r\n      speed: 'Geschwindigkeit',\r\n    },\r\n  },\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\nimport type { PropType } from 'vue'\r\n\r\nimport VueSlider from 'vue-slider-component'\r\nimport { ToggleButton } from 'vue-js-toggle-button'\r\nimport readBlob from 'read-blob'\r\nimport YAML from 'yaml'\r\nimport crossfilter from 'crossfilter2'\r\nimport { blobToArrayBuffer, blobToBinaryString } from 'blob-util'\r\nimport * as coroutines from 'js-coroutines'\r\n\r\nimport globalStore from '@/store'\r\nimport pako from '@aftersim/pako'\r\nimport CollapsiblePanel from '@/components/CollapsiblePanel.vue'\r\nimport LegendColors from './LegendColors'\r\nimport PlaybackControls from '@/components/PlaybackControls.vue'\r\nimport SettingsPanel from './SettingsPanel.vue'\r\nimport ZoomButtons from '@/components/ZoomButtons.vue'\r\n\r\nimport {\r\n  ColorScheme,\r\n  FileSystem,\r\n  LegendItem,\r\n  LegendItemType,\r\n  FileSystemConfig,\r\n  VisualizationPlugin,\r\n  LIGHT_MODE,\r\n  DARK_MODE,\r\n  REACT_VIEW_HANDLES,\r\n} from '@/Globals'\r\n\r\nimport TripViz from './TripViz'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\n\r\nconst MyComponent = defineComponent({\r\n  name: 'VehicleAnimationPlugin',\r\n  i18n,\r\n  components: {\r\n    CollapsiblePanel,\r\n    SettingsPanel,\r\n    LegendColors,\r\n    TripViz,\r\n    VueSlider,\r\n    PlaybackControls,\r\n    ToggleButton,\r\n    ZoomButtons,\r\n  },\r\n  props: {\r\n    root: { type: String, required: true },\r\n    subfolder: { type: String, required: true },\r\n    yamlConfig: String,\r\n    thumbnail: Boolean,\r\n  },\r\n  data: () => {\r\n    const COLOR_OCCUPANCY = {\r\n      0: [140, 140, 160],\r\n      1: [85, 255, 85],\r\n      2: [255, 255, 85],\r\n      3: [240, 110, 30],\r\n      4: [192, 30, 50],\r\n    } as any\r\n\r\n    const SETTINGS = {\r\n      vehicles: true,\r\n      routes: true,\r\n      requests: false,\r\n    } as any\r\n\r\n    return {\r\n      viewId: Math.floor(1e12 * Math.random()),\r\n      COLOR_OCCUPANCY,\r\n      SETTINGS,\r\n      legendItems: Object.keys(COLOR_OCCUPANCY).map(key => {\r\n        return {\r\n          type: LegendItemType.line,\r\n          color: COLOR_OCCUPANCY[key],\r\n          value: key,\r\n          label: key,\r\n        }\r\n      }),\r\n\r\n      legendRequests: [{ type: LegendItemType.line, color: [255, 0, 255], value: 0, label: '' }],\r\n\r\n      vizDetails: {\r\n        network: '',\r\n        drtTrips: '',\r\n        projection: '',\r\n        title: '',\r\n        description: '',\r\n        thumbnail: '',\r\n        center: [13.45, 52.5],\r\n        zoom: 10,\r\n        mapIsIndependent: false,\r\n        theme: '',\r\n      },\r\n\r\n      myState: {\r\n        statusMessage: '',\r\n        clock: '00:00',\r\n        colorScheme: ColorScheme.DarkMode,\r\n        isRunning: false,\r\n        isShowingHelp: false,\r\n        subfolder: '',\r\n        yamlConfig: '',\r\n        thumbnail: false,\r\n        data: [] as any[],\r\n      },\r\n\r\n      timeStart: 0,\r\n      timeEnd: 86400,\r\n\r\n      traces: crossfilter([]) as crossfilter.Crossfilter<any>,\r\n      traceStart: {} as crossfilter.Dimension<any, any>,\r\n      traceEnd: {} as crossfilter.Dimension<any, any>,\r\n      traceVehicle: {} as crossfilter.Dimension<any, any>,\r\n\r\n      paths: crossfilter([]) as crossfilter.Crossfilter<any>,\r\n      pathStart: {} as crossfilter.Dimension<any, any>,\r\n      pathEnd: {} as crossfilter.Dimension<any, any>,\r\n      pathVehicle: {} as crossfilter.Dimension<any, any>,\r\n\r\n      requests: crossfilter([]) as crossfilter.Crossfilter<any>,\r\n      requestStart: {} as crossfilter.Dimension<any, any>,\r\n      requestEnd: {} as crossfilter.Dimension<any, any>,\r\n      requestVehicle: {} as crossfilter.Dimension<any, any>,\r\n\r\n      simulationTime: 6 * 3600, // 8 * 3600 + 10 * 60 + 10\r\n\r\n      timeElapsedSinceLastFrame: 0,\r\n\r\n      searchTerm: '',\r\n      searchEnabled: false,\r\n\r\n      globalState: globalStore.state,\r\n      isDarkMode: globalStore.state.isDarkMode,\r\n      isLoaded: true,\r\n      showHelp: false,\r\n\r\n      speedStops: [-10, -5, -2, -1, -0.5, -0.25, 0, 0.25, 0.5, 1, 2, 5, 10],\r\n      speed: 1,\r\n\r\n      legendBits: [] as any[],\r\n      thumbnailUrl: \"url('assets/thumbnail.jpg') no-repeat;\",\r\n\r\n      vehicleLookup: [] as string[],\r\n      vehicleLookupString: {} as { [id: string]: number },\r\n      isPausedDueToHiding: false,\r\n    }\r\n  },\r\n  computed: {\r\n    fileApi(): HTTPFileSystem {\r\n      return new HTTPFileSystem(this.fileSystem, globalStore)\r\n    },\r\n\r\n    fileSystem(): FileSystemConfig {\r\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === this.root\r\n      )\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n      return svnProject[0]\r\n    },\r\n\r\n    urlThumbnail(): string {\r\n      return this.thumbnailUrl\r\n    },\r\n    textColor(): any {\r\n      const lightmode = {\r\n        text: '#3498db',\r\n        bg: '#eeeef480',\r\n      }\r\n\r\n      const darkmode = {\r\n        text: 'white',\r\n        bg: '#181518aa',\r\n      }\r\n\r\n      return this.myState.colorScheme === ColorScheme.DarkMode ? darkmode : lightmode\r\n    },\r\n  },\r\n  watch: {\r\n    '$store.state.viewState'() {\r\n      if (this.vizDetails.mapIsIndependent) return\r\n\r\n      if (!REACT_VIEW_HANDLES[this.viewId]) return\r\n      REACT_VIEW_HANDLES[this.viewId]()\r\n    },\r\n\r\n    async 'globalState.authAttempts'() {\r\n      console.log('AUTH CHANGED - Reload')\r\n      if (!this.yamlConfig) this.buildRouteFromUrl()\r\n      await this.getVizDetails()\r\n    },\r\n\r\n    'globalState.colorScheme'() {\r\n      this.isDarkMode = this.globalState.colorScheme === ColorScheme.DarkMode\r\n      this.updateLegendColors()\r\n    },\r\n\r\n    searchTerm() {\r\n      const vehicleNumber = this.vehicleLookupString[this.searchTerm]\r\n      if (vehicleNumber > -1) {\r\n        console.log('vehicle', vehicleNumber)\r\n        this.pathVehicle?.filterExact(vehicleNumber)\r\n        this.traceVehicle?.filterExact(vehicleNumber)\r\n        this.requestVehicle?.filterExact(vehicleNumber)\r\n        this.requestStart.filterAll()\r\n        this.requestEnd.filterAll()\r\n        this.searchEnabled = true\r\n      } else {\r\n        console.log('nope')\r\n        this.pathVehicle?.filterAll()\r\n        this.traceVehicle?.filterAll()\r\n        this.requestVehicle?.filterAll()\r\n        this.searchEnabled = false\r\n      }\r\n      this.updateDatasetFilters()\r\n    },\r\n  },\r\n  methods: {\r\n    async handleSettingChange(label: string) {\r\n      console.log(label)\r\n      this.SETTINGS[label] = !this.SETTINGS[label]\r\n      this.updateDatasetFilters()\r\n      this.simulationTime += 1 // this will force a redraw\r\n    },\r\n\r\n    // this happens if viz is the full page, not a thumbnail on a project page\r\n    buildRouteFromUrl() {\r\n      const params = this.$route.params\r\n      if (!params.project || !params.pathMatch) {\r\n        console.log('I CANT EVEN: NO PROJECT/PARHMATCH')\r\n        return\r\n      }\r\n\r\n      // subfolder and config file\r\n      const sep = 1 + params.pathMatch.lastIndexOf('/')\r\n      const subfolder = params.pathMatch.substring(0, sep)\r\n      const config = params.pathMatch.substring(sep)\r\n\r\n      this.myState.subfolder = subfolder\r\n      this.myState.yamlConfig = config\r\n    },\r\n\r\n    async getVizDetails() {\r\n      // first get config\r\n      try {\r\n        // might be a project config:\r\n        const filename =\r\n          this.myState.yamlConfig.indexOf('/') > -1\r\n            ? this.myState.yamlConfig\r\n            : this.myState.subfolder + '/' + this.myState.yamlConfig\r\n\r\n        const text = await this.fileApi.getFileText(filename)\r\n        this.vizDetails = YAML.parse(text)\r\n      } catch (err) {\r\n        console.log('failed')\r\n        const e = err as any\r\n        // maybe it failed because password?\r\n        if (this.fileSystem.needPassword && e.status === 401) {\r\n          globalStore.commit('requestLogin', this.fileSystem.slug)\r\n        }\r\n      }\r\n\r\n      // initial view\r\n      if (this.vizDetails.theme) this.$store.commit('setTheme', this.vizDetails.theme)\r\n\r\n      if (this.vizDetails.center) {\r\n        this.$store.commit('setMapCamera', {\r\n          longitude: this.vizDetails.center[0],\r\n          latitude: this.vizDetails.center[1],\r\n          zoom: this.vizDetails.zoom || 10,\r\n          pitch: 10,\r\n          bearing: 0,\r\n        })\r\n      }\r\n\r\n      // title\r\n      const t = this.vizDetails.title ? this.vizDetails.title : 'Agent Animation'\r\n      this.$emit('title', t)\r\n\r\n      this.buildThumbnail()\r\n    },\r\n\r\n    async buildThumbnail() {\r\n      if (this.thumbnail && this.vizDetails.thumbnail) {\r\n        try {\r\n          const blob = await this.fileApi.getFileBlob(\r\n            this.myState.subfolder + '/' + this.vizDetails.thumbnail\r\n          )\r\n          const buffer = await readBlob.arraybuffer(blob)\r\n          const base64 = this.arrayBufferToBase64(buffer)\r\n          if (base64)\r\n            this.thumbnailUrl = `center / cover no-repeat url(data:image/png;base64,${base64})`\r\n        } catch (e) {\r\n          console.error(e)\r\n        }\r\n      }\r\n    },\r\n\r\n    handleClick(vehicleNumber: any) {\r\n      // null means empty area clicked: clear map.\r\n      if (vehicleNumber === null) {\r\n        this.searchTerm = ''\r\n        return\r\n      }\r\n\r\n      const vehId = this.vehicleLookup[vehicleNumber]\r\n      console.log(vehId)\r\n\r\n      // set -- or clear -- search box!\r\n      if (this.searchTerm === vehId) this.searchTerm = ''\r\n      else this.searchTerm = vehId\r\n    },\r\n\r\n    arrayBufferToBase64(buffer: any) {\r\n      var binary = ''\r\n      var bytes = new Uint8Array(buffer)\r\n      var len = bytes.byteLength\r\n      for (var i = 0; i < len; i++) {\r\n        binary += String.fromCharCode(bytes[i])\r\n      }\r\n      return window.btoa(binary)\r\n    },\r\n\r\n    updateLegendColors() {\r\n      // const theme = this.myState.colorScheme == ColorScheme.LightMode ? LIGHT_MODE : DARK_MODE\r\n      // this.legendBits = [\r\n      //   { label: 'susceptible', color: theme.susceptible },\r\n      //   { label: 'latently infected', color: theme.infectedButNotContagious },\r\n      //   { label: 'contagious', color: theme.contagious },\r\n      //   { label: 'symptomatic', color: theme.symptomatic },\r\n      //   { label: 'seriously ill', color: theme.seriouslyIll },\r\n      //   { label: 'critical', color: theme.critical },\r\n      //   { label: 'recovered', color: theme.recovered },\r\n      // ]\r\n    },\r\n\r\n    setWallClock() {\r\n      const hour = Math.floor(this.simulationTime / 3600)\r\n      const minute = Math.floor(this.simulationTime / 60) % 60\r\n      this.myState.clock = `${hour < 10 ? '0' : ''}${hour}${minute < 10 ? ':0' : ':'}${minute}`\r\n    },\r\n\r\n    setTime(seconds: number) {\r\n      this.simulationTime = seconds\r\n      this.setWallClock()\r\n\r\n      // only filter if search is disabled and we have data loaded already\r\n      if (this.traceStart && this.pathStart && this.requestStart) {\r\n        this.pathStart.filter([0, this.simulationTime])\r\n        this.pathEnd.filter([this.simulationTime, Infinity])\r\n\r\n        // scrub vehicles if search is disabled\r\n        if (!this.searchEnabled) {\r\n          this.traceStart.filter([0, this.simulationTime])\r\n          this.traceEnd.filter([this.simulationTime, Infinity])\r\n          this.requestStart.filter([0, this.simulationTime])\r\n          this.requestEnd.filter([this.simulationTime, Infinity])\r\n        }\r\n      }\r\n\r\n      //@ts-ignore\r\n      this.$options.paths = this.paths.allFiltered()\r\n      //@ts-ignore\r\n      this.$options.traces = this.traces.allFiltered()\r\n      //@ts-ignore\r\n      this.$options.drtRequests = this.requests.allFiltered()\r\n    },\r\n\r\n    toggleSimulation() {\r\n      this.myState.isRunning = !this.myState.isRunning\r\n      this.timeElapsedSinceLastFrame = Date.now()\r\n\r\n      // ok so, many times I mashed the play/pause wondering why things wouldn't\r\n      // start moving. Turns out a 0x speed is not very helpful! Help the user\r\n      // out and switch the speed up if they press play.\r\n      if (this.myState.isRunning && this.speed === 0.0) this.speed = 1.0\r\n\r\n      // and begin!\r\n      if (this.myState.isRunning) this.animate()\r\n    },\r\n\r\n    async parseDrtRequests(requests: any[]) {\r\n      if (this.vehicleLookup.length) {\r\n        for (const request of requests) {\r\n          try {\r\n            request[5] = this.vehicleLookupString[request[5]]\r\n          } catch (e) {}\r\n        }\r\n      }\r\n\r\n      return crossfilter(requests)\r\n    },\r\n\r\n    async parseVehicles(trips: any[]) {\r\n      const allTrips: any[] = []\r\n      let vehNumber = -1\r\n\r\n      await coroutines.forEachAsync(trips, (trip: any) => {\r\n        const path = trip.path\r\n        const timestamps = trip.timestamps\r\n        const passengers = trip.passengers\r\n\r\n        // attach vehicle ID to each segment so we can click\r\n        vehNumber++\r\n        this.vehicleLookup[vehNumber] = trip.id\r\n        this.vehicleLookupString[trip.id] = vehNumber\r\n\r\n        for (let i = 0; i < trip.path.length - 1; i++) {\r\n          allTrips.push({\r\n            t0: timestamps[i],\r\n            t1: timestamps[i + 1],\r\n            p0: path[i],\r\n            p1: path[i + 1],\r\n            v: vehNumber,\r\n            occ: passengers[i],\r\n          })\r\n        }\r\n      })\r\n      return crossfilter(allTrips)\r\n    },\r\n\r\n    updateDatasetFilters() {\r\n      // dont' filter if we haven't loaded yet\r\n      if (!this.traceStart || !this.pathStart || !this.requestStart) return\r\n\r\n      // filter out all traces that havent started or already finished\r\n      if (this.SETTINGS.routes) {\r\n        if (this.searchEnabled) {\r\n          this.traceStart.filterAll()\r\n          this.traceEnd.filterAll()\r\n        } else {\r\n          this.traceStart.filter([0, this.simulationTime])\r\n          this.traceEnd.filter([this.simulationTime, Infinity])\r\n        }\r\n        //@ts-ignore\r\n        this.$options.traces = this.traces.allFiltered()\r\n      }\r\n\r\n      if (this.SETTINGS.vehicles) {\r\n        this.pathStart.filter([0, this.simulationTime])\r\n        this.pathEnd.filter([this.simulationTime, Infinity])\r\n        //@ts-ignore:\r\n        this.$options.paths = this.paths.allFiltered()\r\n      }\r\n\r\n      if (this.SETTINGS.requests) {\r\n        if (this.searchEnabled) {\r\n          this.requestStart.filterAll()\r\n          this.requestEnd.filterAll()\r\n        } else {\r\n          this.requestStart.filter([0, this.simulationTime])\r\n          this.requestEnd.filter([this.simulationTime, Infinity])\r\n        }\r\n        //@ts-ignore\r\n        this.$options.drtRequests = this.requests.allFiltered()\r\n      }\r\n    },\r\n\r\n    animate() {\r\n      if (this.myState.isRunning) {\r\n        const elapsed = Date.now() - this.timeElapsedSinceLastFrame\r\n        this.timeElapsedSinceLastFrame += elapsed\r\n        this.simulationTime += elapsed * this.speed * 0.06\r\n\r\n        this.updateDatasetFilters()\r\n        this.setWallClock()\r\n        window.requestAnimationFrame(this.animate)\r\n      }\r\n    },\r\n\r\n    handleVisibilityChange() {\r\n      if (this.isPausedDueToHiding && !document.hidden) {\r\n        console.log('unpausing')\r\n        this.isPausedDueToHiding = false\r\n        this.toggleSimulation()\r\n      } else if (this.myState.isRunning && document.hidden) {\r\n        console.log('pausing')\r\n        this.isPausedDueToHiding = true\r\n        this.toggleSimulation()\r\n      }\r\n    },\r\n\r\n    // convert path/timestamp info into path traces we can use\r\n    async parseRouteTraces(trips: any[]) {\r\n      let countTraces = 0\r\n      let vehNumber = -1\r\n\r\n      const traces: any = []\r\n\r\n      await coroutines.forEachAsync(trips, (vehicle: any) => {\r\n        vehNumber++\r\n\r\n        let time = vehicle.timestamps[0]\r\n        let nextTime = vehicle.timestamps[0]\r\n\r\n        let segments: any[] = []\r\n\r\n        for (let i = 1; i < vehicle.path.length; i++) {\r\n          nextTime = vehicle.timestamps[i]\r\n\r\n          // same point? start of new path.\r\n          if (\r\n            vehicle.path[i][0] === vehicle.path[i - 1][0] &&\r\n            vehicle.path[i][1] === vehicle.path[i - 1][1]\r\n          ) {\r\n            segments.forEach(segment => {\r\n              segment.t1 = vehicle.timestamps[i - 1]\r\n            })\r\n\r\n            traces.push(...segments)\r\n\r\n            segments = []\r\n            time = nextTime\r\n          } else {\r\n            segments.push({\r\n              t0: time,\r\n              p0: vehicle.path[i - 1],\r\n              p1: vehicle.path[i],\r\n              v: vehNumber,\r\n              occ: vehicle.passengers[i - 1],\r\n            })\r\n          }\r\n        }\r\n\r\n        // save final segments\r\n        segments.forEach(segment => {\r\n          segment.t1 = nextTime\r\n        })\r\n        traces.push(...segments)\r\n      })\r\n\r\n      return crossfilter(traces)\r\n    },\r\n\r\n    async loadFiles() {\r\n      let trips: any[] = []\r\n      let drtRequests: any = []\r\n\r\n      try {\r\n        if (this.vizDetails.drtTrips.endsWith('json')) {\r\n          const json = await this.fileApi.getFileJson(\r\n            this.myState.subfolder + '/' + this.vizDetails.drtTrips\r\n          )\r\n          trips = json.trips\r\n          drtRequests = json.drtRequests\r\n        } else if (this.vizDetails.drtTrips.endsWith('gz')) {\r\n          const blob = await this.fileApi.getFileBlob(\r\n            this.myState.subfolder + '/' + this.vizDetails.drtTrips\r\n          )\r\n          const blobString = blob ? await blobToBinaryString(blob) : null\r\n          let text = await coroutines.run(pako.inflateAsync(blobString, { to: 'string' }))\r\n          const json = JSON.parse(text)\r\n\r\n          trips = json.trips\r\n          drtRequests = json.drtRequests\r\n        }\r\n      } catch (e) {\r\n        console.error(e)\r\n        this.myState.statusMessage = '' + e\r\n      }\r\n      return { trips, drtRequests }\r\n    },\r\n\r\n    toggleLoaded(loaded: boolean) {\r\n      this.isLoaded = loaded\r\n    },\r\n\r\n    rotateColors() {\r\n      this.myState.colorScheme =\r\n        this.myState.colorScheme === ColorScheme.DarkMode\r\n          ? ColorScheme.LightMode\r\n          : ColorScheme.DarkMode\r\n      localStorage.setItem('plugin/agent-animation/colorscheme', this.myState.colorScheme)\r\n    },\r\n  },\r\n\r\n  async mounted() {\r\n    globalStore.commit('setFullScreen', !this.thumbnail)\r\n\r\n    this.myState.thumbnail = this.thumbnail\r\n    this.myState.yamlConfig = this.yamlConfig ?? ''\r\n    this.myState.subfolder = this.subfolder\r\n\r\n    await this.getVizDetails()\r\n\r\n    if (this.thumbnail) return\r\n\r\n    this.showHelp = false\r\n    this.updateLegendColors()\r\n\r\n    this.setWallClock()\r\n\r\n    this.myState.statusMessage = '/ Dateien laden...'\r\n    console.log('loading files')\r\n    const { trips, drtRequests } = await this.loadFiles()\r\n\r\n    console.log('parsing vehicle motion')\r\n    this.myState.statusMessage = `${this.$t('vehicles')}...`\r\n    this.paths = await this.parseVehicles(trips)\r\n    this.pathStart = this.paths.dimension(d => d.t0)\r\n    this.pathEnd = this.paths.dimension(d => d.t1)\r\n    this.pathVehicle = this.paths.dimension(d => d.v)\r\n\r\n    console.log('Routes...')\r\n    this.myState.statusMessage = `${this.$t('routes')}...`\r\n    this.traces = await this.parseRouteTraces(trips)\r\n    this.traceStart = this.traces.dimension(d => d.t0)\r\n    this.traceEnd = this.traces.dimension(d => d.t1)\r\n    this.traceVehicle = this.traces.dimension(d => d.v)\r\n\r\n    console.log('Requests...')\r\n    this.myState.statusMessage = `${this.$t('requests')}...`\r\n    this.requests = await this.parseDrtRequests(drtRequests)\r\n    this.requestStart = this.requests.dimension(d => d[0]) // time0\r\n    this.requestEnd = this.requests.dimension(d => d[6]) // arrival\r\n    this.requestVehicle = this.requests.dimension(d => d[5])\r\n\r\n    console.log('GO!')\r\n    this.myState.statusMessage = ''\r\n\r\n    document.addEventListener('visibilitychange', this.handleVisibilityChange, false)\r\n\r\n    this.myState.isRunning = true\r\n    this.timeElapsedSinceLastFrame = Date.now()\r\n    this.animate()\r\n  },\r\n\r\n  beforeDestroy() {\r\n    document.removeEventListener('visibilityChange', this.handleVisibilityChange)\r\n    globalStore.commit('setFullScreen', false)\r\n    this.$store.commit('setFullScreen', false)\r\n    this.myState.isRunning = false\r\n  },\r\n})\r\n\r\n// !register plugin!\r\nglobalStore.commit('registerPlugin', {\r\n  kebabName: 'vehicle-view',\r\n  prettyName: 'Trip Viewer',\r\n  description: 'Deck.gl based trip viewer',\r\n  filePatterns: ['**/viz-vehicles*.y?(a)ml'],\r\n  component: MyComponent,\r\n} as VisualizationPlugin)\r\n\r\nexport default MyComponent\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '~/vue-slider-component/theme/default.css';\r\n@import '@/styles.scss';\r\n\r\n.gl-app {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  display: grid;\r\n  pointer-events: none;\r\n  min-height: $thumbnailHeight;\r\n  background: url('assets/thumbnail.jpg') no-repeat;\r\n  background-size: cover;\r\n  grid-template-columns: 1fr min-content;\r\n  grid-template-rows: auto auto 1fr auto;\r\n  grid-template-areas:\r\n    'title         clock'\r\n    '.           rightside'\r\n    'playback    rightside';\r\n}\r\n\r\n.gl-app.hide-thumbnail {\r\n  background: none;\r\n}\r\n\r\n.nav {\r\n  z-index: 5;\r\n  grid-column: 1 / 4;\r\n  grid-row: 1 / 4;\r\n  box-shadow: 0px 2px 10px #22222266;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin: auto auto 0 0;\r\n  background-color: var(--bgPanel);\r\n  padding: 0rem 3rem;\r\n\r\n  a {\r\n    color: white;\r\n    text-decoration: none;\r\n\r\n    &.router-link-exact-active {\r\n      color: white;\r\n    }\r\n  }\r\n\r\n  p {\r\n    margin: auto 0.5rem auto 0;\r\n    font-weight: normal;\r\n    padding: 0 0;\r\n    color: var(--textFancy);\r\n  }\r\n}\r\n\r\n.speed-block {\r\n  margin-top: 1rem;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.legend-block {\r\n  margin-top: 1rem;\r\n}\r\n\r\n.speed-slider {\r\n  flex: 1;\r\n  width: 100%;\r\n  margin: 0.5rem 0.25rem 0.25rem 0rem;\r\n  padding: 0 0.5rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.big {\r\n  padding: 0rem 0;\r\n  font-size: 2.5rem;\r\n  line-height: 3.75rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.right-side {\r\n  width: 11rem;\r\n  grid-area: rightside;\r\n  display: flex;\r\n  flex-direction: column;\r\n  font-size: 0.8rem;\r\n  pointer-events: auto;\r\n  margin-top: auto;\r\n  margin-bottom: 35px;\r\n  z-index: 5;\r\n}\r\n\r\n.bottom-area {\r\n  grid-area: playback;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin-top: auto;\r\n  margin-bottom: 35px;\r\n  padding: 0.5rem 1rem;\r\n  pointer-events: auto;\r\n  width: 100%;\r\n}\r\n\r\n.settings-area {\r\n  z-index: 20;\r\n  pointer-events: auto;\r\n  font-size: 0.8rem;\r\n  padding: 0.25rem 0;\r\n  margin: 1.5rem 0rem 0 0;\r\n}\r\n\r\n.anim {\r\n  grid-column: 1 / 3;\r\n  grid-row: 1 / 7;\r\n  pointer-events: auto;\r\n}\r\n\r\n.speed-label {\r\n  font-size: 0.8rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.clock {\r\n  color: white;\r\n  width: 100%;\r\n  background-color: #000000cc;\r\n  border: 3px solid white;\r\n  color: white;\r\n}\r\n\r\n.clock p {\r\n  text-align: center;\r\n  padding: 5px 1.5rem;\r\n}\r\n\r\n.tooltip {\r\n  padding: 5rem 5rem;\r\n  background-color: #ccc;\r\n}\r\n\r\n.panel-items {\r\n  margin: 0.5rem 0.5rem;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\ninput {\r\n  border: none;\r\n  background-color: var(--bgCream);\r\n  color: #ccc;\r\n}\r\n\r\n.left-side {\r\n  grid-column: 1/4;\r\n  grid-row: 1/4;\r\n  display: flex;\r\n  flex-direction: column;\r\n  font-size: 0.8rem;\r\n  pointer-events: auto;\r\n  margin: 0 auto 0 0;\r\n  z-index: 1;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n  .nav {\r\n    padding: 0.5rem 0.5rem;\r\n  }\r\n\r\n  .clock {\r\n    text-align: center;\r\n  }\r\n\r\n  .right-side {\r\n    font-size: 0.7rem;\r\n    margin-right: 0.25rem;\r\n  }\r\n\r\n  .big {\r\n    padding: 0 0rem;\r\n    margin-top: 0.5rem;\r\n    font-size: 1.3rem;\r\n    line-height: 2rem;\r\n  }\r\n\r\n  .side-section {\r\n    margin-left: 0;\r\n  }\r\n\r\n  .extra-buttons {\r\n    margin-right: 1rem;\r\n  }\r\n  .playback-stuff {\r\n    padding-right: 1rem;\r\n  }\r\n}\r\n</style>\r\n","import { LegendItem } from '@/Globals'\r\nimport React from 'react'\r\n\r\nexport default function Component(props: {\r\n  title: string\r\n  description?: string\r\n  values: number[]\r\n  items: LegendItem[]\r\n}) {\r\n  const listItems = props.items.map(item => (\r\n    <li key={item.value + item.value[0]} style={{ display: 'flex' }}>\r\n      {item.label && (\r\n        <div\r\n          style={{\r\n            margin: '0 0.5rem 0.0rem 0',\r\n            fontWeight: 'bold',\r\n          }}\r\n        >\r\n          {item.label}\r\n        </div>\r\n      )}\r\n      <div\r\n        style={{\r\n          width: '100%',\r\n          height: `3px`,\r\n          marginTop: '0.5rem',\r\n          backgroundColor: `rgb(${item.color})`,\r\n        }}\r\n      ></div>\r\n    </li>\r\n  ))\r\n\r\n  return (\r\n    <div>\r\n      <h4\r\n        style={{\r\n          textAlign: 'left',\r\n          fontWeight: 'bold',\r\n          margin: '1rem 0 0.25rem 0',\r\n          fontSize: '0.8rem',\r\n        }}\r\n      >\r\n        {props.title}\r\n      </h4>\r\n      <p>{props.description}</p>\r\n      <ul style={{ listStyle: 'none', padding: 0, margin: 0 }}>{listItems}</ul>\r\n    </div>\r\n  )\r\n}\r\n","\r\n.gl-app(:class=\"{'hide-thumbnail': !thumbnail}\"\r\n        :style='{\"background\": urlThumbnail}' oncontextmenu=\"return false\")\r\n\r\n  trip-viz.anim(v-if=\"!thumbnail\"\r\n                :center = \"vizDetails.center\"\r\n                :colors = \"COLOR_OCCUPANCY\"\r\n                :drtRequests = \"$options.drtRequests\"\r\n                :dark = \"globalState.isDarkMode\"\r\n                :paths = \"$options.paths\"\r\n                :settingsShowLayers = \"SETTINGS\"\r\n                :searchEnabled = \"searchEnabled\"\r\n                :simulationTime = \"simulationTime\"\r\n                :traces = \"$options.traces\"\r\n                :vehicleLookup = \"vehicleLookup\"\r\n                :viewId = \"viewId\"\r\n                :onClick = \"handleClick\")\r\n\r\n  zoom-buttons(v-if=\"!thumbnail\")\r\n\r\n  //- isLoaded && !thumbnail\")\r\n  .right-side(v-if=\"isLoaded && !thumbnail\")\r\n    collapsible-panel(direction=\"right\")\r\n      .big.clock\r\n        p {{ myState.clock }}\r\n\r\n      .panel-items\r\n        legend-colors.legend-block(v-if=\"legendItems.length\"\r\n          :title=\"`${$t('passengers')}:`\" :items=\"legendItems\")\r\n\r\n        legend-colors.legend-block(:title=\"`${$t('requests')}:`\" :items=\"legendRequests\")\r\n\r\n        .search-panel\r\n          p.speed-label(:style=\"{margin: '1rem 0 0 0'}\") {{ $t('search') }}\r\n          form(autocomplete=\"off\")\r\n          .field\r\n            p.control.has-icons-left\r\n              input.input.is-small(type=\"email\" :placeholder=\"`${$t('search')}...`\" v-model=\"searchTerm\")\r\n              span.icon.is-small.is-left\r\n                i.fas.fa-search\r\n\r\n        settings-panel.settings-area(:items=\"SETTINGS\" @click=\"handleSettingChange\")\r\n\r\n        .speed-block\r\n          p.speed-label {{ $t('speed') }}:\r\n            br\r\n            | {{ speed }}x\r\n\r\n          b-slider.speed-slider(v-model=\"speed\"\r\n            :min=\"speedStops[0]\"\r\n            :max=\"speedStops[speedStops.length-1]\"\r\n            :duration=\"0\"\r\n            :dotSize=\"20\"\r\n            :tooltip=\"true\"\r\n            tooltip-placement=\"bottom\"\r\n            :tooltip-formatter=\"val => val + 'x'\"\r\n          )\r\n            template(v-for=\"val in speedStops\")\r\n              b-slider-tick(:value=\"val\" :key=\"val\")\r\n\r\n  playback-controls.bottom-area(v-if=\"!thumbnail && isLoaded\"\r\n      @click='toggleSimulation'\r\n      @time='setTime'\r\n      :timeStart = \"timeStart\"\r\n      :timeEnd = \"timeEnd\"\r\n      :isRunning = \"myState.isRunning\"\r\n      :currentTime = \"simulationTime\")\r\n\r\n","<template lang=\"pug\">\r\n.my-component(:class=\"{'hide-thumbnail': !thumbnail}\" oncontextmenu=\"return false\")\r\n\r\n  img.thumb(v-if=\"thumbnail\" src=\"./assets/table.png\" :width=\"128\")\r\n\r\n\r\n  .topsheet(v-if=\"!thumbnail && isLoaded\")\r\n      p.header {{ subfolder }}\r\n\r\n      h2 {{ vizDetails.title }}\r\n      p {{ vizDetails.description}}\r\n\r\n      hr\r\n\r\n      component.dash-card(\r\n        is=\"TopSheet\"\r\n        :fileSystemConfig=\"fileSystem\"\r\n        :subfolder=\"subfolder\"\r\n        :config=\"vizDetails\"\r\n        :yaml=\"yamlConfig\"\r\n        :files=\"files\"\r\n        :cardTitle=\"vizDetails.title\"\r\n        :cardId=\"'table1'\"\r\n        :allConfigFiles=\"allConfigFiles\"\r\n      )\r\n\r\n      //- @isLoaded=\"handleCardIsLoaded(card)\"\r\n      //- @dimension-resizer=\"setDimensionResizer\"\r\n      //- @titles=\"setCardTitles(card, $event)\"\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport YAML from 'yaml'\r\n\r\nimport util from '@/js/util'\r\nimport globalStore from '@/store'\r\n\r\nimport { ColorScheme, FileSystemConfig, VisualizationPlugin, Status, YamlConfigs } from '@/Globals'\r\n\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\nimport TopSheet from '@/components/TopSheet/TopSheet.vue'\r\n\r\nconst thumbnailUrl = \"url('assets/thumbnail.jpg') no-repeat;\"\r\n\r\nconst Component = defineComponent({\r\n  name: 'CalculationTable',\r\n  components: { TopSheet },\r\n  props: {\r\n    root: { type: String, required: true },\r\n    subfolder: { type: String, required: true },\r\n    yamlConfig: String,\r\n    config: Object,\r\n    thumbnail: Boolean,\r\n  },\r\n  data: () => {\r\n    return {\r\n      globalState: globalStore.state,\r\n      allConfigFiles: { dashboards: {}, topsheets: {}, vizes: {}, configs: {} } as YamlConfigs,\r\n      files: [] as string[],\r\n      isLoaded: false,\r\n      vizDetails: {\r\n        title: '',\r\n        description: '',\r\n        thumbnail: '',\r\n      },\r\n    }\r\n  },\r\n  computed: {\r\n    fileApi(): HTTPFileSystem {\r\n      return new HTTPFileSystem(this.fileSystem, globalStore)\r\n    },\r\n    fileSystem(): FileSystemConfig {\r\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === this.root\r\n      )\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n      return svnProject[0]\r\n    },\r\n\r\n    urlThumbnail(): any {\r\n      return thumbnailUrl\r\n    },\r\n  },\r\n  methods: {\r\n    async getVizDetails() {\r\n      if (!this.fileApi) return\r\n\r\n      console.log(this.yamlConfig)\r\n      // first get config\r\n      try {\r\n        const text = await this.fileApi.getFileText(this.subfolder + '/' + this.yamlConfig)\r\n        this.vizDetails = YAML.parse(text)\r\n      } catch (e) {\r\n        console.error('failed')\r\n      }\r\n      const t = this.vizDetails.title ? this.vizDetails.title : 'Table'\r\n      this.$emit('title', t)\r\n    },\r\n  },\r\n  async mounted() {\r\n    await this.getVizDetails()\r\n    this.allConfigFiles = await this.fileApi.findAllYamlConfigs(this.subfolder)\r\n    const { files } = await this.fileApi.getDirectory(this.subfolder)\r\n    this.files = files\r\n\r\n    this.isLoaded = true\r\n\r\n    if (this.thumbnail) return\r\n  },\r\n})\r\n\r\n// !register plugin!\r\nglobalStore.commit('registerPlugin', {\r\n  kebabName: 'summary',\r\n  prettyName: 'Summary Table',\r\n  description: 'Calculation table',\r\n  filePatterns: ['(topsheet|table)*.y?(a)ml'],\r\n  component: Component,\r\n} as VisualizationPlugin)\r\n\r\nexport default Component\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.my-component {\r\n  margin: 0 0;\r\n  padding: 0 2rem;\r\n  background-color: var(--bgMapPanel);\r\n}\r\n\r\n.header {\r\n  margin-top: 0.5rem;\r\n  margin-bottom: 2rem;\r\n  color: var(--text);\r\n}\r\n\r\n.topsheet {\r\n  max-width: 55rem;\r\n  margin: 0rem auto;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n}\r\n</style>\r\n","\r\n.my-component(:class=\"{'hide-thumbnail': !thumbnail}\" oncontextmenu=\"return false\")\r\n\r\n  img.thumb(v-if=\"thumbnail\" src=\"./assets/table.png\" :width=\"128\")\r\n\r\n\r\n  .topsheet(v-if=\"!thumbnail && isLoaded\")\r\n      p.header {{ subfolder }}\r\n\r\n      h2 {{ vizDetails.title }}\r\n      p {{ vizDetails.description}}\r\n\r\n      hr\r\n\r\n      component.dash-card(\r\n        is=\"TopSheet\"\r\n        :fileSystemConfig=\"fileSystem\"\r\n        :subfolder=\"subfolder\"\r\n        :config=\"vizDetails\"\r\n        :yaml=\"yamlConfig\"\r\n        :files=\"files\"\r\n        :cardTitle=\"vizDetails.title\"\r\n        :cardId=\"'table1'\"\r\n        :allConfigFiles=\"allConfigFiles\"\r\n      )\r\n\r\n      //- @isLoaded=\"handleCardIsLoaded(card)\"\r\n      //- @dimension-resizer=\"setDimensionResizer\"\r\n      //- @titles=\"setCardTitles(card, $event)\"\r\n\r\n","export default \"__VITE_ASSET__439da6cc__\"","<template lang=\"pug\">\r\n.video-plugin-container(:class=\"{thumbnail}\")\r\n  h3(v-if=\"!thumbnail\") {{ title }}\r\n\r\n  .vid-container\r\n    video(:controls=\"controls\" :loop='loop' :allowfullscreen='allowfullscreen' :autoplay=\"autoplay\" :muted=\"muted\")\r\n      source(v-for=\"(src, type) in sources\" :src=\"src\" :type=\"type\" :key=\"type\")\r\n      p(v-for=\"(src, type) in sources\" :key=\"type\") Video tag not supported. Download the video&nbsp;\r\n        a(:href=\"src\" target=\"_blank\") here\r\n\r\n    //- video-player.vjs-default-skin.vjs-big-play-centered(\r\n    //-   ref=\"videoPlayer\"\r\n    //-   :options=\"playerOptions\"\r\n    //- )\r\n    //- v-if=\"movieSource\"\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\n\r\n// import { videoPlayer } from 'vue-video-player'\r\n\r\nimport globalStore from '@/store'\r\nimport { FileSystem, FileSystemConfig, VisualizationPlugin } from '@/Globals'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\n\r\n// import '~/video.js/dist/video-js.min.css'\r\n\r\nconst MyComponent = defineComponent({\r\n  name: 'VideoPlayerPlugin',\r\n  props: {\r\n    root: { type: String, required: true },\r\n    subfolder: { type: String, required: true },\r\n    yamlConfig: String,\r\n    config: Object,\r\n    thumbnail: Boolean,\r\n  },\r\n\r\n  data: () => {\r\n    return {\r\n      movieSource: '',\r\n      title: '',\r\n      myState: {} as any,\r\n      fileApi: null as FileSystemConfig | null,\r\n      playerOptions: {\r\n        muted: false,\r\n        language: 'en',\r\n        playbackRates: [0.5, 1.0, 1.5, 2.0, 5.0],\r\n        preload: 'metadata',\r\n        responsive: true,\r\n        fluid: false,\r\n        playsInline: true,\r\n        controls: true,\r\n        sources: [] as any[],\r\n      },\r\n    }\r\n  },\r\n\r\n  beforeDestroy() {\r\n    if (!this.thumbnail) globalStore.commit('setFullScreen', false)\r\n  },\r\n\r\n  mounted() {\r\n    this.fileApi = this.getFileSystem(this.root)\r\n\r\n    this.myState = {\r\n      subfolder: this.subfolder,\r\n      yamlConfig: this.yamlConfig,\r\n      thumbnail: this.thumbnail,\r\n      imageData: '',\r\n    }\r\n\r\n    this.playerOptions.fluid = !!this.thumbnail\r\n    if (!this.thumbnail) globalStore.commit('setFullScreen', true)\r\n\r\n    if (!this.yamlConfig) {\r\n      this.buildRouteFromUrl()\r\n    } else {\r\n      this.myState.subfolder = this.subfolder\r\n      this.myState.yamlConfig = this.yamlConfig\r\n      this.buildMovieSource()\r\n    }\r\n\r\n    this.getVizDetails()\r\n  },\r\n  watch: {\r\n    yamlConfig() {\r\n      this.myState.yamlConfig = this.yamlConfig\r\n      this.getVizDetails()\r\n    },\r\n\r\n    subfolder() {\r\n      this.myState.subfolder = this.subfolder\r\n      this.getVizDetails()\r\n    },\r\n  },\r\n  methods: {\r\n    buildMovieSource() {\r\n      this.movieSource = `${this.fileApi?.baseURL}/${this.myState.subfolder}/${this.myState.yamlConfig}`\r\n\r\n      this.playerOptions.sources.push({\r\n        type: 'video/mp4',\r\n        src: this.movieSource,\r\n      })\r\n    },\r\n\r\n    getFileSystem(name: string) {\r\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === name\r\n      )\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n      return svnProject[0]\r\n    },\r\n\r\n    // this happens if viz is the full page, not a thumbnail on a project page\r\n    async buildRouteFromUrl() {\r\n      const params = this.$route.params\r\n      if (!params.project || !params.pathMatch) {\r\n        console.log('I CANT EVEN: NO PROJECT/PARHMATCH')\r\n        return\r\n      }\r\n\r\n      // project filesystem\r\n      this.fileApi = this.getFileSystem(params.project)\r\n\r\n      // subfolder and config file\r\n      const sep = 1 + params.pathMatch.lastIndexOf('/')\r\n      const subfolder = params.pathMatch.substring(0, sep)\r\n      const config = params.pathMatch.substring(sep)\r\n\r\n      this.myState.subfolder = subfolder\r\n      this.myState.yamlConfig = config\r\n\r\n      this.buildMovieSource()\r\n    },\r\n\r\n    async generateBreadcrumbs() {\r\n      const filesystem = this.getFileSystem(this.$route.params.project)\r\n      if (!filesystem) return []\r\n\r\n      const crumbs = [\r\n        {\r\n          label: filesystem.name,\r\n          url: '/' + filesystem.slug,\r\n        },\r\n      ]\r\n\r\n      const subfolders = this.myState.subfolder.split('/')\r\n      let buildFolder = '/'\r\n      for (const folder of subfolders) {\r\n        if (!folder) continue\r\n\r\n        buildFolder += folder + '/'\r\n        crumbs.push({\r\n          label: folder,\r\n          url: '/' + filesystem.slug + buildFolder,\r\n        })\r\n      }\r\n\r\n      // save them!\r\n      globalStore.commit('setBreadCrumbs', crumbs)\r\n\r\n      return crumbs\r\n    },\r\n\r\n    async getVizDetails() {\r\n      this.title = this.myState.yamlConfig.replace(/_/g, ' ')\r\n      this.title = this.title.substring(0, this.title.lastIndexOf('.'))\r\n\r\n      if (this.title) {\r\n        this.$emit('title', this.title)\r\n      }\r\n    },\r\n  },\r\n})\r\n\r\n// !register plugin!\r\nglobalStore.commit('registerPlugin', {\r\n  kebabName: 'vid-player',\r\n  prettyName: 'Video',\r\n  description: '',\r\n  filePatterns: ['*.mp4'],\r\n  component: MyComponent,\r\n} as VisualizationPlugin)\r\n\r\nexport default MyComponent\r\n</script>\r\n\r\n<style>\r\n.video-js {\r\n  position: absolute;\r\n  width: 100%;\r\n  height: auto;\r\n  top: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  margin: auto 0;\r\n  background-color: #223;\r\n}\r\n</style>\r\n\r\n<style scoped lang=\"scss\">\r\n.video-plugin-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  background-color: #223;\r\n  padding: 0 20px 20px 20px;\r\n  position: relative;\r\n}\r\n\r\n.thumbnail {\r\n  height: 11rem;\r\n  // z-index: -1;\r\n  padding: 0 0;\r\n}\r\n\r\n.vid-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n}\r\n\r\n.thumbnail .vid-container {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  overflow: hidden;\r\n}\r\n\r\nh3 {\r\n  color: #ccc;\r\n  padding: 0.5rem 0;\r\n  text-align: center;\r\n}\r\n</style>\r\n","\r\n.video-plugin-container(:class=\"{thumbnail}\")\r\n  h3(v-if=\"!thumbnail\") {{ title }}\r\n\r\n  .vid-container\r\n    video(:controls=\"controls\" :loop='loop' :allowfullscreen='allowfullscreen' :autoplay=\"autoplay\" :muted=\"muted\")\r\n      source(v-for=\"(src, type) in sources\" :src=\"src\" :type=\"type\" :key=\"type\")\r\n      p(v-for=\"(src, type) in sources\" :key=\"type\") Video tag not supported. Download the video&nbsp;\r\n        a(:href=\"src\" target=\"_blank\") here\r\n\r\n    //- video-player.vjs-default-skin.vjs-big-play-centered(\r\n    //-   ref=\"videoPlayer\"\r\n    //-   :options=\"playerOptions\"\r\n    //- )\r\n    //- v-if=\"movieSource\"\r\n\r\n","<template lang=\"pug\">\r\n.image-container(v-if=\"myState.yamlConfig\" :class=\"{'zthumbnail' : thumbnail }\")\r\n  img.medium-zoom(\r\n    :src=\"myState.imageData\"\r\n    :class=\"{'invert-colors' : isDarkMode }\")\r\n</template>\r\n\r\n<script lang=\"ts\">\r\n'use strict'\r\n\r\nimport { defineComponent } from 'vue'\r\nimport type { PropType } from 'vue'\r\n\r\n// import mediumZoom from 'medium-zoom'\r\nimport readBlob from 'read-blob'\r\n\r\nimport globalStore from '@/store'\r\nimport { ColorScheme, FileSystem, FileSystemConfig, VisualizationPlugin } from '@/Globals'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\n\r\nconst MyComponent = defineComponent({\r\n  name: 'ImageViewPlugin',\r\n  props: {\r\n    fileApi: { type: Object as PropType<FileSystem>, required: true },\r\n    subfolder: { type: String, required: true },\r\n    yamlConfig: String,\r\n    thumbnail: Boolean,\r\n  },\r\n  data: () => {\r\n    return {\r\n      globalState: globalStore.state,\r\n      myState: {} as any,\r\n      matsimPngTitles: {\r\n        'modestats.png': 'Mode statistics',\r\n        'ph_modestats.png': 'Passenger hours traveled per mode',\r\n        'pkm_modestats.png': 'Passenger km traveled per mode',\r\n        'scorestats.png': 'Score statistics',\r\n        'stopwatch.png': 'Stopwatch: computation time',\r\n        'traveldistancestatslegs.png': 'Leg travel distance',\r\n        'traveldistancestatstrips.png': 'Trip travel distance',\r\n      } as { [id: string]: string },\r\n    }\r\n  },\r\n  computed: {\r\n    isDarkMode(): boolean {\r\n      return this.globalState.isDarkMode\r\n    },\r\n  },\r\n  methods: {\r\n    // this happens if viz is the full page, not a thumbnail on a project page\r\n    buildRouteFromUrl() {\r\n      const params = this.$route.params\r\n      if (!params.project || !params.pathMatch) {\r\n        console.log('I CANT EVEN: NO PROJECT/PARHMATCH')\r\n        return\r\n      }\r\n\r\n      // subfolder and config file\r\n      const sep = 1 + params.pathMatch.lastIndexOf('/')\r\n      const subfolder = params.pathMatch.substring(0, sep)\r\n      const config = params.pathMatch.substring(sep)\r\n\r\n      this.myState.subfolder = subfolder\r\n      this.myState.yamlConfig = config\r\n    },\r\n\r\n    async getVizDetails() {\r\n      try {\r\n        const blob = await this.myState.fileApi.getFileBlob(\r\n          this.myState.subfolder + '/' + this.myState.yamlConfig\r\n        )\r\n\r\n        if (!blob) {\r\n          console.log('no blob! :-(')\r\n          return\r\n        }\r\n\r\n        const dataUrl = await readBlob.dataurl(blob)\r\n        this.myState.imageData = dataUrl\r\n\r\n        const config = this.yamlConfig as any\r\n        const newTitle = this.matsimPngTitles[config]\r\n          ? this.matsimPngTitles[config]\r\n          : this.yamlConfig\r\n\r\n        this.$emit('title', newTitle)\r\n      } catch (e) {\r\n        console.error({ e })\r\n        return null\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    yamlConfig() {\r\n      this.myState.yamlConfig = this.yamlConfig\r\n      this.getVizDetails()\r\n    },\r\n\r\n    subfolder() {\r\n      this.myState.subfolder = this.subfolder\r\n      this.getVizDetails()\r\n    },\r\n  },\r\n  mounted() {\r\n    this.myState = {\r\n      fileApi: this.fileApi,\r\n      subfolder: this.subfolder,\r\n      yamlConfig: this.yamlConfig,\r\n      thumbnail: this.thumbnail,\r\n      imageData: '',\r\n    }\r\n\r\n    if (!this.yamlConfig) {\r\n      this.buildRouteFromUrl()\r\n    }\r\n\r\n    this.getVizDetails()\r\n  },\r\n})\r\n\r\n// !register plugin!\r\nglobalStore.commit('registerPlugin', {\r\n  kebabName: 'image-view',\r\n  prettyName: 'Image',\r\n  description: '',\r\n  filePatterns: ['!(*thumbnail*).(png|jpg)'], // skip thumbnails!\r\n  component: MyComponent,\r\n} as VisualizationPlugin)\r\n\r\nexport default MyComponent\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.image-container.zthumbnail {\r\n  max-height: $thumbnailHeight;\r\n  overflow: hidden;\r\n}\r\n\r\n.medium-zoom {\r\n  padding: 0.25rem 0.25rem;\r\n}\r\n\r\n// .invert-colors {\r\n//   filter: invert(100%);\r\n// }\r\n</style>\r\n","\r\n.image-container(v-if=\"myState.yamlConfig\" :class=\"{'zthumbnail' : thumbnail }\")\r\n  img.medium-zoom(\r\n    :src=\"myState.imageData\"\r\n    :class=\"{'invert-colors' : isDarkMode }\")\r\n","import { ScatterplotLayer } from '@deck.gl/layers'\r\n\r\nexport default class ScatterplotColorBinsLayer extends ScatterplotLayer {\r\n  public initializeState(context: any) {\r\n    super.initializeState(context)\r\n\r\n    this.getAttributeManager().addInstanced({\r\n      instanceValue: {\r\n        accessor: 'getValue',\r\n        size: 1,\r\n        defaultValue: 0.0,\r\n        transition: true,\r\n      },\r\n    })\r\n  }\r\n\r\n  public getShaders() {\r\n    return {\r\n      ...super.getShaders(),\r\n      inject: {\r\n        'vs:#decl': `\r\n            #define MAX_COLORS 21\r\n            #define MAX_BREAKPOINTS 20\r\n            uniform int numBreakpoints;\r\n            uniform vec3 colors[MAX_COLORS];\r\n            uniform float breakpoints[MAX_BREAKPOINTS];\r\n            attribute float instanceValue;\r\n            `,\r\n        'vs:DECKGL_FILTER_COLOR': `\r\n            // geometry.pickingColor = instancePickingColors;\r\n            picking_setPickingColor(geometry.pickingColor);\r\n\r\n            int lastBreakpoint = numBreakpoints;\r\n\r\n            for(int i=0; i < MAX_BREAKPOINTS; ++i) {\r\n              if (instanceValue < breakpoints[i]) {\r\n                color = vec4(colors[i], 1.0);\r\n                return;\r\n              }\r\n              if (i == lastBreakpoint) {\r\n                color = vec4(colors[i], 1.0);\r\n                return;\r\n              }\r\n            }\r\n            color = vec4(1.0, 0.0, 0.0, 1.0);\r\n            return;\r\n          `,\r\n      },\r\n    }\r\n  }\r\n\r\n  // uniform cannot change size, so we pre-allocate the\r\n  // max storage for colors and breakpoints here.\r\n  private MAX_COLORS = 21\r\n  private uniformColors = new Array(this.MAX_COLORS * 3)\r\n  private uniformBreakpoints = new Array(this.MAX_COLORS - 1)\r\n\r\n  draw({ uniforms }: any) {\r\n    const { colors, breakpoints } = this.props\r\n\r\n    colors.map((c: number[], i: number) => {\r\n      this.uniformColors[i * 3] = c[0] / 256\r\n      this.uniformColors[i * 3 + 1] = c[1] / 256\r\n      this.uniformColors[i * 3 + 2] = c[2] / 256\r\n    })\r\n\r\n    breakpoints.map((c: number, i: number) => {\r\n      this.uniformBreakpoints[i] = c\r\n    })\r\n\r\n    const combinedUniforms = {\r\n      ...uniforms,\r\n      colors: this.uniformColors,\r\n      breakpoints: this.uniformBreakpoints,\r\n      numBreakpoints: breakpoints.length,\r\n    }\r\n\r\n    super.draw({\r\n      uniforms: combinedUniforms,\r\n    })\r\n  }\r\n}\r\n\r\nScatterplotColorBinsLayer.layerName = 'ScatterplotColorBinsLayer'\r\nScatterplotColorBinsLayer.defaultProps = {\r\n  colors: [\r\n    [128, 128, 128],\r\n    [128, 128, 128],\r\n  ],\r\n  breakpoints: [0.0],\r\n}\r\n","import React, { useState, useMemo, useEffect } from 'react'\r\nimport DeckGL from '@deck.gl/react'\r\nimport { StaticMap } from 'react-map-gl'\r\nimport { DataFilterExtension } from '@deck.gl/extensions'\r\nimport * as timeConvert from 'convert-seconds'\r\n\r\nimport { REACT_VIEW_HANDLES, MAPBOX_TOKEN } from '@/Globals'\r\nimport ScatterplotColorBinsLayer from '@/plugins/xy-time/ScatterplotColorBinsLayer'\r\nimport globalStore from '@/store'\r\n\r\nconst dataFilter = new DataFilterExtension({ filterSize: 1 })\r\n\r\nfunction convertSecondsToClockTimeMinutes(index: number) {\r\n  const seconds = index\r\n\r\n  try {\r\n    const hms = timeConvert(seconds)\r\n    const minutes = ('00' + hms.minutes).slice(-2)\r\n    return `${hms.hours}:${minutes}`\r\n  } catch (e) {\r\n    return '00:00'\r\n  }\r\n}\r\n\r\nconst INITIAL_VIEW = {\r\n  pitch: 0,\r\n  zoom: 11,\r\n  bearing: 0,\r\n  longitude: 13.38,\r\n  latitude: 52.5,\r\n}\r\n\r\n// -------------------------------------------------------------------\r\nexport default function Component({\r\n  viewId = 0,\r\n  pointLayers = [] as {\r\n    coordinates: Float32Array\r\n    time: Float32Array\r\n    color: Uint8Array\r\n    value: Float32Array\r\n    timeRange: number[]\r\n  }[],\r\n  timeFilter = [] as number[],\r\n  dark = false,\r\n  colors = [\r\n    [1, 0, 0],\r\n    [0.25, 0.25, 1],\r\n  ] as number[][],\r\n  breakpoints = [0.0] as number[],\r\n  radius = 5,\r\n  mapIsIndependent = false,\r\n}) {\r\n  // manage SimWrapper centralized viewState - for linked maps\r\n  const [viewState, setViewState] = useState(INITIAL_VIEW)\r\n\r\n  REACT_VIEW_HANDLES[viewId] = () => {\r\n    setViewState(globalStore.state.viewState)\r\n  }\r\n\r\n  function handleViewState(view: any) {\r\n    if (!view.latitude) return\r\n\r\n    if (!view.center) view.center = [0, 0]\r\n    view.center[0] = view.longitude\r\n    view.center[1] = view.latitude\r\n    setViewState(view)\r\n\r\n    if (!mapIsIndependent) globalStore.commit('setMapCamera', view)\r\n  }\r\n\r\n  function getTooltip(element: any) {\r\n    // console.log(element)\r\n    if (element.index < 0) return null\r\n\r\n    const layerId = element?.layer?.id\r\n    if (layerId === undefined) return null\r\n\r\n    const time = pointLayers[layerId].time[element.index]\r\n    const humanTime = convertSecondsToClockTimeMinutes(time)\r\n\r\n    const value = pointLayers[layerId].value[element.index]\r\n    const cleanValue = Math.round(1e6 * value) / 1e6\r\n    return {\r\n      html: `\\\r\n        <table style=\"font-size: 0.9rem\">\r\n        <tr>\r\n          <td>Value</td>\r\n          <td style=\"padding-left: 0.5rem;\"><b>${cleanValue}</b></td>\r\n        </tr><tr>\r\n          <td style=\"text-align: right;\">Time</td>\r\n          <td style=\"padding-left: 0.5rem;\"><b>${humanTime}</b></td>\r\n        </tr>\r\n        </table>\r\n      `,\r\n      style: dark\r\n        ? { color: '#ccc', backgroundColor: '#2a3c4f' }\r\n        : { color: '#223', backgroundColor: 'white' },\r\n    }\r\n  }\r\n\r\n  // add a scatterplotlayer for each set of points in pointLayers\r\n  const layers = pointLayers.map((points, layerIndex) => {\r\n    // The entire layer can be hidden if all of its points\r\n    // are beyond the timeFilter range that is being shown.\r\n    const outOfRange = points.timeRange[0] > timeFilter[1] || points.timeRange[1] < timeFilter[0]\r\n\r\n    //@ts-ignore\r\n    return new ScatterplotColorBinsLayer({\r\n      data: {\r\n        length: points.time.length,\r\n        attributes: {\r\n          getPosition: { value: points.coordinates, size: 2 },\r\n          getFilterValue: { value: points.time, size: 1 },\r\n          getValue: { value: points.value, size: 1 },\r\n        },\r\n      },\r\n      autoHighlight: true,\r\n      breakpoints: breakpoints,\r\n      colors: colors,\r\n      extensions: [dataFilter],\r\n      id: layerIndex,\r\n      filled: true,\r\n      filterRange: timeFilter.length ? timeFilter : null,\r\n      getRadius: radius, // 5 // (d: any) => Math.sqrt(d...),\r\n      // getFillColor: [10, 50, 10],\r\n      highlightColor: [255, 0, 224],\r\n      opacity: 1,\r\n      parameters: { depthTest: false },\r\n      pickable: true,\r\n      radiusScale: 1,\r\n      stroked: false,\r\n      updateTriggers: {\r\n        getPosition: pointLayers,\r\n        getFillColor: pointLayers,\r\n        getFilterValue: timeFilter,\r\n      },\r\n      // transitions: {\r\n      //   getFillColor: 500,\r\n      //   getColor: 500,\r\n      //   getValue: 500,\r\n      //   getFilterValue: 500,\r\n      // },\r\n      // hide layers that are entirely outside the time window filter:\r\n      visible: !outOfRange,\r\n    })\r\n  })\r\n\r\n  // initialViewState={initialViewState}\r\n  return (\r\n    <DeckGL\r\n      layers={layers}\r\n      controller={true}\r\n      useDevicePixels={true}\r\n      viewState={viewState}\r\n      onViewStateChange={(e: any) => handleViewState(e.viewState)}\r\n      pickingRadius={4}\r\n      onClick={getTooltip}\r\n      getTooltip={getTooltip}\r\n    >\r\n      {\r\n        /*\r\n        // @ts-ignore */\r\n        <StaticMap\r\n          mapStyle={globalStore.getters.mapStyle}\r\n          preventStyleDiffing={true}\r\n          mapboxApiAccessToken={MAPBOX_TOKEN}\r\n        />\r\n      }\r\n    </DeckGL>\r\n  )\r\n}\r\n","<template lang=\"pug\">\r\n.viz-plugin(:class=\"{'hide-thumbnail': !thumbnail}\" oncontextmenu=\"return false\" :id=\"`id-${viewId}`\")\r\n\r\n  xy-time-deck-map.map-layer(v-if=\"!thumbnail\"\r\n    :viewId=\"viewId\"\r\n    :pointLayers=\"pointLayers\"\r\n    :timeFilter=\"timeFilter\"\r\n    :dark=\"this.$store.state.isDarkMode\"\r\n    :colors=\"this.colors\"\r\n    :breakpoints=\"this.breakpoints\"\r\n    :radius=\"this.guiConfig.radius\"\r\n    :mapIsIndependent=\"false\"\r\n  )\r\n\r\n  zoom-buttons(v-if=\"!thumbnail\" corner=\"bottom\")\r\n\r\n  .top-right\r\n    .gui-config(:id=\"configId\")\r\n\r\n  .bottom-right\r\n    .legend-area(v-if=\"legendStore\")\r\n      legend-box(:legendStore=\"legendStore\")\r\n\r\n  time-slider.time-slider-area(v-if=\"isLoaded\"\r\n    :range=\"timeRange\"\r\n    :activeTimeExtent=\"timeFilter\"\r\n    :labels=\"timeLabels\"\r\n    :isAnimating=\"isAnimating\"\r\n    @timeExtent=\"handleTimeSliderValues\"\r\n    @toggleAnimation=\"toggleAnimation\"\r\n    @drag=\"isAnimating=false\"\r\n  )\r\n\r\n  .message(v-if=\"!thumbnail && myState.statusMessage\")\r\n    p.status-message {{ myState.statusMessage }}\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      loading: 'Loading data...',\r\n      sorting: 'Sorting into bins...',\r\n      aggregate: 'Summary',\r\n      maxHeight: '3D Height',\r\n      showDetails: 'Show Details',\r\n      selection: 'Selection',\r\n      areas: 'Areas',\r\n      count: 'Count',\r\n      promptCRS: `Enter the coordinate reference system, e.g. EPSG:25832\\n\\nThese coordinates are not in long/lat format. To fix this permanently, convert them to long/lat or add \"# EPSG:xxxx\" to your CSV header`,\r\n    },\r\n    de: {\r\n      loading: 'Dateien laden...',\r\n      sorting: 'Sortieren...',\r\n      aggregate: 'Daten',\r\n      maxHeight: '3-D Höhe',\r\n      showDetails: 'Details anzeigen',\r\n      selection: 'Ausgewählt',\r\n      areas: 'Orte',\r\n      count: 'Anzahl',\r\n    },\r\n  },\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\n\r\nimport GUI from 'lil-gui'\r\nimport YAML from 'yaml'\r\nimport colormap from 'colormap'\r\n\r\nimport util from '@/js/util'\r\nimport globalStore from '@/store'\r\nimport CollapsiblePanel from '@/components/CollapsiblePanel.vue'\r\nimport DrawingTool from '@/components/DrawingTool/DrawingTool.vue'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\nimport LegendBox from '@/components/viz-configurator/LegendBox.vue'\r\nimport LegendStore from '@/js/LegendStore'\r\nimport TimeSlider from '@/components/TimeSlider.vue'\r\nimport XyTimeDeckMap from './XyTimeDeckMap'\r\nimport XytDataParser from './XytDataParser.worker.ts?worker'\r\nimport ZoomButtons from '@/components/ZoomButtons.vue'\r\n\r\nimport {\r\n  ColorScheme,\r\n  FileSystem,\r\n  LegendItem,\r\n  LegendItemType,\r\n  FileSystemConfig,\r\n  VisualizationPlugin,\r\n  Status,\r\n  REACT_VIEW_HANDLES,\r\n} from '@/Globals'\r\n\r\ninterface VizDetail {\r\n  title: string\r\n  description?: string\r\n  file: string\r\n  projection: any\r\n  thumbnail?: string\r\n  center: any\r\n  zoom: number\r\n}\r\n\r\ninterface PointLayer {\r\n  color: Uint8Array\r\n  value: Float32Array\r\n  coordinates: Float32Array\r\n  time: Float32Array\r\n  timeRange: number[]\r\n}\r\n\r\nconst MyComponent = defineComponent({\r\n  name: 'XYTime',\r\n  i18n,\r\n  components: {\r\n    CollapsiblePanel,\r\n    DrawingTool,\r\n    LegendBox,\r\n    TimeSlider,\r\n    ZoomButtons,\r\n    XyTimeDeckMap,\r\n  },\r\n  props: {\r\n    root: { type: String, required: true },\r\n    subfolder: { type: String, required: true },\r\n    yamlConfig: String,\r\n    config: Object,\r\n    thumbnail: Boolean,\r\n  },\r\n  data: () => {\r\n    return {\r\n      guiConfig: {\r\n        buckets: 7,\r\n        exponent: 4,\r\n        radius: 5,\r\n        'clip max': 100,\r\n        'color ramp': 'viridis',\r\n        colorRamps: ['bathymetry', 'electric', 'inferno', 'jet', 'magma', 'par', 'viridis'],\r\n        flip: false,\r\n      },\r\n      viewId: `xyt-id-${Math.floor(1e12 * Math.random())}` as any,\r\n      configId: `gui-config-${Math.floor(1e12 * Math.random())}` as any,\r\n      timeLabels: [0, 1] as any[],\r\n      startTime: 0,\r\n      isAnimating: false,\r\n      timeFilter: [0, 3599],\r\n      colors: [\r\n        [128, 128, 128],\r\n        [128, 128, 128],\r\n      ] as number[][],\r\n      breakpoints: [0.0],\r\n      range: [Infinity, -Infinity],\r\n      timeRange: [Infinity, -Infinity],\r\n      legendStore: null as LegendStore | null,\r\n      standaloneYAMLconfig: {\r\n        title: '',\r\n        description: '',\r\n        file: '',\r\n        projection: '',\r\n        thumbnail: '',\r\n        radius: 250,\r\n        maxHeight: 0,\r\n        center: null as any,\r\n        zoom: 9,\r\n      },\r\n      YAMLrequirementsXY: { file: '' },\r\n      columnLookup: [] as number[],\r\n      gzipWorker: null as Worker | null,\r\n      vizDetails: {\r\n        title: '',\r\n        description: '',\r\n        file: '',\r\n        projection: '',\r\n        thumbnail: '',\r\n        center: null as any,\r\n        zoom: 9,\r\n      } as VizDetail,\r\n      myState: {\r\n        statusMessage: '',\r\n        subfolder: '',\r\n        yamlConfig: '',\r\n        thumbnail: false,\r\n      },\r\n      pointLayers: [] as PointLayer[],\r\n      isLoaded: false,\r\n      animator: null as any,\r\n      guiController: null as GUI | null,\r\n      resizer: null as ResizeObserver | null,\r\n      thumbnailUrl: \"url('assets/thumbnail.jpg') no-repeat;\",\r\n      ANIMATE_SPEED: 4,\r\n      animationElapsedTime: 0,\r\n    }\r\n  },\r\n  async mounted() {\r\n    this.$store.commit('setFullScreen', !this.thumbnail)\r\n    this.myState.thumbnail = this.thumbnail\r\n    this.myState.yamlConfig = this.yamlConfig || ''\r\n    this.myState.subfolder = this.subfolder\r\n\r\n    await this.getVizDetails()\r\n    await this.buildThumbnail()\r\n\r\n    if (this.thumbnail) return\r\n\r\n    this.setupLogoMover()\r\n\r\n    // ----------------------------------------------------\r\n    this.setupGui()\r\n    this.myState.statusMessage = `${this.$i18n.t('loading')}`\r\n\r\n    if (!this.isLoaded) await this.loadFiles()\r\n  },\r\n  beforeDestroy() {\r\n    // MUST erase the React view handle to prevent gigantic memory leak!\r\n    REACT_VIEW_HANDLES[this.viewId] = undefined\r\n    delete REACT_VIEW_HANDLES[this.viewId]\r\n\r\n    try {\r\n      if (this.gzipWorker) {\r\n        this.gzipWorker.postMessage({ terminate: true })\r\n        this.gzipWorker.terminate()\r\n      }\r\n      if (this.guiController) this.guiController.destroy()\r\n    } catch (e) {\r\n      console.warn(e)\r\n    }\r\n\r\n    if (this.animator) window.cancelAnimationFrame(this.animator)\r\n\r\n    this.$store.commit('setFullScreen', false)\r\n  },\r\n\r\n  computed: {\r\n    fileApi(): HTTPFileSystem {\r\n      return new HTTPFileSystem(this.fileSystem, globalStore)\r\n    },\r\n    fileSystem(): FileSystemConfig {\r\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === this.root\r\n      )\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n      return svnProject[0]\r\n    },\r\n\r\n    urlThumbnail(): any {\r\n      return this.thumbnailUrl\r\n    },\r\n  },\r\n  watch: {\r\n    '$store.state.viewState'() {\r\n      if (REACT_VIEW_HANDLES[this.viewId]) REACT_VIEW_HANDLES[this.viewId]()\r\n    },\r\n  },\r\n  methods: {\r\n    handleTimeSliderValues(timeValues: any[]) {\r\n      this.animationElapsedTime = timeValues[0]\r\n      this.timeFilter = timeValues\r\n      this.timeLabels = [\r\n        this.convertSecondsToClockTimeMinutes(timeValues[0]),\r\n        this.convertSecondsToClockTimeMinutes(timeValues[1]),\r\n      ]\r\n    },\r\n\r\n    setupLogoMover() {\r\n      this.resizer = new ResizeObserver(this.moveLogo)\r\n      const deckmap = document.getElementById(`id-${this.viewId}`) as HTMLElement\r\n      this.resizer.observe(deckmap)\r\n    },\r\n\r\n    moveLogo() {\r\n      const deckmap = document.getElementById(`${this.viewId}`) as HTMLElement\r\n      const logo = deckmap?.querySelector('.mapboxgl-ctrl-bottom-left') as HTMLElement\r\n      if (logo) {\r\n        const right = deckmap.clientWidth > 640 ? '280px' : '36px'\r\n        logo.style.right = right\r\n      }\r\n    },\r\n\r\n    setupGui() {\r\n      this.guiController = new GUI({\r\n        title: 'Color Settings',\r\n        injectStyles: true,\r\n        width: 200,\r\n        container: document.getElementById(this.configId) || undefined,\r\n      })\r\n\r\n      const colors = this.guiController // .addFolder('Colors')\r\n      colors.add(this.guiConfig, 'buckets', 2, 19, 1).onChange(this.setColors)\r\n      colors.add(this.guiConfig, 'exponent', 1, 10, 1).onChange(this.setColors)\r\n      colors.add(this.guiConfig, 'clip max', 0, 100, 1).onChange(this.setColors)\r\n      colors.add(this.guiConfig, 'radius', 1, 20, 1)\r\n      colors.add(this.guiConfig, 'color ramp', this.guiConfig.colorRamps).onChange(this.setColors)\r\n      colors.add(this.guiConfig, 'flip').onChange(this.setColors)\r\n\r\n      // const times = this.guiController.addFolder('Time')\r\n    },\r\n    async solveProjection() {\r\n      if (this.thumbnail) return\r\n\r\n      console.log('WHAT PROJECTION:')\r\n\r\n      try {\r\n        const text = await this.fileApi.getFileText(\r\n          this.myState.subfolder + '/' + this.myState.yamlConfig\r\n        )\r\n        this.vizDetails = YAML.parse(text)\r\n      } catch (e) {\r\n        console.error(e)\r\n      }\r\n    },\r\n\r\n    async getVizDetails() {\r\n      if (this.config) {\r\n        this.validateYAML()\r\n        this.vizDetails = Object.assign({}, this.config) as VizDetail\r\n        return\r\n      }\r\n\r\n      const hasYaml = new RegExp('.*(yml|yaml)$').test(this.myState.yamlConfig)\r\n\r\n      if (hasYaml) {\r\n        await this.loadStandaloneYAMLConfig()\r\n      } else {\r\n        // console.log('NO YAML WTF')\r\n        this.setConfigForRawCSV()\r\n      }\r\n    },\r\n\r\n    setConfigForRawCSV() {\r\n      let projection = 'EPSG:4326' // Include \"# EPSG:xxx\" in header of CSV to set EPSG\r\n\r\n      // output_trips:\r\n      this.vizDetails = {\r\n        title: 'Point Data: ' + this.myState.yamlConfig,\r\n        description: this.myState.yamlConfig,\r\n        file: this.myState.yamlConfig,\r\n        projection,\r\n        center: this.vizDetails.center,\r\n        zoom: this.vizDetails.zoom,\r\n      }\r\n      this.$emit('title', this.vizDetails.title || this.vizDetails.file)\r\n      return\r\n    },\r\n\r\n    async loadStandaloneYAMLConfig() {\r\n      try {\r\n        // might be a project config:\r\n        const filename =\r\n          this.myState.yamlConfig.indexOf('/') > -1\r\n            ? this.myState.yamlConfig\r\n            : this.myState.subfolder + '/' + this.myState.yamlConfig\r\n\r\n        const text = await this.fileApi.getFileText(filename)\r\n        this.standaloneYAMLconfig = Object.assign({}, YAML.parse(text))\r\n        this.validateYAML()\r\n        this.setVizDetails()\r\n      } catch (err) {\r\n        const e = err as any\r\n        console.log('failed')\r\n\r\n        this.$store.commit('setStatus', {\r\n          type: Status.ERROR,\r\n          msg: `File not found`,\r\n          desc: `Could not find: ${this.myState.subfolder}/${this.myState.yamlConfig}`,\r\n        })\r\n      }\r\n    },\r\n\r\n    validateYAML() {\r\n      const hasYaml = new RegExp('.*(yml|yaml)$').test(this.myState.yamlConfig)\r\n      let configuration = {} as any\r\n\r\n      if (hasYaml) {\r\n        console.log('has yaml')\r\n        configuration = this.standaloneYAMLconfig\r\n      } else {\r\n        console.log('no yaml')\r\n        configuration = this.config\r\n      }\r\n\r\n      for (const key in this.YAMLrequirementsXY) {\r\n        if (key in configuration === false) {\r\n          this.$store.commit('setStatus', {\r\n            type: Status.ERROR,\r\n            msg: `YAML file missing required key: ${key}`,\r\n            desc: 'Check this.YAMLrequirementsXY for required keys',\r\n          })\r\n        }\r\n      }\r\n\r\n      if (configuration.radius == 0) {\r\n        this.$store.commit('setStatus', {\r\n          type: Status.WARNING,\r\n          msg: `Radius set to zero`,\r\n          desc: 'Radius can not be zero, preset value used instead. ',\r\n        })\r\n      }\r\n\r\n      if (configuration.zoom < 5 || configuration.zoom > 20) {\r\n        this.$store.commit('setStatus', {\r\n          type: Status.WARNING,\r\n          msg: `Zoom is out of the recommended range `,\r\n          desc: 'Zoom levels should be between 5 and 20. ',\r\n        })\r\n      }\r\n    },\r\n\r\n    setVizDetails() {\r\n      this.vizDetails = Object.assign({}, this.vizDetails, this.standaloneYAMLconfig)\r\n\r\n      const t = this.vizDetails.title\r\n        ? this.vizDetails.title\r\n        : 'Point Data: ' + this.vizDetails.file\r\n      this.$emit('title', t)\r\n    },\r\n\r\n    async buildThumbnail() {\r\n      if (this.thumbnail && this.vizDetails.thumbnail) {\r\n        try {\r\n          const blob = await this.fileApi.getFileBlob(\r\n            this.myState.subfolder + '/' + this.vizDetails.thumbnail\r\n          )\r\n          const buffer = await blob.arrayBuffer()\r\n          const base64 = util.arrayBufferToBase64(buffer)\r\n          if (base64)\r\n            this.thumbnailUrl = `center / cover no-repeat url(data:image/png;base64,${base64})`\r\n        } catch (e) {\r\n          console.error(e)\r\n        }\r\n      }\r\n    },\r\n\r\n    async parseCSVFile(filename: string) {\r\n      this.myState.statusMessage = 'Loading file...'\r\n\r\n      let totalRows = 0\r\n      // get the raw unzipped arraybuffer\r\n      this.gzipWorker = new XytDataParser()\r\n\r\n      this.gzipWorker.onmessage = async (event: MessageEvent) => {\r\n        if (event.data.status) {\r\n          this.myState.statusMessage = event.data.status\r\n        } else if (event.data.error) {\r\n          this.myState.statusMessage = event.data.error\r\n          this.$store.commit('setStatus', {\r\n            type: Status.ERROR,\r\n            msg: `XYT Loading Error`,\r\n            desc: `Error loading: ${this.myState.subfolder}/${this.vizDetails.file}`,\r\n          })\r\n        } else if (event.data.finished) {\r\n          this.finishedLoadingData(totalRows, event.data)\r\n        } else if (event.data.needCRS) {\r\n          if (this.gzipWorker) this.gzipWorker.terminate()\r\n          let userCRS = prompt('' + this.$t('promptCRS')) || 'EPSG:25833'\r\n          if (Number.isFinite(parseInt(userCRS))) userCRS = `EPSG:${userCRS}`\r\n          this.vizDetails.projection = userCRS.toUpperCase()\r\n          this.parseCSVFile(filename)\r\n        } else {\r\n          const rows = event.data.time.length\r\n          // zoom map on first load\r\n          if (!totalRows) this.setFirstZoom(event.data.coordinates, rows)\r\n          // save layer data\r\n          totalRows += rows\r\n          this.timeRange = [\r\n            Math.min(this.timeRange[0], event.data.time[0]),\r\n            Math.max(this.timeRange[1], event.data.time[rows - 1]),\r\n          ]\r\n          this.pointLayers.push(event.data)\r\n        }\r\n      }\r\n\r\n      this.gzipWorker.postMessage({\r\n        filepath: filename,\r\n        fileSystem: this.fileSystem,\r\n        projection: this.vizDetails.projection,\r\n      })\r\n    },\r\n\r\n    setFirstZoom(coordinates: any[], rows: number) {\r\n      const longitude = 0.5 * (coordinates[0] + coordinates[rows * 2 - 2])\r\n      const latitude = 0.5 * (coordinates[1] + coordinates[rows * 2 - 1])\r\n\r\n      if (Number.isFinite(longitude) && Number.isFinite(latitude)) {\r\n        globalStore.commit(\r\n          'setMapCamera',\r\n          Object.assign({}, globalStore.state.viewState, { longitude, latitude, zoom: 10 })\r\n        )\r\n      }\r\n    },\r\n\r\n    finishedLoadingData(totalRows: number, data: any) {\r\n      console.log('ALL DONE', { totalRows, data: data.range, time: this.timeRange })\r\n      this.myState.statusMessage = ''\r\n      this.timeFilter = [this.timeRange[0], this.timeRange[0] + 3599]\r\n      this.isLoaded = true\r\n      this.range = data.range\r\n      // if (!this.timeRange[1]) this.timeRange[1] = 1\r\n      if (this.gzipWorker) this.gzipWorker.terminate()\r\n\r\n      this.setColors()\r\n      this.moveLogo()\r\n    },\r\n\r\n    animate() {\r\n      if (!this.isAnimating) return\r\n\r\n      this.animationElapsedTime = this.ANIMATE_SPEED * (Date.now() - this.startTime)\r\n      const animationClockTime = this.animationElapsedTime + this.timeRange[0]\r\n\r\n      if (animationClockTime > this.timeRange[1]) {\r\n        this.startTime = Date.now()\r\n        this.animationElapsedTime = 0 // this.timeRange[0]\r\n      }\r\n\r\n      const span = this.timeFilter[1] - this.timeFilter[0]\r\n      this.timeFilter = [animationClockTime, animationClockTime + span]\r\n\r\n      this.animator = window.requestAnimationFrame(this.animate)\r\n    },\r\n\r\n    toggleAnimation() {\r\n      this.isAnimating = !this.isAnimating\r\n      if (this.isAnimating) {\r\n        this.animationElapsedTime = this.timeFilter[0] - this.timeRange[0]\r\n        this.startTime = Date.now() - this.animationElapsedTime / this.ANIMATE_SPEED\r\n        this.animate()\r\n      }\r\n    },\r\n\r\n    setColors() {\r\n      const EXPONENT = this.guiConfig.exponent // powerFunction // 4 // log-e? not steep enough\r\n\r\n      let colors256 = colormap({\r\n        colormap: this.guiConfig['color ramp'],\r\n        nshades: 256,\r\n        format: 'rba',\r\n        alpha: 1,\r\n      }).map((c: number[]) => [c[0], c[1], c[2]])\r\n\r\n      if (this.guiConfig.flip) colors256 = colors256.reverse()\r\n\r\n      const step = 256 / (this.guiConfig.buckets - 1)\r\n      const colors = []\r\n      for (let i = 0; i < this.guiConfig.buckets - 1; i++) {\r\n        colors.push(colors256[Math.round(step * i)])\r\n      }\r\n      colors.push(colors256[255])\r\n\r\n      // figure out min and max\r\n      const max1 = Math.pow(this.range[1], 1 / EXPONENT)\r\n      const max2 = (max1 * this.guiConfig['clip max']) / 100.0\r\n      // const clippedMin = (this.range[1] * this.clipData[0]) / 100.0\r\n\r\n      // console.log({ max1, max2 })\r\n\r\n      const breakpoints = [] as number[]\r\n      for (let i = 1; i < this.guiConfig.buckets; i++) {\r\n        const raw = (max2 * i) / this.guiConfig.buckets\r\n        const breakpoint = Math.pow(raw, EXPONENT)\r\n        breakpoints.push(breakpoint)\r\n      }\r\n\r\n      // only update legend if we have the full dataset already\r\n      if (this.isLoaded) this.setLegend(colors, breakpoints)\r\n\r\n      this.colors = colors\r\n      this.breakpoints = breakpoints\r\n    },\r\n\r\n    setLegend(colors: any[], breakpoints: number[]) {\r\n      // hide the legend if there is no data to show.\r\n      if (this.range[1] - this.range[0] === 0) return\r\n\r\n      this.legendStore = new LegendStore()\r\n      this.legendStore.setLegendSection({\r\n        section: 'Legend',\r\n        column: 'Legend',\r\n        values: colors.map((rgb, index) => {\r\n          const breakpoint = breakpoints[index == 0 ? index : index - 1]\r\n          let label = '' + Math.round(1e6 * breakpoint) / 1e6\r\n          if (index == 0) label = '< ' + label\r\n          if (index == colors.length - 1) label = '> ' + label\r\n          return { label, value: rgb }\r\n        }),\r\n      })\r\n    },\r\n\r\n    async loadFiles() {\r\n      console.log(1)\r\n\r\n      await this.fileApi.getChromePermission(this.fileSystem.handle)\r\n\r\n      try {\r\n        let filename = `${this.myState.subfolder}/${this.vizDetails.file}`\r\n        await this.parseCSVFile(filename)\r\n        console.log(2)\r\n      } catch (e) {\r\n        console.error(e)\r\n        this.myState.statusMessage = '' + e\r\n        this.$store.commit('setStatus', {\r\n          type: Status.ERROR,\r\n          msg: `Loading/Parsing Error`,\r\n          desc: 'Error loading/parsing: ${this.myState.subfolder}/${this.vizDetails.file}',\r\n        })\r\n      }\r\n    },\r\n\r\n    convertSecondsToClockTimeMinutes(index: number) {\r\n      const h = Math.floor(index / 3600)\r\n      const m = Math.floor((index - h * 3600) / 60)\r\n      const s = index - h * 3600 - m * 60\r\n\r\n      const hms = { h: `${h}`, m: `${m}`.padStart(2, '0'), s: `${s}`.padStart(2, '0') }\r\n\r\n      return `${hms.h}:${hms.m}`\r\n    },\r\n  },\r\n})\r\n\r\n// !register plugin!\r\nglobalStore.commit('registerPlugin', {\r\n  kebabName: 'x-y-t',\r\n  prettyName: 'X/Y Time Viewer',\r\n  description: 'Displays point data over time',\r\n  filePatterns: ['**/viz-xyt-*.y?(a)ml', '**/*xyt.csv?(.gz)'],\r\n  component: MyComponent,\r\n} as VisualizationPlugin)\r\n\r\nexport default MyComponent\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.viz-plugin {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: $thumbnailHeight;\r\n  background: url('assets/thumbnail.jpg') center / cover no-repeat;\r\n  z-index: -1;\r\n}\r\n\r\n.viz-plugin.hide-thumbnail {\r\n  background: none;\r\n  z-index: 0;\r\n}\r\n\r\n.message {\r\n  z-index: 5;\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  box-shadow: 0px 2px 10px #22222222;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin: auto auto 0 0;\r\n  background-color: var(--bgPanel);\r\n  padding: 0.5rem 1.5rem;\r\n\r\n  a {\r\n    color: white;\r\n    text-decoration: none;\r\n\r\n    &.router-link-exact-active {\r\n      color: white;\r\n    }\r\n  }\r\n\r\n  p {\r\n    color: var(--textFancy);\r\n    font-size: 1.2rem;\r\n    font-weight: normal;\r\n    line-height: 1.75rem;\r\n    margin: auto 0.5rem auto 0;\r\n    padding: 0 0;\r\n  }\r\n}\r\n\r\n.map-layer {\r\n  pointer-events: auto;\r\n}\r\n\r\n.drawing-tool {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  pointer-events: none;\r\n}\r\n\r\n.bottom-right {\r\n  position: absolute;\r\n  bottom: 0;\r\n  right: 0;\r\n  margin: auto 7px 15rem auto;\r\n  box-shadow: 0px 0px 5px 3px rgba(128, 128, 128, 0.1);\r\n}\r\n\r\n.legend-area {\r\n  background-color: var(--bgPanel);\r\n  border: 1px solid var(--bgPanel2);\r\n}\r\n\r\n.time-slider-area {\r\n  position: absolute;\r\n  bottom: 2.5rem;\r\n  left: 0;\r\n  right: 0;\r\n  margin: 0 8rem 0 0.5rem;\r\n  filter: $filterShadow;\r\n}\r\n\r\n.buckets {\r\n  color: var(--text);\r\n  padding: 4px 4px 4px 4px;\r\n  display: flex;\r\n}\r\n\r\n.ramp-selector {\r\n  background-color: var(--bgBold);\r\n}\r\n\r\n.configurator {\r\n  user-select: none;\r\n  background-color: var(--bgPanel);\r\n  margin-top: 2rem;\r\n}\r\n\r\n.clip-slider {\r\n  margin: 0 0.5rem;\r\n}\r\n\r\n.top-right {\r\n  background-color: var(--bgPanel2);\r\n  color: white;\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  z-index: 5;\r\n  border-left: 1px solid #66669940;\r\n  border-bottom: 1px solid #66669940;\r\n  box-shadow: 0px 0px 5px 3px rgba(128, 128, 128, 0.1);\r\n}\r\n\r\n* > .number {\r\n  background-color: yellow;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n  .message {\r\n    padding: 0.5rem 0.5rem;\r\n  }\r\n}\r\n</style>\r\n","\r\n.viz-plugin(:class=\"{'hide-thumbnail': !thumbnail}\" oncontextmenu=\"return false\" :id=\"`id-${viewId}`\")\r\n\r\n  xy-time-deck-map.map-layer(v-if=\"!thumbnail\"\r\n    :viewId=\"viewId\"\r\n    :pointLayers=\"pointLayers\"\r\n    :timeFilter=\"timeFilter\"\r\n    :dark=\"this.$store.state.isDarkMode\"\r\n    :colors=\"this.colors\"\r\n    :breakpoints=\"this.breakpoints\"\r\n    :radius=\"this.guiConfig.radius\"\r\n    :mapIsIndependent=\"false\"\r\n  )\r\n\r\n  zoom-buttons(v-if=\"!thumbnail\" corner=\"bottom\")\r\n\r\n  .top-right\r\n    .gui-config(:id=\"configId\")\r\n\r\n  .bottom-right\r\n    .legend-area(v-if=\"legendStore\")\r\n      legend-box(:legendStore=\"legendStore\")\r\n\r\n  time-slider.time-slider-area(v-if=\"isLoaded\"\r\n    :range=\"timeRange\"\r\n    :activeTimeExtent=\"timeFilter\"\r\n    :labels=\"timeLabels\"\r\n    :isAnimating=\"isAnimating\"\r\n    @timeExtent=\"handleTimeSliderValues\"\r\n    @toggleAnimation=\"toggleAnimation\"\r\n    @drag=\"isAnimating=false\"\r\n  )\r\n\r\n  .message(v-if=\"!thumbnail && myState.statusMessage\")\r\n    p.status-message {{ myState.statusMessage }}\r\n\r\n","// import plugins in the order you want them to appear on project pages\r\nimport XmasKelheim from '@/plugins/xmas-kelheim/VehicleAnimation.vue'\r\nimport Events from '@/plugins/event-viewer/EventViewer.vue'\r\nimport CarrierViewer from '@/plugins/carrier-viewer/CarrierViewer.vue'\r\nimport VehicleView from '@/plugins/vehicle-animation/VehicleAnimation.vue'\r\nimport Summary from '@/plugins/calculation-table/CalculationTable.vue'\r\nimport Network from '@/plugins/links-gl/NetworkLinks.vue'\r\nimport Transit from '@/plugins/transit-demand/TransitDemand.vue'\r\nimport AggregateOd from '@/plugins/aggregate-od/AggregateOd.vue'\r\nimport Plotly from '@/plugins/plotly/PlotlyDiagram.vue'\r\nimport Sankey from '@/plugins/sankey/SankeyDiagram.vue'\r\nimport VegaLite from '@/plugins/vega-lite/VegaLite.vue'\r\nimport VidPlayer from '@/plugins/video-player/VideoPlayer.vue'\r\nimport ImageView from '@/plugins/image/ImageView.vue'\r\nimport AreaMap from '@/plugins/shape-file/ShapeFile.vue'\r\nimport Hexagons from '@/plugins/xy-hexagons/XyHexagons.vue'\r\nimport XYT from '@/plugins/xy-time/XyTime.vue'\r\nimport Flowmap from '@/plugins/flowmap/Flowmap.vue'\r\n\r\n// // EVERY plugin must also be exported here:\r\nconst plugins = {\r\n  Summary,\r\n  AggregateOd,\r\n  Events,\r\n  AreaMap,\r\n  Network,\r\n  Transit,\r\n  CarrierViewer,\r\n  Hexagons,\r\n  Sankey,\r\n  Plotly,\r\n  VegaLite,\r\n  VehicleView,\r\n  XYT,\r\n  VidPlayer,\r\n  ImageView,\r\n  XmasKelheim,\r\n  Flowmap,\r\n}\r\n\r\nexport default plugins\r\n","/*! @license DOMPurify 2.4.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.0/LICENSE */\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar hasOwnProperty = Object.hasOwnProperty,\n    setPrototypeOf = Object.setPrototypeOf,\n    isFrozen = Object.isFrozen,\n    getPrototypeOf = Object.getPrototypeOf,\n    getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar freeze = Object.freeze,\n    seal = Object.seal,\n    create = Object.create; // eslint-disable-line import/no-mutable-exports\n\nvar _ref = typeof Reflect !== 'undefined' && Reflect,\n    apply = _ref.apply,\n    construct = _ref.construct;\n\nif (!apply) {\n  apply = function apply(fun, thisValue, args) {\n    return fun.apply(thisValue, args);\n  };\n}\n\nif (!freeze) {\n  freeze = function freeze(x) {\n    return x;\n  };\n}\n\nif (!seal) {\n  seal = function seal(x) {\n    return x;\n  };\n}\n\nif (!construct) {\n  construct = function construct(Func, args) {\n    return _construct(Func, _toConsumableArray(args));\n  };\n}\n\nvar arrayForEach = unapply(Array.prototype.forEach);\nvar arrayPop = unapply(Array.prototype.pop);\nvar arrayPush = unapply(Array.prototype.push);\nvar stringToLowerCase = unapply(String.prototype.toLowerCase);\nvar stringMatch = unapply(String.prototype.match);\nvar stringReplace = unapply(String.prototype.replace);\nvar stringIndexOf = unapply(String.prototype.indexOf);\nvar stringTrim = unapply(String.prototype.trim);\nvar regExpTest = unapply(RegExp.prototype.test);\nvar typeErrorCreate = unconstruct(TypeError);\nfunction unapply(func) {\n  return function (thisArg) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    return apply(func, thisArg, args);\n  };\n}\nfunction unconstruct(func) {\n  return function () {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    return construct(func, args);\n  };\n}\n/* Add properties to a lookup table */\n\nfunction addToSet(set, array, transformCaseFunc) {\n  transformCaseFunc = transformCaseFunc ? transformCaseFunc : stringToLowerCase;\n\n  if (setPrototypeOf) {\n    // Make 'in' and truthy checks like Boolean(set.constructor)\n    // independent of any properties defined on Object.prototype.\n    // Prevent prototype setters from intercepting set as a this value.\n    setPrototypeOf(set, null);\n  }\n\n  var l = array.length;\n\n  while (l--) {\n    var element = array[l];\n\n    if (typeof element === 'string') {\n      var lcElement = transformCaseFunc(element);\n\n      if (lcElement !== element) {\n        // Config presets (e.g. tags.js, attrs.js) are immutable.\n        if (!isFrozen(array)) {\n          array[l] = lcElement;\n        }\n\n        element = lcElement;\n      }\n    }\n\n    set[element] = true;\n  }\n\n  return set;\n}\n/* Shallow clone an object */\n\nfunction clone(object) {\n  var newObject = create(null);\n  var property;\n\n  for (property in object) {\n    if (apply(hasOwnProperty, object, [property])) {\n      newObject[property] = object[property];\n    }\n  }\n\n  return newObject;\n}\n/* IE10 doesn't support __lookupGetter__ so lets'\n * simulate it. It also automatically checks\n * if the prop is function or getter and behaves\n * accordingly. */\n\nfunction lookupGetter(object, prop) {\n  while (object !== null) {\n    var desc = getOwnPropertyDescriptor(object, prop);\n\n    if (desc) {\n      if (desc.get) {\n        return unapply(desc.get);\n      }\n\n      if (typeof desc.value === 'function') {\n        return unapply(desc.value);\n      }\n    }\n\n    object = getPrototypeOf(object);\n  }\n\n  function fallbackValue(element) {\n    console.warn('fallback value for', element);\n    return null;\n  }\n\n  return fallbackValue;\n}\n\nvar html$1 = freeze(['a', 'abbr', 'acronym', 'address', 'area', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'content', 'data', 'datalist', 'dd', 'decorator', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'img', 'input', 'ins', 'kbd', 'label', 'legend', 'li', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meter', 'nav', 'nobr', 'ol', 'optgroup', 'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr']); // SVG\n\nvar svg$1 = freeze(['svg', 'a', 'altglyph', 'altglyphdef', 'altglyphitem', 'animatecolor', 'animatemotion', 'animatetransform', 'circle', 'clippath', 'defs', 'desc', 'ellipse', 'filter', 'font', 'g', 'glyph', 'glyphref', 'hkern', 'image', 'line', 'lineargradient', 'marker', 'mask', 'metadata', 'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialgradient', 'rect', 'stop', 'style', 'switch', 'symbol', 'text', 'textpath', 'title', 'tref', 'tspan', 'view', 'vkern']);\nvar svgFilters = freeze(['feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence']); // List of SVG elements that are disallowed by default.\n// We still need to know them so that we can do namespace\n// checks properly in case one wants to add them to\n// allow-list.\n\nvar svgDisallowed = freeze(['animate', 'color-profile', 'cursor', 'discard', 'fedropshadow', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignobject', 'hatch', 'hatchpath', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'missing-glyph', 'script', 'set', 'solidcolor', 'unknown', 'use']);\nvar mathMl$1 = freeze(['math', 'menclose', 'merror', 'mfenced', 'mfrac', 'mglyph', 'mi', 'mlabeledtr', 'mmultiscripts', 'mn', 'mo', 'mover', 'mpadded', 'mphantom', 'mroot', 'mrow', 'ms', 'mspace', 'msqrt', 'mstyle', 'msub', 'msup', 'msubsup', 'mtable', 'mtd', 'mtext', 'mtr', 'munder', 'munderover']); // Similarly to SVG, we want to know all MathML elements,\n// even those that we disallow by default.\n\nvar mathMlDisallowed = freeze(['maction', 'maligngroup', 'malignmark', 'mlongdiv', 'mscarries', 'mscarry', 'msgroup', 'mstack', 'msline', 'msrow', 'semantics', 'annotation', 'annotation-xml', 'mprescripts', 'none']);\nvar text = freeze(['#text']);\n\nvar html = freeze(['accept', 'action', 'align', 'alt', 'autocapitalize', 'autocomplete', 'autopictureinpicture', 'autoplay', 'background', 'bgcolor', 'border', 'capture', 'cellpadding', 'cellspacing', 'checked', 'cite', 'class', 'clear', 'color', 'cols', 'colspan', 'controls', 'controlslist', 'coords', 'crossorigin', 'datetime', 'decoding', 'default', 'dir', 'disabled', 'disablepictureinpicture', 'disableremoteplayback', 'download', 'draggable', 'enctype', 'enterkeyhint', 'face', 'for', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'id', 'inputmode', 'integrity', 'ismap', 'kind', 'label', 'lang', 'list', 'loading', 'loop', 'low', 'max', 'maxlength', 'media', 'method', 'min', 'minlength', 'multiple', 'muted', 'name', 'nonce', 'noshade', 'novalidate', 'nowrap', 'open', 'optimum', 'pattern', 'placeholder', 'playsinline', 'poster', 'preload', 'pubdate', 'radiogroup', 'readonly', 'rel', 'required', 'rev', 'reversed', 'role', 'rows', 'rowspan', 'spellcheck', 'scope', 'selected', 'shape', 'size', 'sizes', 'span', 'srclang', 'start', 'src', 'srcset', 'step', 'style', 'summary', 'tabindex', 'title', 'translate', 'type', 'usemap', 'valign', 'value', 'width', 'xmlns', 'slot']);\nvar svg = freeze(['accent-height', 'accumulate', 'additive', 'alignment-baseline', 'ascent', 'attributename', 'attributetype', 'azimuth', 'basefrequency', 'baseline-shift', 'begin', 'bias', 'by', 'class', 'clip', 'clippathunits', 'clip-path', 'clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cx', 'cy', 'd', 'dx', 'dy', 'diffuseconstant', 'direction', 'display', 'divisor', 'dur', 'edgemode', 'elevation', 'end', 'fill', 'fill-opacity', 'fill-rule', 'filter', 'filterunits', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'fx', 'fy', 'g1', 'g2', 'glyph-name', 'glyphref', 'gradientunits', 'gradienttransform', 'height', 'href', 'id', 'image-rendering', 'in', 'in2', 'k', 'k1', 'k2', 'k3', 'k4', 'kerning', 'keypoints', 'keysplines', 'keytimes', 'lang', 'lengthadjust', 'letter-spacing', 'kernelmatrix', 'kernelunitlength', 'lighting-color', 'local', 'marker-end', 'marker-mid', 'marker-start', 'markerheight', 'markerunits', 'markerwidth', 'maskcontentunits', 'maskunits', 'max', 'mask', 'media', 'method', 'mode', 'min', 'name', 'numoctaves', 'offset', 'operator', 'opacity', 'order', 'orient', 'orientation', 'origin', 'overflow', 'paint-order', 'path', 'pathlength', 'patterncontentunits', 'patterntransform', 'patternunits', 'points', 'preservealpha', 'preserveaspectratio', 'primitiveunits', 'r', 'rx', 'ry', 'radius', 'refx', 'refy', 'repeatcount', 'repeatdur', 'restart', 'result', 'rotate', 'scale', 'seed', 'shape-rendering', 'specularconstant', 'specularexponent', 'spreadmethod', 'startoffset', 'stddeviation', 'stitchtiles', 'stop-color', 'stop-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke', 'stroke-width', 'style', 'surfacescale', 'systemlanguage', 'tabindex', 'targetx', 'targety', 'transform', 'transform-origin', 'text-anchor', 'text-decoration', 'text-rendering', 'textlength', 'type', 'u1', 'u2', 'unicode', 'values', 'viewbox', 'visibility', 'version', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'width', 'word-spacing', 'wrap', 'writing-mode', 'xchannelselector', 'ychannelselector', 'x', 'x1', 'x2', 'xmlns', 'y', 'y1', 'y2', 'z', 'zoomandpan']);\nvar mathMl = freeze(['accent', 'accentunder', 'align', 'bevelled', 'close', 'columnsalign', 'columnlines', 'columnspan', 'denomalign', 'depth', 'dir', 'display', 'displaystyle', 'encoding', 'fence', 'frame', 'height', 'href', 'id', 'largeop', 'length', 'linethickness', 'lspace', 'lquote', 'mathbackground', 'mathcolor', 'mathsize', 'mathvariant', 'maxsize', 'minsize', 'movablelimits', 'notation', 'numalign', 'open', 'rowalign', 'rowlines', 'rowspacing', 'rowspan', 'rspace', 'rquote', 'scriptlevel', 'scriptminsize', 'scriptsizemultiplier', 'selection', 'separator', 'separators', 'stretchy', 'subscriptshift', 'supscriptshift', 'symmetric', 'voffset', 'width', 'xmlns']);\nvar xml = freeze(['xlink:href', 'xml:id', 'xlink:title', 'xml:space', 'xmlns:xlink']);\n\nvar MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\n\nvar ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\nvar DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]/); // eslint-disable-line no-useless-escape\n\nvar ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\n\nvar IS_ALLOWED_URI = seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n);\nvar IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\nvar ATTR_WHITESPACE = seal(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n);\nvar DOCTYPE_NAME = seal(/^html$/i);\n\nvar getGlobal = function getGlobal() {\n  return typeof window === 'undefined' ? null : window;\n};\n/**\n * Creates a no-op policy for internal use only.\n * Don't export this function outside this module!\n * @param {?TrustedTypePolicyFactory} trustedTypes The policy factory.\n * @param {Document} document The document object (to determine policy name suffix)\n * @return {?TrustedTypePolicy} The policy created (or null, if Trusted Types\n * are not supported).\n */\n\n\nvar _createTrustedTypesPolicy = function _createTrustedTypesPolicy(trustedTypes, document) {\n  if (_typeof(trustedTypes) !== 'object' || typeof trustedTypes.createPolicy !== 'function') {\n    return null;\n  } // Allow the callers to control the unique policy name\n  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n  // Policy creation with duplicate names throws in Trusted Types.\n\n\n  var suffix = null;\n  var ATTR_NAME = 'data-tt-policy-suffix';\n\n  if (document.currentScript && document.currentScript.hasAttribute(ATTR_NAME)) {\n    suffix = document.currentScript.getAttribute(ATTR_NAME);\n  }\n\n  var policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n\n  try {\n    return trustedTypes.createPolicy(policyName, {\n      createHTML: function createHTML(html) {\n        return html;\n      },\n      createScriptURL: function createScriptURL(scriptUrl) {\n        return scriptUrl;\n      }\n    });\n  } catch (_) {\n    // Policy creation failed (most likely another DOMPurify script has\n    // already run). Skip creating the policy, as this will only cause errors\n    // if TT are enforced.\n    console.warn('TrustedTypes policy ' + policyName + ' could not be created.');\n    return null;\n  }\n};\n\nfunction createDOMPurify() {\n  var window = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getGlobal();\n\n  var DOMPurify = function DOMPurify(root) {\n    return createDOMPurify(root);\n  };\n  /**\n   * Version label, exposed for easier checks\n   * if DOMPurify is up to date or not\n   */\n\n\n  DOMPurify.version = '2.4.0';\n  /**\n   * Array of elements that DOMPurify removed during sanitation.\n   * Empty if nothing was removed.\n   */\n\n  DOMPurify.removed = [];\n\n  if (!window || !window.document || window.document.nodeType !== 9) {\n    // Not running in a browser, provide a factory function\n    // so that you can pass your own Window\n    DOMPurify.isSupported = false;\n    return DOMPurify;\n  }\n\n  var originalDocument = window.document;\n  var document = window.document;\n  var DocumentFragment = window.DocumentFragment,\n      HTMLTemplateElement = window.HTMLTemplateElement,\n      Node = window.Node,\n      Element = window.Element,\n      NodeFilter = window.NodeFilter,\n      _window$NamedNodeMap = window.NamedNodeMap,\n      NamedNodeMap = _window$NamedNodeMap === void 0 ? window.NamedNodeMap || window.MozNamedAttrMap : _window$NamedNodeMap,\n      HTMLFormElement = window.HTMLFormElement,\n      DOMParser = window.DOMParser,\n      trustedTypes = window.trustedTypes;\n  var ElementPrototype = Element.prototype;\n  var cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n  var getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n  var getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n  var getParentNode = lookupGetter(ElementPrototype, 'parentNode'); // As per issue #47, the web-components registry is inherited by a\n  // new document created via createHTMLDocument. As per the spec\n  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n  // a new empty registry is used when creating a template contents owner\n  // document, so we use that as our parent document to ensure nothing\n  // is inherited.\n\n  if (typeof HTMLTemplateElement === 'function') {\n    var template = document.createElement('template');\n\n    if (template.content && template.content.ownerDocument) {\n      document = template.content.ownerDocument;\n    }\n  }\n\n  var trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, originalDocument);\n\n  var emptyHTML = trustedTypesPolicy ? trustedTypesPolicy.createHTML('') : '';\n  var _document = document,\n      implementation = _document.implementation,\n      createNodeIterator = _document.createNodeIterator,\n      createDocumentFragment = _document.createDocumentFragment,\n      getElementsByTagName = _document.getElementsByTagName;\n  var importNode = originalDocument.importNode;\n  var documentMode = {};\n\n  try {\n    documentMode = clone(document).documentMode ? document.documentMode : {};\n  } catch (_) {}\n\n  var hooks = {};\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n\n  DOMPurify.isSupported = typeof getParentNode === 'function' && implementation && typeof implementation.createHTMLDocument !== 'undefined' && documentMode !== 9;\n  var MUSTACHE_EXPR$1 = MUSTACHE_EXPR,\n      ERB_EXPR$1 = ERB_EXPR,\n      DATA_ATTR$1 = DATA_ATTR,\n      ARIA_ATTR$1 = ARIA_ATTR,\n      IS_SCRIPT_OR_DATA$1 = IS_SCRIPT_OR_DATA,\n      ATTR_WHITESPACE$1 = ATTR_WHITESPACE;\n  var IS_ALLOWED_URI$1 = IS_ALLOWED_URI;\n  /**\n   * We consider the elements and attributes below to be safe. Ideally\n   * don't add any new ones but feel free to remove unwanted ones.\n   */\n\n  /* allowed element names */\n\n  var ALLOWED_TAGS = null;\n  var DEFAULT_ALLOWED_TAGS = addToSet({}, [].concat(_toConsumableArray(html$1), _toConsumableArray(svg$1), _toConsumableArray(svgFilters), _toConsumableArray(mathMl$1), _toConsumableArray(text)));\n  /* Allowed attribute names */\n\n  var ALLOWED_ATTR = null;\n  var DEFAULT_ALLOWED_ATTR = addToSet({}, [].concat(_toConsumableArray(html), _toConsumableArray(svg), _toConsumableArray(mathMl), _toConsumableArray(xml)));\n  /*\n   * Configure how DOMPUrify should handle custom elements and their attributes as well as customized built-in elements.\n   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n   */\n\n  var CUSTOM_ELEMENT_HANDLING = Object.seal(Object.create(null, {\n    tagNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    attributeNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    allowCustomizedBuiltInElements: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: false\n    }\n  }));\n  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n\n  var FORBID_TAGS = null;\n  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n\n  var FORBID_ATTR = null;\n  /* Decide if ARIA attributes are okay */\n\n  var ALLOW_ARIA_ATTR = true;\n  /* Decide if custom data attributes are okay */\n\n  var ALLOW_DATA_ATTR = true;\n  /* Decide if unknown protocols are okay */\n\n  var ALLOW_UNKNOWN_PROTOCOLS = false;\n  /* Output should be safe for common template engines.\n   * This means, DOMPurify removes data attributes, mustaches and ERB\n   */\n\n  var SAFE_FOR_TEMPLATES = false;\n  /* Decide if document with <html>... should be returned */\n\n  var WHOLE_DOCUMENT = false;\n  /* Track whether config is already set on this instance of DOMPurify. */\n\n  var SET_CONFIG = false;\n  /* Decide if all elements (e.g. style, script) must be children of\n   * document.body. By default, browsers might move them to document.head */\n\n  var FORCE_BODY = false;\n  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n   * string (or a TrustedHTML object if Trusted Types are supported).\n   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n   */\n\n  var RETURN_DOM = false;\n  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n   * string  (or a TrustedHTML object if Trusted Types are supported) */\n\n  var RETURN_DOM_FRAGMENT = false;\n  /* Try to return a Trusted Type object instead of a string, return a string in\n   * case Trusted Types are not supported  */\n\n  var RETURN_TRUSTED_TYPE = false;\n  /* Output should be free from DOM clobbering attacks?\n   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n   */\n\n  var SANITIZE_DOM = true;\n  /* Achieve full DOM Clobbering protection by isolating the namespace of named\n   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n   *\n   * HTML/DOM spec rules that enable DOM Clobbering:\n   *   - Named Access on Window (§7.3.3)\n   *   - DOM Tree Accessors (§3.1.5)\n   *   - Form Element Parent-Child Relations (§4.10.3)\n   *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n   *   - HTMLCollection (§4.2.10.2)\n   *\n   * Namespace isolation is implemented by prefixing `id` and `name` attributes\n   * with a constant string, i.e., `user-content-`\n   */\n\n  var SANITIZE_NAMED_PROPS = false;\n  var SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n  /* Keep element content when removing element? */\n\n  var KEEP_CONTENT = true;\n  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n   * of importing it into a new Document and returning a sanitized copy */\n\n  var IN_PLACE = false;\n  /* Allow usage of profiles like html, svg and mathMl */\n\n  var USE_PROFILES = {};\n  /* Tags to ignore content of when KEEP_CONTENT is true */\n\n  var FORBID_CONTENTS = null;\n  var DEFAULT_FORBID_CONTENTS = addToSet({}, ['annotation-xml', 'audio', 'colgroup', 'desc', 'foreignobject', 'head', 'iframe', 'math', 'mi', 'mn', 'mo', 'ms', 'mtext', 'noembed', 'noframes', 'noscript', 'plaintext', 'script', 'style', 'svg', 'template', 'thead', 'title', 'video', 'xmp']);\n  /* Tags that are safe for data: URIs */\n\n  var DATA_URI_TAGS = null;\n  var DEFAULT_DATA_URI_TAGS = addToSet({}, ['audio', 'video', 'img', 'source', 'image', 'track']);\n  /* Attributes safe for values like \"javascript:\" */\n\n  var URI_SAFE_ATTRIBUTES = null;\n  var DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ['alt', 'class', 'for', 'id', 'label', 'name', 'pattern', 'placeholder', 'role', 'summary', 'title', 'value', 'style', 'xmlns']);\n  var MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n  var SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n  var HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n  /* Document namespace */\n\n  var NAMESPACE = HTML_NAMESPACE;\n  var IS_EMPTY_INPUT = false;\n  /* Parsing of strict XHTML documents */\n\n  var PARSER_MEDIA_TYPE;\n  var SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n  var DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n  var transformCaseFunc;\n  /* Keep a reference to config to pass to hooks */\n\n  var CONFIG = null;\n  /* Ideally, do not touch anything below this line */\n\n  /* ______________________________________________ */\n\n  var formElement = document.createElement('form');\n\n  var isRegexOrFunction = function isRegexOrFunction(testValue) {\n    return testValue instanceof RegExp || testValue instanceof Function;\n  };\n  /**\n   * _parseConfig\n   *\n   * @param  {Object} cfg optional config literal\n   */\n  // eslint-disable-next-line complexity\n\n\n  var _parseConfig = function _parseConfig(cfg) {\n    if (CONFIG && CONFIG === cfg) {\n      return;\n    }\n    /* Shield configuration object from tampering */\n\n\n    if (!cfg || _typeof(cfg) !== 'object') {\n      cfg = {};\n    }\n    /* Shield configuration object from prototype pollution */\n\n\n    cfg = clone(cfg);\n    PARSER_MEDIA_TYPE = // eslint-disable-next-line unicorn/prefer-includes\n    SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? PARSER_MEDIA_TYPE = DEFAULT_PARSER_MEDIA_TYPE : PARSER_MEDIA_TYPE = cfg.PARSER_MEDIA_TYPE; // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n\n    transformCaseFunc = PARSER_MEDIA_TYPE === 'application/xhtml+xml' ? function (x) {\n      return x;\n    } : stringToLowerCase;\n    /* Set configuration parameters */\n\n    ALLOWED_TAGS = 'ALLOWED_TAGS' in cfg ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;\n    ALLOWED_ATTR = 'ALLOWED_ATTR' in cfg ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;\n    URI_SAFE_ATTRIBUTES = 'ADD_URI_SAFE_ATTR' in cfg ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES), // eslint-disable-line indent\n    cfg.ADD_URI_SAFE_ATTR, // eslint-disable-line indent\n    transformCaseFunc // eslint-disable-line indent\n    ) // eslint-disable-line indent\n    : DEFAULT_URI_SAFE_ATTRIBUTES;\n    DATA_URI_TAGS = 'ADD_DATA_URI_TAGS' in cfg ? addToSet(clone(DEFAULT_DATA_URI_TAGS), // eslint-disable-line indent\n    cfg.ADD_DATA_URI_TAGS, // eslint-disable-line indent\n    transformCaseFunc // eslint-disable-line indent\n    ) // eslint-disable-line indent\n    : DEFAULT_DATA_URI_TAGS;\n    FORBID_CONTENTS = 'FORBID_CONTENTS' in cfg ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;\n    FORBID_TAGS = 'FORBID_TAGS' in cfg ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : {};\n    FORBID_ATTR = 'FORBID_ATTR' in cfg ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : {};\n    USE_PROFILES = 'USE_PROFILES' in cfg ? cfg.USE_PROFILES : false;\n    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n\n    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n\n    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n\n    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n\n    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n\n    RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n\n    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n\n    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n\n    FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n\n    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n\n    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n\n    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n\n    IN_PLACE = cfg.IN_PLACE || false; // Default false\n\n    IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI$1;\n    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n    }\n\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n    }\n\n    if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === 'boolean') {\n      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n    }\n\n    if (SAFE_FOR_TEMPLATES) {\n      ALLOW_DATA_ATTR = false;\n    }\n\n    if (RETURN_DOM_FRAGMENT) {\n      RETURN_DOM = true;\n    }\n    /* Parse profile info */\n\n\n    if (USE_PROFILES) {\n      ALLOWED_TAGS = addToSet({}, _toConsumableArray(text));\n      ALLOWED_ATTR = [];\n\n      if (USE_PROFILES.html === true) {\n        addToSet(ALLOWED_TAGS, html$1);\n        addToSet(ALLOWED_ATTR, html);\n      }\n\n      if (USE_PROFILES.svg === true) {\n        addToSet(ALLOWED_TAGS, svg$1);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n\n      if (USE_PROFILES.svgFilters === true) {\n        addToSet(ALLOWED_TAGS, svgFilters);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n\n      if (USE_PROFILES.mathMl === true) {\n        addToSet(ALLOWED_TAGS, mathMl$1);\n        addToSet(ALLOWED_ATTR, mathMl);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n    }\n    /* Merge configuration parameters */\n\n\n    if (cfg.ADD_TAGS) {\n      if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n        ALLOWED_TAGS = clone(ALLOWED_TAGS);\n      }\n\n      addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n    }\n\n    if (cfg.ADD_ATTR) {\n      if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n        ALLOWED_ATTR = clone(ALLOWED_ATTR);\n      }\n\n      addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n    }\n\n    if (cfg.ADD_URI_SAFE_ATTR) {\n      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n    }\n\n    if (cfg.FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n\n      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n    }\n    /* Add #text in case KEEP_CONTENT is set to true */\n\n\n    if (KEEP_CONTENT) {\n      ALLOWED_TAGS['#text'] = true;\n    }\n    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n\n\n    if (WHOLE_DOCUMENT) {\n      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n    }\n    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n\n\n    if (ALLOWED_TAGS.table) {\n      addToSet(ALLOWED_TAGS, ['tbody']);\n      delete FORBID_TAGS.tbody;\n    } // Prevent further manipulation of configuration.\n    // Not available in IE8, Safari 5, etc.\n\n\n    if (freeze) {\n      freeze(cfg);\n    }\n\n    CONFIG = cfg;\n  };\n\n  var MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ['mi', 'mo', 'mn', 'ms', 'mtext']);\n  var HTML_INTEGRATION_POINTS = addToSet({}, ['foreignobject', 'desc', 'title', 'annotation-xml']); // Certain elements are allowed in both SVG and HTML\n  // namespace. We need to specify them explicitly\n  // so that they don't get erroneously deleted from\n  // HTML namespace.\n\n  var COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ['title', 'style', 'font', 'a', 'script']);\n  /* Keep track of all possible SVG and MathML tags\n   * so that we can perform the namespace checks\n   * correctly. */\n\n  var ALL_SVG_TAGS = addToSet({}, svg$1);\n  addToSet(ALL_SVG_TAGS, svgFilters);\n  addToSet(ALL_SVG_TAGS, svgDisallowed);\n  var ALL_MATHML_TAGS = addToSet({}, mathMl$1);\n  addToSet(ALL_MATHML_TAGS, mathMlDisallowed);\n  /**\n   *\n   *\n   * @param  {Element} element a DOM element whose namespace is being checked\n   * @returns {boolean} Return false if the element has a\n   *  namespace that a spec-compliant parser would never\n   *  return. Return true otherwise.\n   */\n\n  var _checkValidNamespace = function _checkValidNamespace(element) {\n    var parent = getParentNode(element); // In JSDOM, if we're inside shadow DOM, then parentNode\n    // can be null. We just simulate parent in this case.\n\n    if (!parent || !parent.tagName) {\n      parent = {\n        namespaceURI: HTML_NAMESPACE,\n        tagName: 'template'\n      };\n    }\n\n    var tagName = stringToLowerCase(element.tagName);\n    var parentTagName = stringToLowerCase(parent.tagName);\n\n    if (element.namespaceURI === SVG_NAMESPACE) {\n      // The only way to switch from HTML namespace to SVG\n      // is via <svg>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'svg';\n      } // The only way to switch from MathML to SVG is via\n      // svg if parent is either <annotation-xml> or MathML\n      // text integration points.\n\n\n      if (parent.namespaceURI === MATHML_NAMESPACE) {\n        return tagName === 'svg' && (parentTagName === 'annotation-xml' || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);\n      } // We only allow elements that are defined in SVG\n      // spec. All others are disallowed in SVG namespace.\n\n\n      return Boolean(ALL_SVG_TAGS[tagName]);\n    }\n\n    if (element.namespaceURI === MATHML_NAMESPACE) {\n      // The only way to switch from HTML namespace to MathML\n      // is via <math>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'math';\n      } // The only way to switch from SVG to MathML is via\n      // <math> and HTML integration points\n\n\n      if (parent.namespaceURI === SVG_NAMESPACE) {\n        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n      } // We only allow elements that are defined in MathML\n      // spec. All others are disallowed in MathML namespace.\n\n\n      return Boolean(ALL_MATHML_TAGS[tagName]);\n    }\n\n    if (element.namespaceURI === HTML_NAMESPACE) {\n      // The only way to switch from SVG to HTML is via\n      // HTML integration points, and from MathML to HTML\n      // is via MathML text integration points\n      if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n\n      if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      } // We disallow tags that are specific for MathML\n      // or SVG and should never appear in HTML namespace\n\n\n      return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);\n    } // The code should never reach this place (this means\n    // that the element somehow got namespace that is not\n    // HTML, SVG or MathML). Return false just in case.\n\n\n    return false;\n  };\n  /**\n   * _forceRemove\n   *\n   * @param  {Node} node a DOM node\n   */\n\n\n  var _forceRemove = function _forceRemove(node) {\n    arrayPush(DOMPurify.removed, {\n      element: node\n    });\n\n    try {\n      // eslint-disable-next-line unicorn/prefer-dom-node-remove\n      node.parentNode.removeChild(node);\n    } catch (_) {\n      try {\n        node.outerHTML = emptyHTML;\n      } catch (_) {\n        node.remove();\n      }\n    }\n  };\n  /**\n   * _removeAttribute\n   *\n   * @param  {String} name an Attribute name\n   * @param  {Node} node a DOM node\n   */\n\n\n  var _removeAttribute = function _removeAttribute(name, node) {\n    try {\n      arrayPush(DOMPurify.removed, {\n        attribute: node.getAttributeNode(name),\n        from: node\n      });\n    } catch (_) {\n      arrayPush(DOMPurify.removed, {\n        attribute: null,\n        from: node\n      });\n    }\n\n    node.removeAttribute(name); // We void attribute values for unremovable \"is\"\" attributes\n\n    if (name === 'is' && !ALLOWED_ATTR[name]) {\n      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n        try {\n          _forceRemove(node);\n        } catch (_) {}\n      } else {\n        try {\n          node.setAttribute(name, '');\n        } catch (_) {}\n      }\n    }\n  };\n  /**\n   * _initDocument\n   *\n   * @param  {String} dirty a string of dirty markup\n   * @return {Document} a DOM, filled with the dirty markup\n   */\n\n\n  var _initDocument = function _initDocument(dirty) {\n    /* Create a HTML document */\n    var doc;\n    var leadingWhitespace;\n\n    if (FORCE_BODY) {\n      dirty = '<remove></remove>' + dirty;\n    } else {\n      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n      var matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n      leadingWhitespace = matches && matches[0];\n    }\n\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml') {\n      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n      dirty = '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' + dirty + '</body></html>';\n    }\n\n    var dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;\n    /*\n     * Use the DOMParser API by default, fallback later if needs be\n     * DOMParser not work for svg when has multiple root element.\n     */\n\n    if (NAMESPACE === HTML_NAMESPACE) {\n      try {\n        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n      } catch (_) {}\n    }\n    /* Use createHTMLDocument in case DOMParser is not available */\n\n\n    if (!doc || !doc.documentElement) {\n      doc = implementation.createDocument(NAMESPACE, 'template', null);\n\n      try {\n        doc.documentElement.innerHTML = IS_EMPTY_INPUT ? '' : dirtyPayload;\n      } catch (_) {// Syntax error if dirtyPayload is invalid xml\n      }\n    }\n\n    var body = doc.body || doc.documentElement;\n\n    if (dirty && leadingWhitespace) {\n      body.insertBefore(document.createTextNode(leadingWhitespace), body.childNodes[0] || null);\n    }\n    /* Work on whole document or just its body */\n\n\n    if (NAMESPACE === HTML_NAMESPACE) {\n      return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? 'html' : 'body')[0];\n    }\n\n    return WHOLE_DOCUMENT ? doc.documentElement : body;\n  };\n  /**\n   * _createIterator\n   *\n   * @param  {Document} root document/fragment to create iterator for\n   * @return {Iterator} iterator instance\n   */\n\n\n  var _createIterator = function _createIterator(root) {\n    return createNodeIterator.call(root.ownerDocument || root, root, // eslint-disable-next-line no-bitwise\n    NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT, null, false);\n  };\n  /**\n   * _isClobbered\n   *\n   * @param  {Node} elm element to check for clobbering attacks\n   * @return {Boolean} true if clobbered, false if safe\n   */\n\n\n  var _isClobbered = function _isClobbered(elm) {\n    return elm instanceof HTMLFormElement && (typeof elm.nodeName !== 'string' || typeof elm.textContent !== 'string' || typeof elm.removeChild !== 'function' || !(elm.attributes instanceof NamedNodeMap) || typeof elm.removeAttribute !== 'function' || typeof elm.setAttribute !== 'function' || typeof elm.namespaceURI !== 'string' || typeof elm.insertBefore !== 'function');\n  };\n  /**\n   * _isNode\n   *\n   * @param  {Node} obj object to check whether it's a DOM node\n   * @return {Boolean} true is object is a DOM node\n   */\n\n\n  var _isNode = function _isNode(object) {\n    return _typeof(Node) === 'object' ? object instanceof Node : object && _typeof(object) === 'object' && typeof object.nodeType === 'number' && typeof object.nodeName === 'string';\n  };\n  /**\n   * _executeHook\n   * Execute user configurable hooks\n   *\n   * @param  {String} entryPoint  Name of the hook's entry point\n   * @param  {Node} currentNode node to work on with the hook\n   * @param  {Object} data additional hook parameters\n   */\n\n\n  var _executeHook = function _executeHook(entryPoint, currentNode, data) {\n    if (!hooks[entryPoint]) {\n      return;\n    }\n\n    arrayForEach(hooks[entryPoint], function (hook) {\n      hook.call(DOMPurify, currentNode, data, CONFIG);\n    });\n  };\n  /**\n   * _sanitizeElements\n   *\n   * @protect nodeName\n   * @protect textContent\n   * @protect removeChild\n   *\n   * @param   {Node} currentNode to check for permission to exist\n   * @return  {Boolean} true if node was killed, false if left alive\n   */\n\n\n  var _sanitizeElements = function _sanitizeElements(currentNode) {\n    var content;\n    /* Execute a hook if present */\n\n    _executeHook('beforeSanitizeElements', currentNode, null);\n    /* Check if element is clobbered or can clobber */\n\n\n    if (_isClobbered(currentNode)) {\n      _forceRemove(currentNode);\n\n      return true;\n    }\n    /* Check if tagname contains Unicode */\n\n\n    if (regExpTest(/[\\u0080-\\uFFFF]/, currentNode.nodeName)) {\n      _forceRemove(currentNode);\n\n      return true;\n    }\n    /* Now let's check the element's type and name */\n\n\n    var tagName = transformCaseFunc(currentNode.nodeName);\n    /* Execute a hook if present */\n\n    _executeHook('uponSanitizeElement', currentNode, {\n      tagName: tagName,\n      allowedTags: ALLOWED_TAGS\n    });\n    /* Detect mXSS attempts abusing namespace confusion */\n\n\n    if (currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && (!_isNode(currentNode.content) || !_isNode(currentNode.content.firstElementChild)) && regExpTest(/<[/\\w]/g, currentNode.innerHTML) && regExpTest(/<[/\\w]/g, currentNode.textContent)) {\n      _forceRemove(currentNode);\n\n      return true;\n    }\n    /* Mitigate a problem with templates inside select */\n\n\n    if (tagName === 'select' && regExpTest(/<template/i, currentNode.innerHTML)) {\n      _forceRemove(currentNode);\n\n      return true;\n    }\n    /* Remove element if anything forbids its presence */\n\n\n    if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n      /* Check if we have a custom element to handle */\n      if (!FORBID_TAGS[tagName] && _basicCustomElementTest(tagName)) {\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)) return false;\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)) return false;\n      }\n      /* Keep content except for bad-listed elements */\n\n\n      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n        var parentNode = getParentNode(currentNode) || currentNode.parentNode;\n        var childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n\n        if (childNodes && parentNode) {\n          var childCount = childNodes.length;\n\n          for (var i = childCount - 1; i >= 0; --i) {\n            parentNode.insertBefore(cloneNode(childNodes[i], true), getNextSibling(currentNode));\n          }\n        }\n      }\n\n      _forceRemove(currentNode);\n\n      return true;\n    }\n    /* Check whether element has a valid namespace */\n\n\n    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n      _forceRemove(currentNode);\n\n      return true;\n    }\n\n    if ((tagName === 'noscript' || tagName === 'noembed') && regExpTest(/<\\/no(script|embed)/i, currentNode.innerHTML)) {\n      _forceRemove(currentNode);\n\n      return true;\n    }\n    /* Sanitize element content to be template-safe */\n\n\n    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === 3) {\n      /* Get the element's text content */\n      content = currentNode.textContent;\n      content = stringReplace(content, MUSTACHE_EXPR$1, ' ');\n      content = stringReplace(content, ERB_EXPR$1, ' ');\n\n      if (currentNode.textContent !== content) {\n        arrayPush(DOMPurify.removed, {\n          element: currentNode.cloneNode()\n        });\n        currentNode.textContent = content;\n      }\n    }\n    /* Execute a hook if present */\n\n\n    _executeHook('afterSanitizeElements', currentNode, null);\n\n    return false;\n  };\n  /**\n   * _isValidAttribute\n   *\n   * @param  {string} lcTag Lowercase tag name of containing element.\n   * @param  {string} lcName Lowercase attribute name.\n   * @param  {string} value Attribute value.\n   * @return {Boolean} Returns true if `value` is valid, otherwise false.\n   */\n  // eslint-disable-next-line complexity\n\n\n  var _isValidAttribute = function _isValidAttribute(lcTag, lcName, value) {\n    /* Make sure attribute cannot clobber */\n    if (SANITIZE_DOM && (lcName === 'id' || lcName === 'name') && (value in document || value in formElement)) {\n      return false;\n    }\n    /* Allow valid data-* attributes: At least one character after \"-\"\n        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n        We don't need to check the value; it's always URI safe. */\n\n\n    if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR$1, lcName)) ; else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR$1, lcName)) ; else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n      if ( // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n      // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n      _basicCustomElementTest(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)) || // Alternative, second condition checks if it's an `is`-attribute, AND\n      // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      lcName === 'is' && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))) ; else {\n        return false;\n      }\n      /* Check value is safe. First, is attr inert? If so, is safe */\n\n    } else if (URI_SAFE_ATTRIBUTES[lcName]) ; else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE$1, ''))) ; else if ((lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') && lcTag !== 'script' && stringIndexOf(value, 'data:') === 0 && DATA_URI_TAGS[lcTag]) ; else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA$1, stringReplace(value, ATTR_WHITESPACE$1, ''))) ; else if (!value) ; else {\n      return false;\n    }\n\n    return true;\n  };\n  /**\n   * _basicCustomElementCheck\n   * checks if at least one dash is included in tagName, and it's not the first char\n   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n   * @param {string} tagName name of the tag of the node to sanitize\n   */\n\n\n  var _basicCustomElementTest = function _basicCustomElementTest(tagName) {\n    return tagName.indexOf('-') > 0;\n  };\n  /**\n   * _sanitizeAttributes\n   *\n   * @protect attributes\n   * @protect nodeName\n   * @protect removeAttribute\n   * @protect setAttribute\n   *\n   * @param  {Node} currentNode to sanitize\n   */\n\n\n  var _sanitizeAttributes = function _sanitizeAttributes(currentNode) {\n    var attr;\n    var value;\n    var lcName;\n    var l;\n    /* Execute a hook if present */\n\n    _executeHook('beforeSanitizeAttributes', currentNode, null);\n\n    var attributes = currentNode.attributes;\n    /* Check if we have attributes; if not we might have a text node */\n\n    if (!attributes) {\n      return;\n    }\n\n    var hookEvent = {\n      attrName: '',\n      attrValue: '',\n      keepAttr: true,\n      allowedAttributes: ALLOWED_ATTR\n    };\n    l = attributes.length;\n    /* Go backwards over all attributes; safely remove bad ones */\n\n    while (l--) {\n      attr = attributes[l];\n      var _attr = attr,\n          name = _attr.name,\n          namespaceURI = _attr.namespaceURI;\n      value = name === 'value' ? attr.value : stringTrim(attr.value);\n      lcName = transformCaseFunc(name);\n      /* Execute a hook if present */\n\n      hookEvent.attrName = lcName;\n      hookEvent.attrValue = value;\n      hookEvent.keepAttr = true;\n      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n\n      _executeHook('uponSanitizeAttribute', currentNode, hookEvent);\n\n      value = hookEvent.attrValue;\n      /* Did the hooks approve of the attribute? */\n\n      if (hookEvent.forceKeepAttr) {\n        continue;\n      }\n      /* Remove attribute */\n\n\n      _removeAttribute(name, currentNode);\n      /* Did the hooks approve of the attribute? */\n\n\n      if (!hookEvent.keepAttr) {\n        continue;\n      }\n      /* Work around a security issue in jQuery 3.0 */\n\n\n      if (regExpTest(/\\/>/i, value)) {\n        _removeAttribute(name, currentNode);\n\n        continue;\n      }\n      /* Sanitize attribute content to be template-safe */\n\n\n      if (SAFE_FOR_TEMPLATES) {\n        value = stringReplace(value, MUSTACHE_EXPR$1, ' ');\n        value = stringReplace(value, ERB_EXPR$1, ' ');\n      }\n      /* Is `value` valid for this attribute? */\n\n\n      var lcTag = transformCaseFunc(currentNode.nodeName);\n\n      if (!_isValidAttribute(lcTag, lcName, value)) {\n        continue;\n      }\n      /* Full DOM Clobbering protection via namespace isolation,\n       * Prefix id and name attributes with `user-content-`\n       */\n\n\n      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n        // Remove the attribute with this value\n        _removeAttribute(name, currentNode); // Prefix the value and later re-create the attribute with the sanitized value\n\n\n        value = SANITIZE_NAMED_PROPS_PREFIX + value;\n      }\n      /* Handle attributes that require Trusted Types */\n\n\n      if (trustedTypesPolicy && _typeof(trustedTypes) === 'object' && typeof trustedTypes.getAttributeType === 'function') {\n        if (namespaceURI) ; else {\n          switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n            case 'TrustedHTML':\n              value = trustedTypesPolicy.createHTML(value);\n              break;\n\n            case 'TrustedScriptURL':\n              value = trustedTypesPolicy.createScriptURL(value);\n              break;\n          }\n        }\n      }\n      /* Handle invalid data-* attribute set by try-catching it */\n\n\n      try {\n        if (namespaceURI) {\n          currentNode.setAttributeNS(namespaceURI, name, value);\n        } else {\n          /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n          currentNode.setAttribute(name, value);\n        }\n\n        arrayPop(DOMPurify.removed);\n      } catch (_) {}\n    }\n    /* Execute a hook if present */\n\n\n    _executeHook('afterSanitizeAttributes', currentNode, null);\n  };\n  /**\n   * _sanitizeShadowDOM\n   *\n   * @param  {DocumentFragment} fragment to iterate over recursively\n   */\n\n\n  var _sanitizeShadowDOM = function _sanitizeShadowDOM(fragment) {\n    var shadowNode;\n\n    var shadowIterator = _createIterator(fragment);\n    /* Execute a hook if present */\n\n\n    _executeHook('beforeSanitizeShadowDOM', fragment, null);\n\n    while (shadowNode = shadowIterator.nextNode()) {\n      /* Execute a hook if present */\n      _executeHook('uponSanitizeShadowNode', shadowNode, null);\n      /* Sanitize tags and elements */\n\n\n      if (_sanitizeElements(shadowNode)) {\n        continue;\n      }\n      /* Deep shadow DOM detected */\n\n\n      if (shadowNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(shadowNode.content);\n      }\n      /* Check attributes, sanitize if necessary */\n\n\n      _sanitizeAttributes(shadowNode);\n    }\n    /* Execute a hook if present */\n\n\n    _executeHook('afterSanitizeShadowDOM', fragment, null);\n  };\n  /**\n   * Sanitize\n   * Public method providing core sanitation functionality\n   *\n   * @param {String|Node} dirty string or DOM node\n   * @param {Object} configuration object\n   */\n  // eslint-disable-next-line complexity\n\n\n  DOMPurify.sanitize = function (dirty) {\n    var cfg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var body;\n    var importedNode;\n    var currentNode;\n    var oldNode;\n    var returnNode;\n    /* Make sure we have a string to sanitize.\n      DO NOT return early, as this will return the wrong type if\n      the user has requested a DOM object rather than a string */\n\n    IS_EMPTY_INPUT = !dirty;\n\n    if (IS_EMPTY_INPUT) {\n      dirty = '<!-->';\n    }\n    /* Stringify, in case dirty is an object */\n\n\n    if (typeof dirty !== 'string' && !_isNode(dirty)) {\n      // eslint-disable-next-line no-negated-condition\n      if (typeof dirty.toString !== 'function') {\n        throw typeErrorCreate('toString is not a function');\n      } else {\n        dirty = dirty.toString();\n\n        if (typeof dirty !== 'string') {\n          throw typeErrorCreate('dirty is not a string, aborting');\n        }\n      }\n    }\n    /* Check we can run. Otherwise fall back or ignore */\n\n\n    if (!DOMPurify.isSupported) {\n      if (_typeof(window.toStaticHTML) === 'object' || typeof window.toStaticHTML === 'function') {\n        if (typeof dirty === 'string') {\n          return window.toStaticHTML(dirty);\n        }\n\n        if (_isNode(dirty)) {\n          return window.toStaticHTML(dirty.outerHTML);\n        }\n      }\n\n      return dirty;\n    }\n    /* Assign config vars */\n\n\n    if (!SET_CONFIG) {\n      _parseConfig(cfg);\n    }\n    /* Clean up removed elements */\n\n\n    DOMPurify.removed = [];\n    /* Check if dirty is correctly typed for IN_PLACE */\n\n    if (typeof dirty === 'string') {\n      IN_PLACE = false;\n    }\n\n    if (IN_PLACE) {\n      /* Do some early pre-sanitization to avoid unsafe root nodes */\n      if (dirty.nodeName) {\n        var tagName = transformCaseFunc(dirty.nodeName);\n\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n          throw typeErrorCreate('root node is forbidden and cannot be sanitized in-place');\n        }\n      }\n    } else if (dirty instanceof Node) {\n      /* If dirty is a DOM element, append to an empty document to avoid\n         elements being stripped by the parser */\n      body = _initDocument('<!---->');\n      importedNode = body.ownerDocument.importNode(dirty, true);\n\n      if (importedNode.nodeType === 1 && importedNode.nodeName === 'BODY') {\n        /* Node is already a body, use as is */\n        body = importedNode;\n      } else if (importedNode.nodeName === 'HTML') {\n        body = importedNode;\n      } else {\n        // eslint-disable-next-line unicorn/prefer-dom-node-append\n        body.appendChild(importedNode);\n      }\n    } else {\n      /* Exit directly if we have nothing to do */\n      if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT && // eslint-disable-next-line unicorn/prefer-includes\n      dirty.indexOf('<') === -1) {\n        return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;\n      }\n      /* Initialize the document to work on */\n\n\n      body = _initDocument(dirty);\n      /* Check we have a DOM node from the data */\n\n      if (!body) {\n        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n      }\n    }\n    /* Remove first element node (ours) if FORCE_BODY is set */\n\n\n    if (body && FORCE_BODY) {\n      _forceRemove(body.firstChild);\n    }\n    /* Get node iterator */\n\n\n    var nodeIterator = _createIterator(IN_PLACE ? dirty : body);\n    /* Now start iterating over the created document */\n\n\n    while (currentNode = nodeIterator.nextNode()) {\n      /* Fix IE's strange behavior with manipulated textNodes #89 */\n      if (currentNode.nodeType === 3 && currentNode === oldNode) {\n        continue;\n      }\n      /* Sanitize tags and elements */\n\n\n      if (_sanitizeElements(currentNode)) {\n        continue;\n      }\n      /* Shadow DOM detected, sanitize it */\n\n\n      if (currentNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(currentNode.content);\n      }\n      /* Check attributes, sanitize if necessary */\n\n\n      _sanitizeAttributes(currentNode);\n\n      oldNode = currentNode;\n    }\n\n    oldNode = null;\n    /* If we sanitized `dirty` in-place, return it. */\n\n    if (IN_PLACE) {\n      return dirty;\n    }\n    /* Return sanitized string or DOM */\n\n\n    if (RETURN_DOM) {\n      if (RETURN_DOM_FRAGMENT) {\n        returnNode = createDocumentFragment.call(body.ownerDocument);\n\n        while (body.firstChild) {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          returnNode.appendChild(body.firstChild);\n        }\n      } else {\n        returnNode = body;\n      }\n\n      if (ALLOWED_ATTR.shadowroot) {\n        /*\n          AdoptNode() is not used because internal state is not reset\n          (e.g. the past names map of a HTMLFormElement), this is safe\n          in theory but we would rather not risk another attack vector.\n          The state that is cloned by importNode() is explicitly defined\n          by the specs.\n        */\n        returnNode = importNode.call(originalDocument, returnNode, true);\n      }\n\n      return returnNode;\n    }\n\n    var serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n    /* Serialize doctype if allowed */\n\n    if (WHOLE_DOCUMENT && ALLOWED_TAGS['!doctype'] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {\n      serializedHTML = '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n    }\n    /* Sanitize final string template-safe */\n\n\n    if (SAFE_FOR_TEMPLATES) {\n      serializedHTML = stringReplace(serializedHTML, MUSTACHE_EXPR$1, ' ');\n      serializedHTML = stringReplace(serializedHTML, ERB_EXPR$1, ' ');\n    }\n\n    return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;\n  };\n  /**\n   * Public method to set the configuration once\n   * setConfig\n   *\n   * @param {Object} cfg configuration object\n   */\n\n\n  DOMPurify.setConfig = function (cfg) {\n    _parseConfig(cfg);\n\n    SET_CONFIG = true;\n  };\n  /**\n   * Public method to remove the configuration\n   * clearConfig\n   *\n   */\n\n\n  DOMPurify.clearConfig = function () {\n    CONFIG = null;\n    SET_CONFIG = false;\n  };\n  /**\n   * Public method to check if an attribute value is valid.\n   * Uses last set config, if any. Otherwise, uses config defaults.\n   * isValidAttribute\n   *\n   * @param  {string} tag Tag name of containing element.\n   * @param  {string} attr Attribute name.\n   * @param  {string} value Attribute value.\n   * @return {Boolean} Returns true if `value` is valid. Otherwise, returns false.\n   */\n\n\n  DOMPurify.isValidAttribute = function (tag, attr, value) {\n    /* Initialize shared config vars if necessary. */\n    if (!CONFIG) {\n      _parseConfig({});\n    }\n\n    var lcTag = transformCaseFunc(tag);\n    var lcName = transformCaseFunc(attr);\n    return _isValidAttribute(lcTag, lcName, value);\n  };\n  /**\n   * AddHook\n   * Public method to add DOMPurify hooks\n   *\n   * @param {String} entryPoint entry point for the hook to add\n   * @param {Function} hookFunction function to execute\n   */\n\n\n  DOMPurify.addHook = function (entryPoint, hookFunction) {\n    if (typeof hookFunction !== 'function') {\n      return;\n    }\n\n    hooks[entryPoint] = hooks[entryPoint] || [];\n    arrayPush(hooks[entryPoint], hookFunction);\n  };\n  /**\n   * RemoveHook\n   * Public method to remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if more are present)\n   *\n   * @param {String} entryPoint entry point for the hook to remove\n   * @return {Function} removed(popped) hook\n   */\n\n\n  DOMPurify.removeHook = function (entryPoint) {\n    if (hooks[entryPoint]) {\n      return arrayPop(hooks[entryPoint]);\n    }\n  };\n  /**\n   * RemoveHooks\n   * Public method to remove all DOMPurify hooks at a given entryPoint\n   *\n   * @param  {String} entryPoint entry point for the hooks to remove\n   */\n\n\n  DOMPurify.removeHooks = function (entryPoint) {\n    if (hooks[entryPoint]) {\n      hooks[entryPoint] = [];\n    }\n  };\n  /**\n   * RemoveAllHooks\n   * Public method to remove all DOMPurify hooks\n   *\n   */\n\n\n  DOMPurify.removeAllHooks = function () {\n    hooks = {};\n  };\n\n  return DOMPurify;\n}\n\nvar purify = createDOMPurify();\n\nexport { purify as default };\n//# sourceMappingURL=purify.es.js.map\n","/*! medium-zoom 1.0.6 | MIT License | https://github.com/francoischalifour/medium-zoom */\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar isSupported = function isSupported(node) {\n  return node.tagName === 'IMG';\n};\n\n/* eslint-disable-next-line no-prototype-builtins */\nvar isNodeList = function isNodeList(selector) {\n  return NodeList.prototype.isPrototypeOf(selector);\n};\n\nvar isNode = function isNode(selector) {\n  return selector && selector.nodeType === 1;\n};\n\nvar isSvg = function isSvg(image) {\n  var source = image.currentSrc || image.src;\n  return source.substr(-4).toLowerCase() === '.svg';\n};\n\nvar getImagesFromSelector = function getImagesFromSelector(selector) {\n  try {\n    if (Array.isArray(selector)) {\n      return selector.filter(isSupported);\n    }\n\n    if (isNodeList(selector)) {\n      // Do not use spread operator or Array.from() for IE support\n      return [].slice.call(selector).filter(isSupported);\n    }\n\n    if (isNode(selector)) {\n      return [selector].filter(isSupported);\n    }\n\n    if (typeof selector === 'string') {\n      // Do not use spread operator or Array.from() for IE support\n      return [].slice.call(document.querySelectorAll(selector)).filter(isSupported);\n    }\n\n    return [];\n  } catch (err) {\n    throw new TypeError('The provided selector is invalid.\\n' + 'Expects a CSS selector, a Node element, a NodeList or an array.\\n' + 'See: https://github.com/francoischalifour/medium-zoom');\n  }\n};\n\nvar createOverlay = function createOverlay(background) {\n  var overlay = document.createElement('div');\n  overlay.classList.add('medium-zoom-overlay');\n  overlay.style.background = background;\n\n  return overlay;\n};\n\nvar cloneTarget = function cloneTarget(template) {\n  var _template$getBounding = template.getBoundingClientRect(),\n      top = _template$getBounding.top,\n      left = _template$getBounding.left,\n      width = _template$getBounding.width,\n      height = _template$getBounding.height;\n\n  var clone = template.cloneNode();\n  var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\n  var scrollLeft = window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0;\n\n  clone.removeAttribute('id');\n  clone.style.position = 'absolute';\n  clone.style.top = top + scrollTop + 'px';\n  clone.style.left = left + scrollLeft + 'px';\n  clone.style.width = width + 'px';\n  clone.style.height = height + 'px';\n  clone.style.transform = '';\n\n  return clone;\n};\n\nvar createCustomEvent = function createCustomEvent(type, params) {\n  var eventParams = _extends({\n    bubbles: false,\n    cancelable: false,\n    detail: undefined\n  }, params);\n\n  if (typeof window.CustomEvent === 'function') {\n    return new CustomEvent(type, eventParams);\n  }\n\n  var customEvent = document.createEvent('CustomEvent');\n  customEvent.initCustomEvent(type, eventParams.bubbles, eventParams.cancelable, eventParams.detail);\n\n  return customEvent;\n};\n\nvar mediumZoom = function mediumZoom(selector) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  /**\n   * Ensure the compatibility with IE11 if no Promise polyfill are used.\n   */\n  var Promise = window.Promise || function Promise(fn) {\n    function noop() {}\n    fn(noop, noop);\n  };\n\n  var _handleClick = function _handleClick(event) {\n    var target = event.target;\n\n\n    if (target === overlay) {\n      close();\n      return;\n    }\n\n    if (images.indexOf(target) === -1) {\n      return;\n    }\n\n    toggle({ target: target });\n  };\n\n  var _handleScroll = function _handleScroll() {\n    if (isAnimating || !active.original) {\n      return;\n    }\n\n    var currentScroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\n\n    if (Math.abs(scrollTop - currentScroll) > zoomOptions.scrollOffset) {\n      setTimeout(close, 150);\n    }\n  };\n\n  var _handleKeyUp = function _handleKeyUp(event) {\n    var key = event.key || event.keyCode;\n\n    // Close if escape key is pressed\n    if (key === 'Escape' || key === 'Esc' || key === 27) {\n      close();\n    }\n  };\n\n  var update = function update() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    var newOptions = options;\n\n    if (options.background) {\n      overlay.style.background = options.background;\n    }\n\n    if (options.container && options.container instanceof Object) {\n      newOptions.container = _extends({}, zoomOptions.container, options.container);\n    }\n\n    if (options.template) {\n      var template = isNode(options.template) ? options.template : document.querySelector(options.template);\n\n      newOptions.template = template;\n    }\n\n    zoomOptions = _extends({}, zoomOptions, newOptions);\n\n    images.forEach(function (image) {\n      image.dispatchEvent(createCustomEvent('medium-zoom:update', {\n        detail: { zoom: zoom }\n      }));\n    });\n\n    return zoom;\n  };\n\n  var clone = function clone() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return mediumZoom(_extends({}, zoomOptions, options));\n  };\n\n  var attach = function attach() {\n    for (var _len = arguments.length, selectors = Array(_len), _key = 0; _key < _len; _key++) {\n      selectors[_key] = arguments[_key];\n    }\n\n    var newImages = selectors.reduce(function (imagesAccumulator, currentSelector) {\n      return [].concat(imagesAccumulator, getImagesFromSelector(currentSelector));\n    }, []);\n\n    newImages.filter(function (newImage) {\n      return images.indexOf(newImage) === -1;\n    }).forEach(function (newImage) {\n      images.push(newImage);\n      newImage.classList.add('medium-zoom-image');\n    });\n\n    eventListeners.forEach(function (_ref) {\n      var type = _ref.type,\n          listener = _ref.listener,\n          options = _ref.options;\n\n      newImages.forEach(function (image) {\n        image.addEventListener(type, listener, options);\n      });\n    });\n\n    return zoom;\n  };\n\n  var detach = function detach() {\n    for (var _len2 = arguments.length, selectors = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      selectors[_key2] = arguments[_key2];\n    }\n\n    if (active.zoomed) {\n      close();\n    }\n\n    var imagesToDetach = selectors.length > 0 ? selectors.reduce(function (imagesAccumulator, currentSelector) {\n      return [].concat(imagesAccumulator, getImagesFromSelector(currentSelector));\n    }, []) : images;\n\n    imagesToDetach.forEach(function (image) {\n      image.classList.remove('medium-zoom-image');\n      image.dispatchEvent(createCustomEvent('medium-zoom:detach', {\n        detail: { zoom: zoom }\n      }));\n    });\n\n    images = images.filter(function (image) {\n      return imagesToDetach.indexOf(image) === -1;\n    });\n\n    return zoom;\n  };\n\n  var on = function on(type, listener) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    images.forEach(function (image) {\n      image.addEventListener('medium-zoom:' + type, listener, options);\n    });\n\n    eventListeners.push({ type: 'medium-zoom:' + type, listener: listener, options: options });\n\n    return zoom;\n  };\n\n  var off = function off(type, listener) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    images.forEach(function (image) {\n      image.removeEventListener('medium-zoom:' + type, listener, options);\n    });\n\n    eventListeners = eventListeners.filter(function (eventListener) {\n      return !(eventListener.type === 'medium-zoom:' + type && eventListener.listener.toString() === listener.toString());\n    });\n\n    return zoom;\n  };\n\n  var open = function open() {\n    var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        target = _ref2.target;\n\n    var _animate = function _animate() {\n      var container = {\n        width: document.documentElement.clientWidth,\n        height: document.documentElement.clientHeight,\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0\n      };\n      var viewportWidth = void 0;\n      var viewportHeight = void 0;\n\n      if (zoomOptions.container) {\n        if (zoomOptions.container instanceof Object) {\n          // The container is given as an object with properties like width, height, left, top\n          container = _extends({}, container, zoomOptions.container);\n\n          // We need to adjust custom options like container.right or container.bottom\n          viewportWidth = container.width - container.left - container.right - zoomOptions.margin * 2;\n          viewportHeight = container.height - container.top - container.bottom - zoomOptions.margin * 2;\n        } else {\n          // The container is given as an element\n          var zoomContainer = isNode(zoomOptions.container) ? zoomOptions.container : document.querySelector(zoomOptions.container);\n\n          var _zoomContainer$getBou = zoomContainer.getBoundingClientRect(),\n              _width = _zoomContainer$getBou.width,\n              _height = _zoomContainer$getBou.height,\n              _left = _zoomContainer$getBou.left,\n              _top = _zoomContainer$getBou.top;\n\n          container = _extends({}, container, {\n            width: _width,\n            height: _height,\n            left: _left,\n            top: _top\n          });\n        }\n      }\n\n      viewportWidth = viewportWidth || container.width - zoomOptions.margin * 2;\n      viewportHeight = viewportHeight || container.height - zoomOptions.margin * 2;\n\n      var zoomTarget = active.zoomedHd || active.original;\n      var naturalWidth = isSvg(zoomTarget) ? viewportWidth : zoomTarget.naturalWidth || viewportWidth;\n      var naturalHeight = isSvg(zoomTarget) ? viewportHeight : zoomTarget.naturalHeight || viewportHeight;\n\n      var _zoomTarget$getBoundi = zoomTarget.getBoundingClientRect(),\n          top = _zoomTarget$getBoundi.top,\n          left = _zoomTarget$getBoundi.left,\n          width = _zoomTarget$getBoundi.width,\n          height = _zoomTarget$getBoundi.height;\n\n      var scaleX = Math.min(naturalWidth, viewportWidth) / width;\n      var scaleY = Math.min(naturalHeight, viewportHeight) / height;\n      var scale = Math.min(scaleX, scaleY);\n      var translateX = (-left + (viewportWidth - width) / 2 + zoomOptions.margin + container.left) / scale;\n      var translateY = (-top + (viewportHeight - height) / 2 + zoomOptions.margin + container.top) / scale;\n      var transform = 'scale(' + scale + ') translate3d(' + translateX + 'px, ' + translateY + 'px, 0)';\n\n      active.zoomed.style.transform = transform;\n\n      if (active.zoomedHd) {\n        active.zoomedHd.style.transform = transform;\n      }\n    };\n\n    return new Promise(function (resolve) {\n      if (target && images.indexOf(target) === -1) {\n        resolve(zoom);\n        return;\n      }\n\n      var _handleOpenEnd = function _handleOpenEnd() {\n        isAnimating = false;\n        active.zoomed.removeEventListener('transitionend', _handleOpenEnd);\n        active.original.dispatchEvent(createCustomEvent('medium-zoom:opened', {\n          detail: { zoom: zoom }\n        }));\n\n        resolve(zoom);\n      };\n\n      if (active.zoomed) {\n        resolve(zoom);\n        return;\n      }\n\n      if (target) {\n        // The zoom was triggered manually via a click\n        active.original = target;\n      } else if (images.length > 0) {\nvar _images = images;\n        active.original = _images[0];\n      } else {\n        resolve(zoom);\n        return;\n      }\n\n      active.original.dispatchEvent(createCustomEvent('medium-zoom:open', {\n        detail: { zoom: zoom }\n      }));\n\n      scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\n      isAnimating = true;\n      active.zoomed = cloneTarget(active.original);\n\n      document.body.appendChild(overlay);\n\n      if (zoomOptions.template) {\n        var template = isNode(zoomOptions.template) ? zoomOptions.template : document.querySelector(zoomOptions.template);\n        active.template = document.createElement('div');\n        active.template.appendChild(template.content.cloneNode(true));\n\n        document.body.appendChild(active.template);\n      }\n\n      document.body.appendChild(active.zoomed);\n\n      window.requestAnimationFrame(function () {\n        document.body.classList.add('medium-zoom--opened');\n      });\n\n      active.original.classList.add('medium-zoom-image--hidden');\n      active.zoomed.classList.add('medium-zoom-image--opened');\n\n      active.zoomed.addEventListener('click', close);\n      active.zoomed.addEventListener('transitionend', _handleOpenEnd);\n\n      if (active.original.getAttribute('data-zoom-src')) {\n        active.zoomedHd = active.zoomed.cloneNode();\n\n        // Reset the `scrset` property or the HD image won't load.\n        active.zoomedHd.removeAttribute('srcset');\n        active.zoomedHd.removeAttribute('sizes');\n\n        active.zoomedHd.src = active.zoomed.getAttribute('data-zoom-src');\n\n        active.zoomedHd.onerror = function () {\n          clearInterval(getZoomTargetSize);\n          console.warn('Unable to reach the zoom image target ' + active.zoomedHd.src);\n          active.zoomedHd = null;\n          _animate();\n        };\n\n        // We need to access the natural size of the full HD\n        // target as fast as possible to compute the animation.\n        var getZoomTargetSize = setInterval(function () {\n          if ( active.zoomedHd.complete) {\n            clearInterval(getZoomTargetSize);\n            active.zoomedHd.classList.add('medium-zoom-image--opened');\n            active.zoomedHd.addEventListener('click', close);\n            document.body.appendChild(active.zoomedHd);\n            _animate();\n          }\n        }, 10);\n      } else if (active.original.hasAttribute('srcset')) {\n        // If an image has a `srcset` attribuet, we don't know the dimensions of the\n        // zoomed (HD) image (like when `data-zoom-src` is specified).\n        // Therefore the approach is quite similar.\n        active.zoomedHd = active.zoomed.cloneNode();\n\n        // Resetting the sizes attribute tells the browser to load the\n        // image best fitting the current viewport size, respecting the `srcset`.\n        active.zoomedHd.removeAttribute('sizes');\n\n        // In Firefox, the `loading` attribute needs to be set to `eager` (default\n        // value) for the load event to be fired.\n        active.zoomedHd.removeAttribute('loading');\n\n        // Wait for the load event of the hd image. This will fire if the image\n        // is already cached.\n        var loadEventListener = active.zoomedHd.addEventListener('load', function () {\n          active.zoomedHd.removeEventListener('load', loadEventListener);\n          active.zoomedHd.classList.add('medium-zoom-image--opened');\n          active.zoomedHd.addEventListener('click', close);\n          document.body.appendChild(active.zoomedHd);\n          _animate();\n        });\n      } else {\n        _animate();\n      }\n    });\n  };\n\n  var close = function close() {\n    return new Promise(function (resolve) {\n      if (isAnimating || !active.original) {\n        resolve(zoom);\n        return;\n      }\n\n      var _handleCloseEnd = function _handleCloseEnd() {\n        active.original.classList.remove('medium-zoom-image--hidden');\n        document.body.removeChild(active.zoomed);\n        if (active.zoomedHd) {\n          document.body.removeChild(active.zoomedHd);\n        }\n        document.body.removeChild(overlay);\n        active.zoomed.classList.remove('medium-zoom-image--opened');\n        if (active.template) {\n          document.body.removeChild(active.template);\n        }\n\n        isAnimating = false;\n        active.zoomed.removeEventListener('transitionend', _handleCloseEnd);\n\n        active.original.dispatchEvent(createCustomEvent('medium-zoom:closed', {\n          detail: { zoom: zoom }\n        }));\n\n        active.original = null;\n        active.zoomed = null;\n        active.zoomedHd = null;\n        active.template = null;\n\n        resolve(zoom);\n      };\n\n      isAnimating = true;\n      document.body.classList.remove('medium-zoom--opened');\n      active.zoomed.style.transform = '';\n\n      if (active.zoomedHd) {\n        active.zoomedHd.style.transform = '';\n      }\n\n      // Fade out the template so it's not too abrupt\n      if (active.template) {\n        active.template.style.transition = 'opacity 150ms';\n        active.template.style.opacity = 0;\n      }\n\n      active.original.dispatchEvent(createCustomEvent('medium-zoom:close', {\n        detail: { zoom: zoom }\n      }));\n\n      active.zoomed.addEventListener('transitionend', _handleCloseEnd);\n    });\n  };\n\n  var toggle = function toggle() {\n    var _ref3 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        target = _ref3.target;\n\n    if (active.original) {\n      return close();\n    }\n\n    return open({ target: target });\n  };\n\n  var getOptions = function getOptions() {\n    return zoomOptions;\n  };\n\n  var getImages = function getImages() {\n    return images;\n  };\n\n  var getZoomedImage = function getZoomedImage() {\n    return active.original;\n  };\n\n  var images = [];\n  var eventListeners = [];\n  var isAnimating = false;\n  var scrollTop = 0;\n  var zoomOptions = options;\n  var active = {\n    original: null,\n    zoomed: null,\n    zoomedHd: null,\n    template: null\n\n    // If the selector is omitted, it's replaced by the options\n  };if (Object.prototype.toString.call(selector) === '[object Object]') {\n    zoomOptions = selector;\n  } else if (selector || typeof selector === 'string' // to process empty string as a selector\n  ) {\n      attach(selector);\n    }\n\n  // Apply the default option values\n  zoomOptions = _extends({\n    margin: 0,\n    background: '#fff',\n    scrollOffset: 40,\n    container: null,\n    template: null\n  }, zoomOptions);\n\n  var overlay = createOverlay(zoomOptions.background);\n\n  document.addEventListener('click', _handleClick);\n  document.addEventListener('keyup', _handleKeyUp);\n  document.addEventListener('scroll', _handleScroll);\n  window.addEventListener('resize', close);\n\n  var zoom = {\n    open: open,\n    close: close,\n    toggle: toggle,\n    update: update,\n    clone: clone,\n    attach: attach,\n    detach: detach,\n    on: on,\n    off: off,\n    getOptions: getOptions,\n    getImages: getImages,\n    getZoomedImage: getZoomedImage\n  };\n\n  return zoom;\n};\n\nfunction styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css = \".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}\";\nstyleInject(css);\n\nexport default mediumZoom;\n","<template lang=\"pug\">\r\n.topsheets-finder.curate-content\r\n  top-sheet(v-for=\"sheet of topsheets\" :key=\"sheet\"\r\n    :fileSystemConfig=\"fileSystemConfig\"\r\n    :subfolder=\"subfolder\"\r\n    :files=\"files\"\r\n    :yaml=\"sheet\"\r\n    :allConfigFiles=\"allConfigFiles\"\r\n  )\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: { title: 'Key Performance Indicators' },\r\n  },\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\nimport type { PropType } from 'vue'\r\n\r\nimport { FileSystemConfig, YamlConfigs } from '@/Globals'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\nimport TopSheet from '@/components/TopSheet/TopSheet.vue'\r\n\r\nexport default defineComponent({\r\n  name: 'TopsheetsFinder',\r\n  i18n,\r\n  components: { TopSheet },\r\n  props: {\r\n    fileSystemConfig: { type: Object as PropType<FileSystemConfig>, required: true },\r\n    subfolder: { type: String, required: true },\r\n    files: { type: Array as PropType<string[]>, required: true },\r\n  },\r\n\r\n  computed: {\r\n    fileApi(): HTTPFileSystem {\r\n      return new HTTPFileSystem(this.fileSystemConfig)\r\n    },\r\n  },\r\n\r\n  data: () => {\r\n    return {\r\n      allConfigFiles: {} as YamlConfigs,\r\n      topsheets: [] as any[],\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    subfolder() {\r\n      this.filesUpdated()\r\n    },\r\n    files() {\r\n      this.filesUpdated()\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    async findTopsheetsForThisFolder(): Promise<string[]> {\r\n      this.allConfigFiles = await this.fileApi.findAllYamlConfigs(this.subfolder)\r\n      return Object.values(this.allConfigFiles.topsheets)\r\n    },\r\n    async filesUpdated() {\r\n      if (this.files.length) {\r\n        this.topsheets = await this.findTopsheetsForThisFolder()\r\n      }\r\n    },\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\nh3.curate-heading {\r\n  font-size: 1.8rem;\r\n  font-weight: bold;\r\n  color: var(--textFancy);\r\n  padding-top: 0.5rem;\r\n  margin-top: 0rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.curate-content {\r\n  padding: 1rem 0rem;\r\n  margin: 0rem 0rem;\r\n}\r\n\r\n.output-table {\r\n  width: 100%;\r\n  display: table;\r\n}\r\n\r\n.row {\r\n  display: table-row;\r\n}\r\n\r\n.cell {\r\n  padding-right: 1rem;\r\n  display: table-cell;\r\n  font-size: 1.1rem;\r\n}\r\n\r\n// .top-label {\r\n// }\r\n\r\n.top-value {\r\n  text-align: right;\r\n  font-weight: bold;\r\n}\r\n</style>\r\n","\r\n.topsheets-finder.curate-content\r\n  top-sheet(v-for=\"sheet of topsheets\" :key=\"sheet\"\r\n    :fileSystemConfig=\"fileSystemConfig\"\r\n    :subfolder=\"subfolder\"\r\n    :files=\"files\"\r\n    :yaml=\"sheet\"\r\n    :allConfigFiles=\"allConfigFiles\"\r\n  )\r\n\r\n","<template lang=\"pug\">\r\n.folder-browser\r\n\r\n  //- show network errors\r\n  .stripe.details(v-if=\"myState.errorStatus\")\r\n   .vessel\r\n    .badnews(v-html=\"myState.errorStatus\")\r\n\r\n  //- main content\r\n  .stripe.details(v-else)\r\n   .vessel\r\n\r\n    //- these are sections defined by viz-summary.yml etc\r\n    .curated-sections\r\n\r\n      b.up-link: a(@click=\"$emit('up')\") ^ UP\r\n\r\n      //- this is the content of readme.md, if it exists\r\n      .readme-header.markdown\r\n        .curate-content.markdown(\r\n          v-if=\"myState.readme\"\r\n          v-html=\"myState.readme\"\r\n        )\r\n\r\n      //- file system folders\r\n      h3.curate-heading(v-if=\"myState.folders.length\")  {{ $t('Folders') }}\r\n\r\n      .curate-content(v-if=\"myState.folders.length\")\r\n        .folder-table\r\n          .folder(:class=\"{fade: myState.isLoading}\"\r\n                  :key=\"folder.name\"\r\n                  v-for=\"folder in myState.folders\"\r\n                  @click=\"openOutputFolder(folder)\")\r\n            p\r\n              i.fa.fa-folder-open\r\n              | &nbsp;{{ cleanName(folder) }}\r\n\r\n      //- MAPS: thumbnails of each viz map here\r\n      .section-maps(v-if=\"Object.keys(vizMaps).length\")\r\n        h3.curate-heading {{ $t('Maps')}}\r\n        .curate-content\r\n          .viz-table\r\n            .viz-grid-item(v-for=\"[index, viz] of Object.entries(vizMaps)\" :key=\"index\"\r\n                      @click=\"clickedVisualization(index)\")\r\n\r\n              .viz-frame\r\n                p.v-title: b {{ viz.title }}\r\n                p.v-filename {{ viz.config }}\r\n                p.v-plugin(:style=\"getTabColor(viz.component)\") {{ viz.component || 'dashboard' }}\r\n                component.viz-frame-component(\r\n                      v-show=\"false\"\r\n                      :is=\"viz.component\"\r\n                      :root=\"myState.svnProject.slug\"\r\n                      :subfolder=\"myState.subfolder\"\r\n                      :yamlConfig=\"viz.config\"\r\n                      :thumbnail=\"true\"\r\n                      :fileApi=\"myState.svnRoot\"\r\n                      :style=\"{'pointer-events': 'none'}\"\r\n                      @title=\"updateTitle(index, $event)\")\r\n\r\n      //- IMAGES here\r\n      .section-images(v-if=\"Object.keys(vizImages).length\")\r\n        h3.curate-heading {{ $t('Images')}}\r\n        .curate-content\r\n          .viz-image-table\r\n            .viz-image-grid-item(v-for=\"[index, viz] of Object.entries(vizImages)\" :key=\"index\"\r\n                      @click=\"clickedVisualization(index)\")\r\n\r\n              .viz-image-frame\r\n                component.viz-image-frame-component(\r\n                      :is=\"viz.component\"\r\n                      :root=\"myState.svnProject.slug\"\r\n                      :subfolder=\"myState.subfolder\"\r\n                      :yamlConfig=\"viz.config\"\r\n                      :thumbnail=\"true\"\r\n                      :fileApi=\"myState.svnRoot\"\r\n                      :style=\"{'pointer-events': 'auto'}\"\r\n                      @title=\"updateTitle(index, $event)\")\r\n                p {{ viz.title }}\r\n\r\n      //- FILES: individual links to files in this folder\r\n      //- this is DISABLED for Chrome API for now, because we\r\n      //- can't download those files via regular URL\r\n      .files-section(v-if=\"myState?.svnProject?.baseURL\")\r\n        h3.curate-heading(v-if=\"myState.files.length\") {{$t('Files')}}\r\n\r\n        .curate-content(v-if=\"myState.files.length\")\r\n          .file-table\r\n            .file(v-for=\"file in myState.files\" :key=\"file\"\r\n              :class=\"{fade: myState.isLoading}\"\r\n            )\r\n              a(:href=\"`${myState.svnProject.baseURL}/${myState.subfolder}/${file}`\") {{ cleanName(file) }}\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      Maps: 'Maps',\r\n      Images: 'Images',\r\n      Analysis: 'Analysis',\r\n      Files: 'Files',\r\n      Folders: 'Folders',\r\n      Topsheet: 'Topsheet',\r\n    },\r\n    de: {\r\n      Maps: 'Karten',\r\n      Images: 'Bilder',\r\n      Analysis: 'Ergebnisse',\r\n      Files: 'Dateien',\r\n      Folders: 'Ordner',\r\n      Topsheet: 'Topsheet',\r\n    },\r\n  },\r\n}\r\n\r\ninterface VizEntry {\r\n  component: string\r\n  config: string\r\n  title: string\r\n}\r\n\r\ninterface IMyState {\r\n  errorStatus: string\r\n  folders: string[]\r\n  files: string[]\r\n  isLoading: boolean\r\n  readme: string\r\n  svnProject: FileSystemConfig | null\r\n  svnRoot?: HTTPFileSystem\r\n  subfolder: string\r\n  summary: boolean\r\n  vizes: VizEntry[]\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\nimport type { PropType } from 'vue'\r\n\r\nimport markdown from 'markdown-it'\r\nimport mediumZoom from 'medium-zoom'\r\nimport micromatch from 'micromatch'\r\nimport yaml from 'yaml'\r\n\r\nimport globalStore from '@/store'\r\nimport plugins from '@/plugins/pluginRegistry'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\nimport { BreadCrumb, FileSystemConfig, YamlConfigs } from '@/Globals'\r\nimport TopsheetsFinder from '@/components/TopsheetsFinder/TopsheetsFinder.vue'\r\n\r\nconst tabColors = {\r\n  // blank means dashboard:\r\n  '': '#118860',\r\n  // others are kebab-case:\r\n  'aggregate-od': '#E98B52',\r\n  'vehicle-anim': '#330033',\r\n  'x-y-t': '#583270',\r\n  'carrier-viewer': '#c97A2C',\r\n  events: '#4400ff',\r\n  hexagons: '#900564',\r\n  'area-map': '#c94264',\r\n  network: '#894654',\r\n  sankey: '#D8A672',\r\n  summary: '#2EA95B',\r\n  transit: '#3B6FE4',\r\n} as any\r\n\r\nconst allComponents = Object.assign({ TopsheetsFinder }, plugins)\r\n\r\nexport default defineComponent({\r\n  name: 'FolderBrowser',\r\n  i18n,\r\n  components: allComponents,\r\n  props: {\r\n    root: { type: String, required: true },\r\n    allConfigFiles: { type: Object as PropType<YamlConfigs>, required: true },\r\n    xsubfolder: String,\r\n  },\r\n  data: () => {\r\n    return {\r\n      globalState: globalStore.state,\r\n      summaryYamlFilename: 'viz-summary.yml',\r\n      mdRenderer: new markdown({\r\n        html: true,\r\n        linkify: true,\r\n        typographer: true,\r\n      }),\r\n      myState: {\r\n        errorStatus: '',\r\n        folders: [],\r\n        files: [],\r\n        isLoading: false,\r\n        readme: '',\r\n        svnProject: null,\r\n        svnRoot: undefined,\r\n        subfolder: '',\r\n        vizes: [],\r\n        summary: false,\r\n      } as IMyState,\r\n    }\r\n  },\r\n  computed: {\r\n    vizImages(): any {\r\n      const images: { [index: number]: any } = {}\r\n      for (let i = 0; i < this.myState.vizes.length; i++) {\r\n        if (this.myState.vizes[i].component === 'image-view') {\r\n          images[i] = this.myState.vizes[i]\r\n        }\r\n      }\r\n      return images\r\n    },\r\n\r\n    vizMaps(): any {\r\n      const maps: { [index: number]: any } = {}\r\n      for (let i = 0; i < this.myState.vizes.length; i++) {\r\n        if (this.myState.vizes[i].component !== 'image-view') {\r\n          maps[i] = this.myState.vizes[i]\r\n        }\r\n      }\r\n      return maps\r\n    },\r\n  },\r\n  methods: {\r\n    cleanName(text: string) {\r\n      return decodeURIComponent(text)\r\n    },\r\n\r\n    getFileSystem(name: string) {\r\n      const svnProject: FileSystemConfig[] = globalStore.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === name\r\n      )\r\n\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n\r\n      return svnProject[0]\r\n    },\r\n\r\n    generateBreadcrumbs() {\r\n      if (!this.myState.svnProject) return []\r\n\r\n      const crumbs = [\r\n        {\r\n          label: 'SimWrapper',\r\n          url: '/',\r\n        },\r\n        {\r\n          label: this.myState.svnProject.name,\r\n          url: '/' + this.myState.svnProject.slug,\r\n        },\r\n      ]\r\n\r\n      const subfolders = this.myState.subfolder.split('/')\r\n      let buildFolder = '/'\r\n      for (const folder of subfolders) {\r\n        if (!folder) continue\r\n\r\n        buildFolder += folder + '/'\r\n        crumbs.push({\r\n          label: folder,\r\n          url: '/' + this.myState.svnProject.slug + buildFolder,\r\n        })\r\n      }\r\n\r\n      // save them!\r\n      globalStore.commit('setBreadCrumbs', crumbs)\r\n      return crumbs\r\n    },\r\n\r\n    clickedVisualization(vizNumber: number) {\r\n      const viz = this.myState.vizes[vizNumber]\r\n\r\n      // special case: images don't click thru\r\n      if (viz.component === 'image-view') return\r\n\r\n      if (!this.myState.svnProject) return\r\n\r\n      const props = {\r\n        root: this.myState.svnProject.slug,\r\n        xsubfolder: this.myState.subfolder,\r\n        subfolder: this.myState.subfolder,\r\n        yamlConfig: viz.config,\r\n        thumbnail: false,\r\n      }\r\n\r\n      this.$emit('navigate', { component: viz.component, props })\r\n    },\r\n\r\n    updateTitle(viz: number, title: string) {\r\n      this.myState.vizes[viz].title = title\r\n    },\r\n\r\n    async showReadme() {\r\n      this.myState.readme = ''\r\n      const readme = 'readme.md'\r\n      if (this.myState.files.map(f => f.toLocaleLowerCase()).indexOf(readme) > -1) {\r\n        if (!this.myState.svnRoot) return\r\n        const text = await this.myState.svnRoot.getFileText(this.myState.subfolder + '/' + readme)\r\n        this.myState.readme = this.mdRenderer.render(text)\r\n      }\r\n    },\r\n\r\n    buildShowEverythingView() {\r\n      // loop on each viz type\r\n      for (const viz of this.globalState.visualizationTypes.values()) {\r\n        // match based on file patterns registered for each viz\r\n        const matches = micromatch(this.myState.files, viz.filePatterns, { nocase: true })\r\n        for (const file of matches) {\r\n          // add thumbnail for each matching file\r\n          this.myState.vizes.push({ component: viz.kebabName, config: file, title: '..' })\r\n        }\r\n      }\r\n    },\r\n\r\n    // Curate the view, if viz-summary.yml exists\r\n    async buildCuratedSummaryView() {\r\n      if (!this.myState.svnRoot) return\r\n\r\n      const summaryYaml = yaml.parse(\r\n        await this.myState.svnRoot.getFileText(\r\n          this.myState.subfolder + '/' + this.summaryYamlFilename\r\n        )\r\n      )\r\n\r\n      // loop on each curated viz type\r\n      for (const vizName of summaryYaml.plugins) {\r\n        // load plugin user asked for\r\n        const viz = this.globalState.visualizationTypes.get(vizName)\r\n        if (!viz) continue\r\n\r\n        // curate file list if provided for this plugin\r\n        if (summaryYaml[viz.kebabName]) {\r\n          for (const pattern of summaryYaml[viz.kebabName]) {\r\n            // add thumbnail for each matching file\r\n            const matches = await this.findMatchingFiles(pattern)\r\n            for (const file of matches) {\r\n              this.myState.vizes.push({ component: viz.kebabName, config: file, title: file })\r\n            }\r\n          }\r\n        } else {\r\n          // filter based on file matching\r\n          const matches = micromatch(this.myState.files, viz.filePatterns)\r\n          for (const file of matches) {\r\n            // add thumbnail for each matching file\r\n            this.myState.vizes.push({ component: viz.kebabName, config: file, title: '..' })\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    async findMatchingFiles(glob: string): Promise<string[]> {\r\n      // first see if file itself is in this folder\r\n      if (this.myState.files.indexOf(glob) > -1) return [glob]\r\n\r\n      // return globs in this folder\r\n      const matches = micromatch(this.myState.files, glob)\r\n      if (matches.length) return matches\r\n\r\n      // search subfolder for glob, for now just one subfolder down\r\n      if (!this.myState.svnRoot) return []\r\n      try {\r\n        const split = glob.split('/')\r\n        const subsubfolder = this.myState.subfolder + '/' + split[0]\r\n        console.log(subsubfolder)\r\n        const contents = await this.myState.svnRoot.getDirectory(subsubfolder)\r\n        const matches = micromatch(contents.files, split[1])\r\n        return matches.map(f => split[0] + '/' + f)\r\n      } catch (e) {\r\n        // oh well, we tried\r\n      }\r\n\r\n      return []\r\n    },\r\n\r\n    async fetchFolderContents() {\r\n      if (!this.myState.svnRoot) return []\r\n\r\n      this.myState.isLoading = true\r\n      this.myState.errorStatus = ''\r\n      this.myState.files = []\r\n\r\n      try {\r\n        const folderContents = await this.myState.svnRoot.getDirectory(this.myState.subfolder)\r\n\r\n        // hide dot folders\r\n        const folders = folderContents.dirs.filter(f => !f.startsWith('.')).sort()\r\n        const files = folderContents.files.filter(f => !f.startsWith('.')).sort()\r\n\r\n        // Also show any project-level viz thumbnails from other folders\r\n        // (but, ensure that files in this folder supercede any project viz files\r\n        // with the same name)\r\n        const mergedFilesAndVizes = Object.assign({}, this.allConfigFiles.vizes)\r\n        for (const file of files) {\r\n          mergedFilesAndVizes[file] = file\r\n        }\r\n\r\n        const allVizes = Object.values(mergedFilesAndVizes)\r\n\r\n        this.myState.errorStatus = ''\r\n        this.myState.folders = folders\r\n        this.myState.files = allVizes\r\n      } catch (err) {\r\n        // Bad things happened! Tell user\r\n        const e = err as any\r\n        console.log('BAD PAGE')\r\n        console.log({ eeee: e })\r\n\r\n        this.myState.folders = []\r\n        this.myState.files = []\r\n\r\n        this.myState.errorStatus = '<h3>'\r\n        if (e.status) this.myState.errorStatus += `${e.status} `\r\n        if (e.statusText) this.myState.errorStatus += `${e.statusText}`\r\n        if (this.myState.errorStatus === '<h3>') this.myState.errorStatus += 'Error'\r\n        this.myState.errorStatus += `</h3>`\r\n        if (e.url) this.myState.errorStatus += `<p>${e.url}</p>`\r\n        if (e.message) this.myState.errorStatus += `<p>${e.message}</p>`\r\n        if (this.myState.errorStatus === '<h3>Error</h3>') this.myState.errorStatus = '' + e\r\n\r\n        if (this.myState.svnProject) {\r\n          this.myState.errorStatus += `<p><i>${this.myState.svnProject.baseURL}${this.myState.subfolder}</i></p>`\r\n        }\r\n\r\n        // maybe it failed because password?\r\n        if (this.myState.svnProject && this.myState.svnProject.needPassword && e.status === 401) {\r\n          globalStore.commit('requestLogin', this.myState.svnProject.slug)\r\n        }\r\n      } finally {\r\n        this.myState.isLoading = false\r\n      }\r\n    },\r\n\r\n    openOutputFolder(folder: string) {\r\n      if (this.myState.isLoading) return\r\n      if (!this.myState.svnProject) return\r\n\r\n      const target =\r\n        folder === '..'\r\n          ? this.myState.subfolder.substring(0, this.myState.subfolder.lastIndexOf('/'))\r\n          : this.myState.subfolder + '/' + folder\r\n\r\n      const props = {\r\n        root: this.myState.svnProject.slug,\r\n        xsubfolder: target,\r\n      }\r\n\r\n      // if we are at top of hierarchy, jump to splashpage\r\n      if (!target && !this.myState.subfolder) {\r\n        this.$emit('navigate', { component: 'SplashPage', props: {} })\r\n      } else {\r\n        this.$emit('navigate', { component: 'TabbedDashboardView', props })\r\n      }\r\n    },\r\n\r\n    getTabColor(kebabName: string) {\r\n      const color = tabColors[kebabName] || '#8778BB'\r\n      return { backgroundColor: color }\r\n    },\r\n\r\n    updateRoute() {\r\n      const svnProject = this.getFileSystem(this.root)\r\n\r\n      this.myState.svnProject = svnProject\r\n      this.myState.subfolder = this.xsubfolder || ''\r\n      this.myState.readme = ''\r\n\r\n      if (!this.myState.svnProject) return\r\n      this.myState.svnRoot = new HTTPFileSystem(this.myState.svnProject)\r\n\r\n      this.generateBreadcrumbs()\r\n\r\n      // this happens async\r\n      this.fetchFolderContents()\r\n    },\r\n  },\r\n  watch: {\r\n    'globalState.colorScheme'() {\r\n      // medium-zoom freaks out if color theme is swapped.\r\n      // so let's reload images just in case.\r\n      this.fetchFolderContents()\r\n    },\r\n    xsubfolder() {\r\n      this.updateRoute()\r\n    },\r\n    allConfigFiles() {\r\n      this.updateRoute()\r\n    },\r\n    'globalState.authAttempts'() {\r\n      console.log('AUTH CHANGED - Reload')\r\n      this.updateRoute()\r\n    },\r\n    async 'myState.files'() {\r\n      // clear visualizations\r\n      this.myState.vizes = []\r\n      if (this.myState.files.length === 0) return\r\n\r\n      this.showReadme()\r\n\r\n      this.myState.summary = this.myState.files.indexOf(this.summaryYamlFilename) !== -1\r\n\r\n      if (this.myState.summary) {\r\n        await this.buildCuratedSummaryView()\r\n      } else {\r\n        this.buildShowEverythingView()\r\n      }\r\n\r\n      // make sure page is rendered before we attach zoom semantics\r\n      await this.$nextTick()\r\n      mediumZoom('.medium-zoom', {\r\n        background: '#444450',\r\n      })\r\n    },\r\n  },\r\n  mounted() {\r\n    this.updateRoute()\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.vessel {\r\n  margin: 0 auto;\r\n  padding: 0rem 0rem 2rem 0rem;\r\n  max-width: $dashboardWidth + 3;\r\n}\r\n\r\n.white {\r\n  background-color: var(--bgBold);\r\n}\r\n\r\n.cream {\r\n  background-color: var(--bgCream);\r\n}\r\n\r\nh2 {\r\n  font-size: 1.8rem;\r\n}\r\n\r\nh3,\r\nh4 {\r\n  margin-top: 2rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.badnews {\r\n  border-left: 3rem solid #af232f;\r\n  margin: 0rem 0rem;\r\n  padding: 0.5rem 0rem;\r\n  background-color: #ffc;\r\n  color: $matsimBlue;\r\n}\r\n\r\n.viz-table {\r\n  display: flex;\r\n  flex-direction: column;\r\n  list-style: none;\r\n}\r\n\r\n.viz-grid-item {\r\n  z-index: 1;\r\n  // text-align: center;\r\n  margin: 4px 0;\r\n  padding: 0 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  cursor: pointer;\r\n  vertical-align: top;\r\n  background-color: var(--bgBrowser);\r\n  // border: var(--borderThin);\r\n  border-radius: 5px;\r\n}\r\n\r\n.viz-frame {\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: column;\r\n  z-index: 1;\r\n  flex: 1;\r\n  overflow: hidden;\r\n  padding: 5px 0 0 5px;\r\n  border-radius: 3px;\r\n  p {\r\n    margin: 0 0 0 0;\r\n    line-height: 1rem;\r\n    padding: 0 0;\r\n    color: var(--text);\r\n    word-wrap: break-word;\r\n    /* Required for text-overflow to do anything */\r\n    // text-overflow: ellipsis;\r\n    // white-space: nowrap;\r\n    // overflow: hidden;\r\n  }\r\n}\r\n\r\n.viz-frame:hover {\r\n  // box-shadow: var(--shadowMode);\r\n  background-color: var(--bgHover);\r\n  border-radius: 5px;\r\n  transition: background-color 0.02s ease-in-out;\r\n}\r\n\r\n.viz-frame-component {\r\n  background-color: var(--bgPanel);\r\n}\r\n\r\n.logo {\r\n  margin-left: auto;\r\n}\r\n\r\n.folder-table {\r\n  display: grid;\r\n  row-gap: 0rem;\r\n  column-gap: 1rem;\r\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\r\n  list-style: none;\r\n  margin-bottom: 0px;\r\n  padding-left: 0px;\r\n}\r\n\r\n.folder {\r\n  cursor: pointer;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background-color: var(--bgBrowser);\r\n  margin: 0.25rem 0rem;\r\n  padding: 0.75rem 1rem;\r\n  border-radius: 8px;\r\n  word-wrap: break-word;\r\n}\r\n\r\n.folder:hover {\r\n  background-color: var(--bgHover);\r\n  // box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.08), 0 3px 10px 0 rgba(0, 0, 0, 0.08);\r\n  transition: background-color 0.1s ease-in-out;\r\n}\r\n\r\n.project-bar {\r\n  display: flex;\r\n  margin-bottom: 1rem;\r\n  padding: 2rem 0 0 0;\r\n  z-index: 10000;\r\n}\r\n\r\n.project-bar p {\r\n  margin-top: -0.25rem;\r\n}\r\n\r\n.fade {\r\n  opacity: 0.4;\r\n  pointer-events: none;\r\n}\r\n\r\n.file-table {\r\n  display: grid;\r\n  row-gap: 0rem;\r\n  column-gap: 1rem;\r\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\r\n}\r\n\r\n.file {\r\n  word-break: break-all;\r\n  line-height: 1rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.markdown {\r\n  padding: 1rem 0rem;\r\n}\r\n\r\n.curated-sections {\r\n  padding-top: 0rem;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.curate-heading {\r\n  padding: 0rem 0rem;\r\n  margin: 0rem 0rem;\r\n}\r\n\r\n.readme-header {\r\n  font-size: 1.1rem;\r\n  padding-bottom: 1rem;\r\n}\r\n\r\nh3.curate-heading {\r\n  font-size: 1.8rem;\r\n  font-weight: bold;\r\n  color: var(--textFancy);\r\n  padding-top: 0.5rem;\r\n  margin-top: 0rem;\r\n}\r\n\r\n.curate-content {\r\n  padding: 1rem 0rem;\r\n  margin: 0rem 0rem;\r\n}\r\n\r\n.viz-image-table {\r\n  display: grid;\r\n  grid-gap: 2rem;\r\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\r\n  list-style: none;\r\n}\r\n\r\n.viz-image-grid-item {\r\n  z-index: 1;\r\n  text-align: center;\r\n  margin: 0 0;\r\n  padding: 0 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  cursor: pointer;\r\n  vertical-align: top;\r\n  background-color: var(--bgBold);\r\n  border: var(--borderThin);\r\n  border-radius: 16px;\r\n}\r\n\r\n.viz-image-frame {\r\n  position: relative;\r\n  z-index: 1;\r\n  flex: 1;\r\n  min-height: $thumbnailHeight;\r\n  border-radius: 16px;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n\r\n  p {\r\n    margin: auto 0 0 0;\r\n    background-color: var(--bgDashboard);\r\n    font-size: 1rem;\r\n    font-weight: bold;\r\n    line-height: 1.2rem;\r\n    padding: 1rem 0.5rem;\r\n    color: var(--text);\r\n    word-wrap: break-word;\r\n    /* Required for text-overflow to do anything */\r\n    // text-overflow: ellipsis;\r\n    // white-space: nowrap;\r\n    // overflow: hidden;\r\n  }\r\n}\r\n\r\n.viz-image-frame:hover {\r\n  box-shadow: var(--shadowMode);\r\n  transition: box-shadow 0.1s ease-in-out;\r\n}\r\n\r\n.viz-image-frame-component {\r\n  background-color: var(--bgPanel);\r\n}\r\n\r\n.folder-browser {\r\n  background-color: var(--bgMapPanel);\r\n  padding: 0 3rem;\r\n}\r\n\r\n// p.v-title {\r\n//   // font-size: 1rem;\r\n// }\r\n\r\np.v-filename {\r\n  margin: 5px 0;\r\n}\r\n\r\np.v-plugin {\r\n  text-align: right;\r\n  text-transform: uppercase;\r\n  margin-left: auto;\r\n  color: white;\r\n  background-color: var(--bgCream3);\r\n  padding: 2px 3px;\r\n  border-radius: 0 0 4px 0;\r\n}\r\n</style>\r\n","\r\n.folder-browser\r\n\r\n  //- show network errors\r\n  .stripe.details(v-if=\"myState.errorStatus\")\r\n   .vessel\r\n    .badnews(v-html=\"myState.errorStatus\")\r\n\r\n  //- main content\r\n  .stripe.details(v-else)\r\n   .vessel\r\n\r\n    //- these are sections defined by viz-summary.yml etc\r\n    .curated-sections\r\n\r\n      b.up-link: a(@click=\"$emit('up')\") ^ UP\r\n\r\n      //- this is the content of readme.md, if it exists\r\n      .readme-header.markdown\r\n        .curate-content.markdown(\r\n          v-if=\"myState.readme\"\r\n          v-html=\"myState.readme\"\r\n        )\r\n\r\n      //- file system folders\r\n      h3.curate-heading(v-if=\"myState.folders.length\")  {{ $t('Folders') }}\r\n\r\n      .curate-content(v-if=\"myState.folders.length\")\r\n        .folder-table\r\n          .folder(:class=\"{fade: myState.isLoading}\"\r\n                  :key=\"folder.name\"\r\n                  v-for=\"folder in myState.folders\"\r\n                  @click=\"openOutputFolder(folder)\")\r\n            p\r\n              i.fa.fa-folder-open\r\n              | &nbsp;{{ cleanName(folder) }}\r\n\r\n      //- MAPS: thumbnails of each viz map here\r\n      .section-maps(v-if=\"Object.keys(vizMaps).length\")\r\n        h3.curate-heading {{ $t('Maps')}}\r\n        .curate-content\r\n          .viz-table\r\n            .viz-grid-item(v-for=\"[index, viz] of Object.entries(vizMaps)\" :key=\"index\"\r\n                      @click=\"clickedVisualization(index)\")\r\n\r\n              .viz-frame\r\n                p.v-title: b {{ viz.title }}\r\n                p.v-filename {{ viz.config }}\r\n                p.v-plugin(:style=\"getTabColor(viz.component)\") {{ viz.component || 'dashboard' }}\r\n                component.viz-frame-component(\r\n                      v-show=\"false\"\r\n                      :is=\"viz.component\"\r\n                      :root=\"myState.svnProject.slug\"\r\n                      :subfolder=\"myState.subfolder\"\r\n                      :yamlConfig=\"viz.config\"\r\n                      :thumbnail=\"true\"\r\n                      :fileApi=\"myState.svnRoot\"\r\n                      :style=\"{'pointer-events': 'none'}\"\r\n                      @title=\"updateTitle(index, $event)\")\r\n\r\n      //- IMAGES here\r\n      .section-images(v-if=\"Object.keys(vizImages).length\")\r\n        h3.curate-heading {{ $t('Images')}}\r\n        .curate-content\r\n          .viz-image-table\r\n            .viz-image-grid-item(v-for=\"[index, viz] of Object.entries(vizImages)\" :key=\"index\"\r\n                      @click=\"clickedVisualization(index)\")\r\n\r\n              .viz-image-frame\r\n                component.viz-image-frame-component(\r\n                      :is=\"viz.component\"\r\n                      :root=\"myState.svnProject.slug\"\r\n                      :subfolder=\"myState.subfolder\"\r\n                      :yamlConfig=\"viz.config\"\r\n                      :thumbnail=\"true\"\r\n                      :fileApi=\"myState.svnRoot\"\r\n                      :style=\"{'pointer-events': 'auto'}\"\r\n                      @title=\"updateTitle(index, $event)\")\r\n                p {{ viz.title }}\r\n\r\n      //- FILES: individual links to files in this folder\r\n      //- this is DISABLED for Chrome API for now, because we\r\n      //- can't download those files via regular URL\r\n      .files-section(v-if=\"myState?.svnProject?.baseURL\")\r\n        h3.curate-heading(v-if=\"myState.files.length\") {{$t('Files')}}\r\n\r\n        .curate-content(v-if=\"myState.files.length\")\r\n          .file-table\r\n            .file(v-for=\"file in myState.files\" :key=\"file\"\r\n              :class=\"{fade: myState.isLoading}\"\r\n            )\r\n              a(:href=\"`${myState.svnProject.baseURL}/${myState.subfolder}/${file}`\") {{ cleanName(file) }}\r\n\r\n","<template lang=\"pug\">\r\n.tabbed-folder-view\r\n .centered-vessel(:class=\"{wiide}\")\r\n  .tabholder(v-show=\"!isZoomed\" :style=\"dashWidthCalculator\")\r\n    .tabholdercontainer\r\n      .project-header(v-if=\"header\" v-html=\"header\")\r\n      //- .breadcrumbs(v-else)\r\n      //-   h3 {{ pageHeader }}\r\n      //-   h4 {{ root }}: {{ xsubfolder && xsubfolder.startsWith('/') ? '' : '/' }}{{ xsubfolder }}\r\n\r\n      //- .folder-readme(v-if=\"folderReadme\"\r\n      //-   :class=\"{'readme-centered': !this.header}\"\r\n      //-   v-html=\"folderReadme\"\r\n      //- )\r\n\r\n      .tabs.is-centered\r\n\r\n        ul(style=\"margin-right: 1rem\")\r\n          li(v-for=\"tab,index in Object.keys(dashboards)\" :key=\"tab\"\r\n            :class=\"{'is-active': tab===activeTab, 'is-not-active': tab!==activeTab}\"\r\n            :style=\"{opacity: tab===activeTab ? 1.0 : 0.5}\"\r\n          )\r\n            b: a(v-if=\"dashboards[tab].header\" @click=\"switchTab(tab,index)\") {{ dashboards[tab].header.tab }}\r\n\r\n  dash-board(v-if=\"dashboardTabWithDelay && dashboardTabWithDelay !== 'FILE__BROWSER' && dashboards[dashboardTabWithDelay] && dashboards[dashboardTabWithDelay].header.tab !== '...'\"\r\n    :root=\"root\"\r\n    :xsubfolder=\"xsubfolder\"\r\n    :config=\"dashboards[dashboardTabWithDelay]\"\r\n    :datamanager=\"dashboardDataManager\"\r\n    :zoomed=\"isZoomed\"\r\n    :allConfigFiles=\"allConfigFiles\"\r\n    @zoom=\"handleZoom\"\r\n    @layoutComplete=\"handleLayoutComplete\"\r\n  )\r\n\r\n  folder-browser(v-if=\"dashboardTabWithDelay && dashboardTabWithDelay === 'FILE__BROWSER'\"\r\n    :root=\"root\"\r\n    :xsubfolder=\"xsubfolder\"\r\n    :allConfigFiles=\"allConfigFiles\"\r\n    @navigate=\"onNavigate\"\r\n    @up=\"goUpOneFolder()\"\r\n  )\r\n\r\n  //- p.load-error(v-show=\"loadErrorMessage\" @click=\"authorizeAfterError\"): b {{ loadErrorMessage }}\r\n\r\n  .tabholder(v-show=\"showFooter && !isZoomed\" :class=\"{wiide}\" :style=\"dashWidthCalculator\")\r\n    .tabholdercontainer(:class=\"{wiide}\")\r\n      .project-footer(v-if=\"footer\" v-html=\"footer\" :class=\"{wiide}\")\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport Vue, { defineComponent } from 'vue'\r\n\r\nimport markdown from 'markdown-it'\r\nimport micromatch from 'micromatch'\r\nimport DOMPurify from 'dompurify'\r\nimport YAML from 'yaml'\r\n\r\nimport DashBoard from './DashBoard.vue'\r\nimport FolderBrowser from './FolderBrowser.vue'\r\n\r\nimport globalStore from '@/store'\r\nimport { FileSystemConfig, Status, YamlConfigs } from '@/Globals'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\nimport DashboardDataManager from '@/js/DashboardDataManager'\r\n\r\nconst NO_DASHBOARDS = ['.nodashboards', 'nodashboards', 'nodashboards.txt']\r\n\r\nconst mdRenderer = new markdown({\r\n  html: true,\r\n  linkify: true,\r\n  typographer: true,\r\n})\r\n\r\nexport default defineComponent({\r\n  name: 'TabbedDashboardView',\r\n  components: { DashBoard, FolderBrowser },\r\n  props: {\r\n    root: { type: String, required: true },\r\n    xsubfolder: { type: String, required: true },\r\n  },\r\n  data: () => {\r\n    return {\r\n      dashboards: [] as any[],\r\n      dashboardDataManager: null as DashboardDataManager | null,\r\n      allConfigFiles: { dashboards: {}, topsheets: {}, vizes: {}, configs: {} } as YamlConfigs,\r\n      isZoomed: false,\r\n      styleElement: null as any,\r\n      loadErrorMessage: '',\r\n      activeTab: '',\r\n      pageHeader: '',\r\n      folderReadme: '',\r\n      header: '',\r\n      footer: '',\r\n      customCSS: '',\r\n      dashboardTabWithDelay: '',\r\n      showFooter: false,\r\n    }\r\n  },\r\n  computed: {\r\n    fileApi(): HTTPFileSystem {\r\n      return new HTTPFileSystem(this.fileSystem, globalStore)\r\n    },\r\n    fileSystem(): FileSystemConfig {\r\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === this.root\r\n      )\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n      return svnProject[0]\r\n    },\r\n    wiide(): boolean {\r\n      return this.$store.state.isFullWidth\r\n    },\r\n\r\n    dashWidthCalculator(): any {\r\n      if (this.$store.state.dashboardWidth && this.$store.state.isFullWidth) {\r\n        return { maxWidth: this.$store.state.dashboardWidth }\r\n      }\r\n      return {}\r\n    },\r\n  },\r\n  watch: {\r\n    root() {\r\n      this.updateRoute()\r\n    },\r\n    xsubfolder() {\r\n      this.updateRoute()\r\n    },\r\n  },\r\n  methods: {\r\n    clearStyles() {\r\n      if (this.styleElement) {\r\n        document.getElementsByTagName('head')[0].removeChild(this.styleElement)\r\n        this.styleElement = null\r\n      }\r\n    },\r\n\r\n    getPageHeader() {\r\n      if (this.xsubfolder) return this.xsubfolder.substring(1 + this.xsubfolder.lastIndexOf('/'))\r\n\r\n      return this.fileSystem.name || this.root\r\n    },\r\n\r\n    onNavigate(options: any) {\r\n      this.$emit('navigate', options)\r\n    },\r\n\r\n    async getFolderReadme() {\r\n      try {\r\n        this.folderReadme = ''\r\n        const { files } = await this.fileApi.getDirectory(this.xsubfolder)\r\n        const readmes = files.filter(f => f.toLocaleLowerCase() === 'readme.md')\r\n        if (!readmes.length) return\r\n\r\n        const readmeText = await this.fileApi.getFileText(`${this.xsubfolder}/${readmes[0]}`)\r\n        const html = mdRenderer.render(readmeText)\r\n        this.folderReadme = html\r\n      } catch (e) {\r\n        // no readme is OK\r\n        this.folderReadme = ''\r\n      }\r\n    },\r\n\r\n    async findConfigsAndDashboards() {\r\n      this.loadErrorMessage = ''\r\n      if (!this.fileApi) return []\r\n\r\n      await this.fileApi.getChromePermission(this.fileSystem.handle)\r\n\r\n      this.getFolderReadme()\r\n\r\n      try {\r\n        this.allConfigFiles = await this.fileApi.findAllYamlConfigs(this.xsubfolder)\r\n\r\n        const { files } = await this.fileApi.getDirectory(this.xsubfolder)\r\n\r\n        // if folder has .nodashboards, then skip all dashboards!\r\n        let showDashboards = true\r\n        NO_DASHBOARDS.forEach(filename => {\r\n          if (files.indexOf(filename) > -1) {\r\n            showDashboards = false\r\n          }\r\n        })\r\n\r\n        if (showDashboards) {\r\n          for (const fullPath of Object.values(this.allConfigFiles.dashboards)) {\r\n            // add the tab now\r\n            Vue.set(this.dashboards, fullPath, { header: { tab: '...' } })\r\n            // load the details (title)\r\n            const showThisDashboard = await this.initDashboard(fullPath)\r\n            // and now remove it if it isn't triggered. Yes this order is correct\r\n            if (!showThisDashboard) delete this.dashboards[fullPath as any]\r\n          }\r\n        }\r\n\r\n        // Add FileBrowser as \"Files\" tab\r\n        Vue.set(this.dashboards, 'FILE__BROWSER', { header: { tab: 'Files' } })\r\n\r\n        // // Start on correct tab\r\n        if (this.$route.query.tab) {\r\n          try {\r\n            const userSupplied = parseInt('' + this.$route.query.tab) - 1\r\n            const userTab = Object.keys(this.dashboards)[userSupplied]\r\n            this.activeTab = userTab || Object.keys(this.dashboards)[0]\r\n          } catch (e) {\r\n            // user spam; just use first tab\r\n            this.activeTab = Object.keys(this.dashboards)[0]\r\n          }\r\n        } else {\r\n          this.activeTab = Object.keys(this.dashboards)[0]\r\n        }\r\n        this.dashboardTabWithDelay = this.activeTab\r\n\r\n        // headers, footers, etc\r\n        await this.setupProjectConfig()\r\n      } catch (e) {\r\n        // Bad things happened! Tell user\r\n        console.warn({ eeee: e })\r\n        if (this.fileSystem.handle) {\r\n          this.loadErrorMessage = `Click to grant access to folder \"${this.fileSystem.handle.name}\"`\r\n        } else {\r\n          this.loadErrorMessage = this.fileSystem.baseURL + ': Could not load'\r\n        }\r\n      }\r\n    },\r\n\r\n    async setupProjectConfig() {\r\n      // no configs mean no setup is necessary\r\n      if (!Object.keys(this.allConfigFiles.configs).length) {\r\n        // no config, so show navbar and be done\r\n        // this.$store.commit('setShowLeftBar', true)\r\n        return\r\n      }\r\n\r\n      for (const filename of Object.values(this.allConfigFiles.configs)) {\r\n        try {\r\n          const config = await this.fileApi.getFileText(filename)\r\n          const yaml = YAML.parse(config)\r\n\r\n          // figure out relative path for config file\r\n          const yamlFolder = filename.startsWith('http')\r\n            ? ''\r\n            : filename.substring(0, filename.indexOf('simwrapper-config.y'))\r\n\r\n          // always reveal quickview bar unless told not to\r\n          // console.log(555, yaml.hideLeftBar)\r\n          if (yaml.hideLeftBar === true) this.$store.commit('setShowLeftBar', false)\r\n          if (yaml.hideLeftBar === false) this.$store.commit('setShowLeftBar', true)\r\n\r\n          // set margins wide if requested to do so\r\n          this.$store.commit('setFullWidth', !!yaml.fullWidth)\r\n          this.$store.commit('setDashboardWidth', '')\r\n          if (yaml.width !== undefined) {\r\n            this.$store.commit('setDashboardWidth', '' + yaml.width)\r\n            this.$store.commit('setFullWidth', true)\r\n          }\r\n\r\n          try {\r\n            if (yaml.css) {\r\n              this.customCSS = await this.fileApi.getFileText(`${yamlFolder}${yaml.css}`)\r\n              this.styleElement = document.createElement('style')\r\n              this.styleElement.appendChild(document.createTextNode(this.customCSS))\r\n              document.getElementsByTagName('head')[0].appendChild(this.styleElement)\r\n            }\r\n          } catch (e) {\r\n            // no css, oh well\r\n          }\r\n\r\n          this.header = await this.buildPanel('header', yaml, yamlFolder)\r\n          this.footer = await this.buildPanel('footer', yaml, yamlFolder)\r\n        } catch (e) {\r\n          console.error('' + e)\r\n        }\r\n      }\r\n    },\r\n\r\n    handleRemoveDashboard() {},\r\n\r\n    async buildPanel(which: string, yaml: any, folder: string) {\r\n      // first get the correct/best header for this locale\r\n      let header = ''\r\n      if (this.$store.state.locale === 'de') {\r\n        header = yaml[which + '_de'] || yaml[which] || yaml[which + '_en'] || ''\r\n      } else {\r\n        header = yaml[which + '_en'] || yaml[which] || yaml[which + '_de'] || ''\r\n      }\r\n\r\n      if (!header) return ''\r\n\r\n      // if it is a filename, load it from disk\r\n      if (header.indexOf('\\n') == -1 && header.endsWith('.md')) {\r\n        const text = await this.fileApi.getFileText(`${folder}${header}`)\r\n        header = text\r\n      }\r\n\r\n      // convert to HTML\r\n      const html = mdRenderer.render(header)\r\n\r\n      // sanitize it\r\n      const clean = DOMPurify.sanitize(html, { USE_PROFILES: { html: true } })\r\n\r\n      // use it\r\n      return clean\r\n    },\r\n\r\n    // for each dashboard, fetch the yaml, set the tab title, and config the ... switcher?\r\n    async initDashboard(fullPath: any) {\r\n      try {\r\n        const config = await this.fileApi.getFileText(fullPath)\r\n        const yaml = YAML.parse(config)\r\n\r\n        // see if trigger condition is met\r\n        if (yaml.header?.triggerPattern) {\r\n          const { files, dirs } = await this.fileApi.getDirectory(this.xsubfolder)\r\n          const allContents = [...files, ...dirs]\r\n\r\n          if (micromatch.match(allContents, yaml.header.triggerPattern).length === 0) {\r\n            // no files matched trigger; skip this dashboard\r\n            return false\r\n          }\r\n        }\r\n\r\n        const shortFilename = fullPath.substring(0, fullPath.lastIndexOf('.'))\r\n        if (!yaml.header) yaml.header = { title: fullPath, tab: shortFilename }\r\n        if (!yaml.header.tab) yaml.header.tab = yaml.header.title || shortFilename\r\n\r\n        this.dashboards[fullPath] = yaml\r\n        console.log('DASHBOARD:', fullPath)\r\n        return true\r\n      } catch (e) {\r\n        this.$store.commit('setStatus', { type: Status.ERROR, msg: '' + e })\r\n        return false\r\n      }\r\n    },\r\n    updateRoute() {\r\n      this.clearStyles()\r\n\r\n      if (this.dashboardDataManager) this.dashboardDataManager.clearCache()\r\n      this.dashboardDataManager = new DashboardDataManager(this.root, this.xsubfolder)\r\n\r\n      this.header = ''\r\n      this.footer = ''\r\n      this.dashboards = []\r\n      this.pageHeader = this.getPageHeader()\r\n\r\n      // this.generateBreadcrumbs()\r\n\r\n      // this happens async\r\n      this.findConfigsAndDashboards()\r\n    },\r\n\r\n    async switchTab(tab: string, index: number) {\r\n      if (tab === this.activeTab) return\r\n\r\n      // Force teardown the dashboard to ensure we start with a clean slate\r\n      this.activeTab = ''\r\n      this.dashboardTabWithDelay = ''\r\n      this.showFooter = false\r\n\r\n      await this.$nextTick()\r\n\r\n      this.activeTab = tab\r\n\r\n      // to give browser time to teardown\r\n      setTimeout(() => {\r\n        this.dashboardTabWithDelay = tab\r\n        if (index) {\r\n          this.$router.replace({ query: { tab: `${index + 1}` } })\r\n        } else {\r\n          this.$router.replace({ query: {} })\r\n        }\r\n      }, 125)\r\n    },\r\n\r\n    handleZoom(isZoomed: any) {\r\n      this.isZoomed = !!isZoomed\r\n      this.$emit('zoom', this.isZoomed)\r\n    },\r\n\r\n    handleLayoutComplete() {\r\n      this.showFooter = true\r\n    },\r\n\r\n    getFileSystem(name: string) {\r\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === name\r\n      )\r\n\r\n      if (svnProject.length === 0) {\r\n        console.warn('no such project')\r\n        this.loadErrorMessage = `Can't locate \"${name}\": please check running services and browser version.`\r\n        return null\r\n      }\r\n\r\n      return svnProject[0]\r\n    },\r\n\r\n    goUpOneFolder() {\r\n      let target = this.xsubfolder\r\n      if (this.xsubfolder.endsWith('/')) target = this.xsubfolder.slice(0, length - 1)\r\n      target = target.substring(0, target.lastIndexOf('/'))\r\n\r\n      const props = {\r\n        root: this.fileSystem.slug,\r\n        xsubfolder: target,\r\n      }\r\n\r\n      // if we are at top of hierarchy, jump to splashpage\r\n      if (!target && !this.xsubfolder) {\r\n        this.onNavigate({ component: 'SplashPage', props: {} })\r\n      } else {\r\n        this.onNavigate({ component: 'TabbedDashboardView', props })\r\n      }\r\n    },\r\n\r\n    async authorizeAfterError() {\r\n      try {\r\n        const handle = this.fileSystem.handle\r\n        if (handle) {\r\n          const status = await handle.requestPermission({ mode: 'read' })\r\n          if (status === 'granted') this.updateRoute()\r\n        }\r\n      } catch (e) {\r\n        // meh\r\n      }\r\n    },\r\n\r\n    setTitle() {\r\n      const folder = this.xsubfolder.startsWith('/') ? this.xsubfolder.slice(1) : this.xsubfolder\r\n      const title = `${this.fileSystem.name}: ${folder}`\r\n\r\n      this.$emit('title', title)\r\n    },\r\n  },\r\n  mounted() {\r\n    this.updateRoute()\r\n\r\n    this.setTitle()\r\n  },\r\n  beforeDestroy() {\r\n    if (this.dashboardDataManager) this.dashboardDataManager.clearCache()\r\n    this.clearStyles()\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.tabbed-folder-view {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  background-color: var(--bgMapPanel);\r\n  flex-direction: column;\r\n  overflow-y: auto;\r\n}\r\n\r\n// .centered-vessel {\r\n//   // max-width: $dashboardWidth;\r\n//   // margin: 0 auto;\r\n//   // padding: 0 2rem;\r\n// }\r\n\r\n.centered-vessel.wiide {\r\n  max-width: unset;\r\n}\r\n\r\n.tabs {\r\n  margin: 0 0rem;\r\n}\r\n\r\n.tabs ul {\r\n  line-height: 0.8rem;\r\n  border-bottom-color: var(--bgMapPanel);\r\n  border-bottom-width: 5px;\r\n}\r\n\r\n.tabholder {\r\n  // max-width: $dashboardWidth + 3;\r\n  // margin: 0 auto;\r\n  z-index: 50;\r\n  top: 0px;\r\n  position: sticky;\r\n  background-color: var(--bgMapPanel);\r\n}\r\n\r\n.tabholdercontainer {\r\n  background-image: var(--bgDashboard);\r\n  // margin: 0 3rem;\r\n}\r\n\r\n.tabholdercontainer.wiide {\r\n  margin: 0 0rem;\r\n}\r\n\r\nli.is-not-active b a {\r\n  color: var(--text);\r\n}\r\n\r\n.breadcrumbs {\r\n  background-image: var(--bgTabBanner);\r\n  padding: 0.25rem 0 1rem 1rem;\r\n  color: var(--linkFancy);\r\n  font-size: 1.5rem;\r\n  text-align: center;\r\n\r\n  h3 {\r\n    color: white;\r\n    font-weight: bold;\r\n  }\r\n\r\n  h4 {\r\n    line-height: 1rem;\r\n    margin: 0;\r\n    color: #e4e4e4;\r\n    font-size: 1.1rem;\r\n  }\r\n\r\n  p {\r\n    max-width: $dashboardWidth;\r\n    margin: 0 2rem;\r\n  }\r\n}\r\n\r\n.up-link a {\r\n  color: var(--link);\r\n  border-bottom: none;\r\n}\r\n\r\n.up-link a:hover {\r\n  color: var(--linkHover);\r\n}\r\n\r\n.load-error {\r\n  margin: 3rem auto;\r\n  padding: 1rem 0;\r\n  border-radius: 5px;\r\n  text-align: center;\r\n  font-size: 1.2rem;\r\n  color: var(--link);\r\n  background-color: var(--bgPanel2);\r\n  max-width: 40rem;\r\n}\r\n\r\n.load-error:hover {\r\n  cursor: pointer;\r\n  color: var(--linkHover);\r\n  background-color: var(--bgPanel3);\r\n}\r\n\r\n.project-header {\r\n  margin-bottom: 1rem;\r\n  color: var(--text);\r\n  padding: 1rem 0.5rem;\r\n\r\n  :deep(h1) {\r\n    font-size: 3rem;\r\n    font-weight: bold;\r\n  }\r\n\r\n  :deep(h2) {\r\n    font-size: 1.5rem;\r\n    margin-top: 1rem;\r\n  }\r\n\r\n  :deep(h3) {\r\n    font-size: 1.25rem;\r\n    margin-top: 0.5rem;\r\n  }\r\n\r\n  :deep(h4) {\r\n    margin-top: 0.5rem;\r\n    font-size: 1.1rem;\r\n  }\r\n\r\n  :deep(ul) {\r\n    list-style: inside;\r\n  }\r\n}\r\n\r\n.project-header.wiide {\r\n  padding: 1rem 2rem;\r\n}\r\n\r\n.project-footer {\r\n  margin: 3rem 0rem 1rem 0rem;\r\n  padding: 1rem 1rem;\r\n  color: var(--text);\r\n  border-top: 2px solid #88888815;\r\n  :deep(h1) {\r\n    font-size: 2rem;\r\n    font-weight: bold;\r\n  }\r\n\r\n  :deep(h2) {\r\n    font-size: 1.5rem;\r\n    margin-top: 1rem;\r\n  }\r\n\r\n  :deep(h3) {\r\n    font-size: 1.25rem;\r\n    margin-top: 0.5rem;\r\n  }\r\n\r\n  :deep(h4) {\r\n    margin-top: 0.5rem;\r\n    font-size: 1.1rem;\r\n  }\r\n\r\n  :deep(ul) {\r\n    list-style: inside;\r\n  }\r\n}\r\n\r\n.project-footer.wiide {\r\n  margin: 3rem 0rem 1rem 0rem;\r\n  padding: 1rem 2rem;\r\n  border-top: none;\r\n  background-color: #88888815;\r\n  color: var(--text);\r\n}\r\n\r\n.folder-readme {\r\n  margin-top: 0.5rem;\r\n}\r\n\r\n.folder-readme.readme-centered {\r\n  text-align: center;\r\n}\r\n\r\n@media only screen and (max-width: 50em) {\r\n  .tabholdercontainer {\r\n    margin: 0 1rem;\r\n  }\r\n}\r\n</style>\r\n","\r\n.tabbed-folder-view\r\n .centered-vessel(:class=\"{wiide}\")\r\n  .tabholder(v-show=\"!isZoomed\" :style=\"dashWidthCalculator\")\r\n    .tabholdercontainer\r\n      .project-header(v-if=\"header\" v-html=\"header\")\r\n      //- .breadcrumbs(v-else)\r\n      //-   h3 {{ pageHeader }}\r\n      //-   h4 {{ root }}: {{ xsubfolder && xsubfolder.startsWith('/') ? '' : '/' }}{{ xsubfolder }}\r\n\r\n      //- .folder-readme(v-if=\"folderReadme\"\r\n      //-   :class=\"{'readme-centered': !this.header}\"\r\n      //-   v-html=\"folderReadme\"\r\n      //- )\r\n\r\n      .tabs.is-centered\r\n\r\n        ul(style=\"margin-right: 1rem\")\r\n          li(v-for=\"tab,index in Object.keys(dashboards)\" :key=\"tab\"\r\n            :class=\"{'is-active': tab===activeTab, 'is-not-active': tab!==activeTab}\"\r\n            :style=\"{opacity: tab===activeTab ? 1.0 : 0.5}\"\r\n          )\r\n            b: a(v-if=\"dashboards[tab].header\" @click=\"switchTab(tab,index)\") {{ dashboards[tab].header.tab }}\r\n\r\n  dash-board(v-if=\"dashboardTabWithDelay && dashboardTabWithDelay !== 'FILE__BROWSER' && dashboards[dashboardTabWithDelay] && dashboards[dashboardTabWithDelay].header.tab !== '...'\"\r\n    :root=\"root\"\r\n    :xsubfolder=\"xsubfolder\"\r\n    :config=\"dashboards[dashboardTabWithDelay]\"\r\n    :datamanager=\"dashboardDataManager\"\r\n    :zoomed=\"isZoomed\"\r\n    :allConfigFiles=\"allConfigFiles\"\r\n    @zoom=\"handleZoom\"\r\n    @layoutComplete=\"handleLayoutComplete\"\r\n  )\r\n\r\n  folder-browser(v-if=\"dashboardTabWithDelay && dashboardTabWithDelay === 'FILE__BROWSER'\"\r\n    :root=\"root\"\r\n    :xsubfolder=\"xsubfolder\"\r\n    :allConfigFiles=\"allConfigFiles\"\r\n    @navigate=\"onNavigate\"\r\n    @up=\"goUpOneFolder()\"\r\n  )\r\n\r\n  //- p.load-error(v-show=\"loadErrorMessage\" @click=\"authorizeAfterError\"): b {{ loadErrorMessage }}\r\n\r\n  .tabholder(v-show=\"showFooter && !isZoomed\" :class=\"{wiide}\" :style=\"dashWidthCalculator\")\r\n    .tabholdercontainer(:class=\"{wiide}\")\r\n      .project-footer(v-if=\"footer\" v-html=\"footer\" :class=\"{wiide}\")\r\n\r\n","<template lang=\"pug\">\r\n.svn-projects\r\n  .project(v-for=\"source in sources\" :key=\"source.url\"\r\n      @click='openProjectPage(source)'\r\n      @click.middle='openProjectTab(source)'\r\n      @click.meta='openProjectTab(source)'\r\n      @click.ctrl='openProjectTab(source)'\r\n      )\r\n      .desc\r\n        h3 {{ source.name }}\r\n        p {{ source.description }}\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\n\r\nimport globalStore from '@/store'\r\nimport { FileSystemConfig } from '@/Globals'\r\n\r\nexport default defineComponent({\r\n  name: 'FileSystemComponents',\r\n  data: () => {\r\n    return {\r\n      sources: [] as FileSystemConfig[],\r\n    }\r\n  },\r\n  mounted() {\r\n    this.sources = globalStore.state.svnProjects.filter(\r\n      source => !source.hidden && !source.slug.startsWith('fs')\r\n    )\r\n  },\r\n  methods: {\r\n    openProjectPage(source: FileSystemConfig) {\r\n      const destination: any = Object.assign({}, source)\r\n\r\n      destination.component = 'TabbedDashboardView'\r\n      destination.props = {\r\n        root: source.slug,\r\n        xsubfolder: '',\r\n      }\r\n      this.$emit('navigate', destination)\r\n    },\r\n\r\n    openProjectTab(source: any) {\r\n      window.open(source, '_blank')\r\n    },\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.svn-projects {\r\n  display: grid;\r\n  grid-template-columns: repeat(4, minmax(0, 1fr));\r\n  gap: 2rem;\r\n}\r\n\r\n.project {\r\n  flex: 1;\r\n  cursor: pointer;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background-color: var(--bgBold);\r\n  border-radius: 16px;\r\n  border: 1px solid var(--bgPanel3);\r\n}\r\n\r\n.desc h3 {\r\n  color: var(--text);\r\n  margin-bottom: 0.25rem;\r\n}\r\n\r\n.desc p {\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.project .desc {\r\n  padding: 1rem 1rem;\r\n}\r\n\r\n.project:hover {\r\n  // background-color: var(--bgHover);\r\n  box-shadow: var(--shadowMode);\r\n}\r\n\r\n@media only screen and (max-width: 64em) {\r\n  .svn-projects {\r\n    grid-template-columns: repeat(2, minmax(0, 1fr));\r\n  }\r\n}\r\n\r\n@media only screen and (max-width: 40em) {\r\n  .svn-projects {\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .project {\r\n    margin-bottom: 1rem;\r\n  }\r\n}\r\n</style>\r\n","\r\n.svn-projects\r\n  .project(v-for=\"source in sources\" :key=\"source.url\"\r\n      @click='openProjectPage(source)'\r\n      @click.middle='openProjectTab(source)'\r\n      @click.meta='openProjectTab(source)'\r\n      @click.ctrl='openProjectTab(source)'\r\n      )\r\n      .desc\r\n        h3 {{ source.name }}\r\n        p {{ source.description }}\r\n\r\n","<div class=\"markdown-body\"><ul>\n<li>\n<p><a href=\"https://simwrapper.github.io/docs\">Documentation and users guide</a> including examples and getting started</p>\n</li>\n<li>\n<p><a href=\"https://github.com/simwrapper/simwrapper\">Source code</a> available on Github</p>\n</li>\n</ul>\n</div>","<template lang=\"pug\">\r\n.splash-page\r\n  .scrolly\r\n    .thing-area\r\n      .top-area\r\n        .simwrapper-logo\r\n          img(v-if=\"state.isDarkMode\" src=\"@/assets/simwrapper-logo/SW_logo_yellow.png\")\r\n          img(v-else src=\"@/assets/simwrapper-logo/SW_logo_purple.png\")\r\n\r\n        //- h2.splash-readme(style=\"text-align: center; margin: -0.5rem auto 0 auto\" v-html=\"$t('tagLine')\")\r\n\r\n        //- h2: b {{ $t('more-info') }}\r\n        //- info-bottom.splash-readme\r\n\r\n      .middle-area\r\n        .is-chrome(v-if=\"isChrome\")\r\n          h3 Local Folders\r\n\r\n          p(v-if=\"!localFileHandles.length\") Chrome &amp; Edge can browse folders directly:\r\n\r\n          .roots\r\n            .project-root.local(v-for=\"row in localFileHandles\" :key=\"row.key\"\r\n              @click=\"clickedBrowseChromeLocalFolder(row)\")\r\n\r\n              h5.remove-local(style=\"flex: 1;\") {{ row.handle.name}}\r\n                i.fa.fa-times(@click.stop=\"clickedDelete(row)\")\r\n              p Local folder\r\n\r\n          p.config-sources: a(@click=\"showChromeDirectory\") Add local folder...\r\n\r\n        h3(style=\"margin-top: 1rem\") Browse Data Sources\r\n\r\n        .roots\r\n          .project-root(v-for=\"project in allRoots\" :key=\"project.slug\"\r\n            @click=\"clickedOnFolder({root: project.slug})\"\r\n          )\r\n            h5 {{ project.name }}\r\n            p {{ project.description }}\r\n\r\n        p.config-sources: a(@click=\"configureSources\") Edit data sources...\r\n\r\n\r\n        p.funding Funded by TU Berlin, the German Bundesministerium für Bildung und Forschung, and the ActivitySim Consortium member agencies.\r\n\r\n        .legal\r\n          p SimWrapper is open source and available on&nbsp;\r\n            a(href=\"https://github.com/simwrapper/simwrapper\") GitHub.\r\n\r\n        .legal\r\n          p\r\n              a(href=\"https://vsp.berlin/en/\" target=\"_blank\") VSP&nbsp;TU&nbsp;Berlin\r\n              a(href=\"https://vsp.berlin/impressum/\" target=\"_blank\") Impressum\r\n              a(href=\"https://www.vsp.tu-berlin.de/menue/service/privacy/parameter/en/\" target=\"_blank\") Privacy\r\n\r\n    .links-and-logos\r\n      .logos\r\n        a(v-for=\"logo in allLogos\"\r\n          :href=\"logo.url\"\r\n          :title=\"logo.name\"\r\n          target=\"_blank\"\r\n        )\r\n          img.img-logo(:src=\"logo.image\")\r\n\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\n// Typescript doesn't know the Chrome File System API\r\ndeclare const window: any\r\n\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      'more-info': 'Documentation:',\r\n      tagLine: 'the simulation browser and data visualizer from TU&nbsp;Berlin.',\r\n      privacy:\r\n        'SimWrapper is a client-side app, which means there is no upstream server collecting or storing data.\\n\\nSimWrapper does not collect, handle or process any data about you while you use the site. SimWrapper does not contain any tracking devices or analytics software. No user cookies are stored or transmitted.',\r\n    },\r\n    de: {\r\n      'more-info': 'Für weitere Informationen:',\r\n      tagLine: 'Der Modellergebnis-Browser der TU Berlin.',\r\n    },\r\n  },\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\nimport { get, set, clear } from 'idb-keyval'\r\n\r\nimport globalStore from '@/store'\r\nimport FileSystemProjects from '@/components/FileSystemProjects.vue'\r\nimport InfoBottom from '@/assets/info-bottom.md'\r\nimport { FileSystemConfig } from '@/Globals'\r\nimport fileSystems, { addLocalFilesystem } from '@/fileSystemConfig'\r\n\r\nconst BASE_URL = import.meta.env.BASE_URL\r\n\r\nconst logos = [\r\n  { url: 'https://vsp.berlin/en/', image: 'vsp-logo-300dpi.png', name: 'VSP TU-Berlin' },\r\n  { url: 'https://matsim.org/', image: 'matsim-logo-blue.png', name: 'MATSim' },\r\n  { url: 'https://tu.berlin', image: 'tu-logo.png', name: 'TU Berlin' },\r\n  { url: 'https://bmbf.de', image: 'bmbf-logo.png', name: 'German Federal BMBF' },\r\n  { url: 'https://www.sfcta.org/', image: 'sfcta.png', name: 'SFCTA' },\r\n  { url: 'https://metrocouncil.org/', image: 'metcouncil.png', name: 'Met Council' },\r\n  { url: 'http://www.sandag.org/', image: 'sandag.jpg', name: 'SANDAG' },\r\n  { url: 'https://mtc.ca.gov/', image: 'mtc.png', name: 'MTC' },\r\n  { url: 'https://www.psrc.org/', image: 'psrc.png', name: 'Puget Sound Regional Council' },\r\n  { url: 'https://www.mwcog.org/', image: 'mwcog.png', name: 'MWCOG' },\r\n  { url: 'https://www.oregon.gov/ODOT', image: 'oregondot.png', name: 'Oregon DOT' },\r\n  { url: 'https://atlantaregional.org/', image: 'arc.png', name: 'ARC' },\r\n  { url: 'https://www.transportation.ohio.gov/', image: 'ohiodot.png', name: 'Ohio DOT' },\r\n  { url: 'http://semcog.org/', image: 'semcog.jpg', name: 'SEMCOG' },\r\n]\r\n\r\nexport default defineComponent({\r\n  name: 'SplashPage',\r\n  i18n,\r\n  components: { FileSystemProjects, InfoBottom },\r\n  data: () => {\r\n    return {\r\n      state: globalStore.state,\r\n      allRoots: [] as FileSystemConfig[],\r\n    }\r\n  },\r\n  computed: {\r\n    allLogos(): any[] {\r\n      return logos.map(p => {\r\n        return { url: p.url, image: `${BASE_URL}images/logos/${p.image}` }\r\n      })\r\n    },\r\n\r\n    isChrome() {\r\n      return !!window.showDirectoryPicker\r\n    },\r\n\r\n    localFileHandles(): any[] {\r\n      // sort a copy of the array so we don't get an infinite loop\r\n      return this.$store.state.localFileHandles\r\n        .concat()\r\n        .sort((a: any, b: any) =>\r\n          parseInt(a.key.substring(2)) < parseInt(b.key.substring(2)) ? -1 : 1\r\n        )\r\n    },\r\n  },\r\n  methods: {\r\n    onNavigate(event: any) {\r\n      // pass it on up\r\n      this.$emit('navigate', event)\r\n    },\r\n\r\n    updateShortcuts() {\r\n      const roots = this.state.svnProjects.filter(\r\n        source => !source.hidden && !source.slug.startsWith('fs')\r\n      )\r\n\r\n      this.allRoots = roots\r\n    },\r\n\r\n    configureSources() {\r\n      this.$emit('activate', { name: 'Settings', class: 'SettingsPanel' })\r\n    },\r\n\r\n    clickedOnFolder(props: { folder: string; i: number; root: string }) {\r\n      const { folder, root, i } = props\r\n\r\n      let destination = `${root}`\r\n      if (folder) destination += `/${folder}`\r\n\r\n      this.$router.push(destination)\r\n    },\r\n\r\n    async clickedBrowseChromeLocalFolder(row: { key: string; handle: any }) {\r\n      try {\r\n        const status = await row.handle.requestPermission({ mode: 'read' })\r\n        console.log(row.handle, status)\r\n\r\n        if (status !== 'granted') return\r\n\r\n        // if first time, add its key to the fileSystemConfig\r\n        const exists = fileSystems.find(f => f.slug == row.key)\r\n        if (!exists) addLocalFilesystem(row.handle, row.key)\r\n\r\n        const props = { root: row.key } as any\r\n        this.clickedOnFolder(props)\r\n      } catch (e) {\r\n        console.error('' + e)\r\n      }\r\n    },\r\n\r\n    async showChromeDirectory() {\r\n      try {\r\n        const FileSystemDirectoryHandle = window.showDirectoryPicker()\r\n        const dir = await FileSystemDirectoryHandle\r\n        const slug = addLocalFilesystem(dir, null) // no key yet\r\n        this.$router.push(`${BASE_URL}${slug}/`)\r\n      } catch (e) {\r\n        // shrug\r\n      }\r\n    },\r\n\r\n    async clickedDelete(row: { key: string; handle: any }) {\r\n      const handles = this.$store.state.localFileHandles\r\n      // just filter out the key I guess?\r\n      const filtered = handles.filter((f: any) => f.key !== row.key)\r\n\r\n      // and save it everywhere\r\n      await set('fs', filtered)\r\n      this.$store.commit('setLocalFileSystem', filtered)\r\n    },\r\n  },\r\n  mounted() {\r\n    // set initial breadcrumbs if we don't have any yet\r\n    if (!this.state.breadcrumbs.length) {\r\n      const crumbs = [{ label: 'SimWrapper', url: '/' }]\r\n      globalStore.commit('setBreadCrumbs', crumbs)\r\n    }\r\n\r\n    // always start with nav bar when loading splashpage\r\n    // globalStore.commit('setShowLeftBar', true)\r\n\r\n    this.updateShortcuts()\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.splash-page {\r\n  background-color: var(--bgSplash);\r\n}\r\n\r\n.scrolly {\r\n  background-color: white;\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  display: grid;\r\n  grid-template-columns: 1fr auto;\r\n  overflow-y: auto;\r\n}\r\n\r\n.thing-area {\r\n  background-color: var(--bgSplash);\r\n  flex: 1;\r\n}\r\n\r\n.top-area {\r\n  margin: 2rem 3rem;\r\n}\r\n\r\n.middle-area {\r\n  padding: 1.5rem 3rem 1rem 3rem;\r\n  font-size: 0.9rem;\r\n  color: var(--textFancy);\r\n}\r\n\r\na {\r\n  color: #00499c;\r\n}\r\n\r\n.splash-readme {\r\n  color: var(--textFancy);\r\n}\r\n\r\n.simwrapper-logo {\r\n  max-width: 275px;\r\n  // margin: 0 auto;\r\n}\r\n\r\n.logos {\r\n  display: grid;\r\n  gap: 1.5rem;\r\n  grid-template-columns: repeat(auto-fill, 6.5rem);\r\n  padding: 1rem 0rem;\r\n  margin: 0 auto;\r\n  a {\r\n    margin-top: auto;\r\n  }\r\n}\r\n\r\n.links-and-logos {\r\n  padding: 0.5rem 0;\r\n  width: 9rem;\r\n  display: flex;\r\n  flex-direction: column;\r\n  color: #227;\r\n  background-color: #fff;\r\n}\r\n\r\n.words {\r\n  line-height: 1.2rem;\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin: auto 0;\r\n  padding: 0 5rem;\r\n  text-align: center;\r\n  font-size: 1rem;\r\n}\r\n\r\n.words a {\r\n  color: var(--link);\r\n}\r\n\r\nhr {\r\n  height: 1px;\r\n  background-color: var(--bgBrowser);\r\n  margin: 0.75rem 0;\r\n}\r\n\r\nh2.splash-readme {\r\n  padding: 1rem 1rem 0 1rem;\r\n  font-size: 1.5rem;\r\n  font-weight: normal;\r\n  line-height: 1.8rem;\r\n}\r\n\r\n.funding {\r\n  font-size: 0.9rem;\r\n  margin: 3rem 0 0.5rem 0;\r\n}\r\n\r\n.legal {\r\n  // padding: 0rem 2rem 0rem 2rem;\r\n  display: flex;\r\n  p {\r\n    margin: 0rem 0 0 0;\r\n    font-size: 0.9rem;\r\n  }\r\n  a {\r\n    margin-right: 0.75rem;\r\n    color: var(--link);\r\n  }\r\n  a:hover {\r\n    color: var(--linkHover);\r\n  }\r\n}\r\n\r\n.img-logo {\r\n  margin-bottom: auto;\r\n}\r\n\r\n.project-root {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-top: 0.75rem;\r\n  padding: 0.5rem 0.5rem;\r\n  background-color: var(--bgMapPanel);\r\n  border-left: 3px solid var(--sliderThumb);\r\n  border-right: 1px solid #8888aa00;\r\n  border-top: 1px solid #8888aa00;\r\n  border-bottom: 1px solid #8888aa00;\r\n\r\n  h5 {\r\n    font-size: 1rem;\r\n    line-height: 1rem;\r\n    font-weight: bold;\r\n    margin-bottom: 0.25rem;\r\n  }\r\n\r\n  p {\r\n    line-height: 1.1rem;\r\n  }\r\n}\r\n\r\n.project-root.local {\r\n  border-left: 3px solid $matsimBlue;\r\n}\r\n\r\n.project-root:hover {\r\n  cursor: pointer;\r\n  background-color: var(--bgHover);\r\n  transition: background-color 0.1s ease-in-out;\r\n  border-right: 1px solid #66666640;\r\n  border-top: 1px solid #66666640;\r\n  border-bottom: 1px solid #66666640;\r\n}\r\n\r\n.fa-times {\r\n  opacity: 0;\r\n  float: right;\r\n  padding: 1px 1px;\r\n}\r\n\r\n.fa-times:hover {\r\n  color: red;\r\n}\r\n\r\n.fa-times:active {\r\n  color: darkred;\r\n}\r\n\r\n.project-root:hover .fa-times {\r\n  opacity: 0.15;\r\n}\r\n\r\n.project-root:hover .fa-times:hover {\r\n  opacity: 1;\r\n}\r\n\r\n.config-sources {\r\n  margin-top: 0.5rem;\r\n  // text-align: right;\r\n  a {\r\n    color: var(--link);\r\n  }\r\n}\r\n\r\n.config-sources a:hover {\r\n  cursor: pointer;\r\n  color: var(--linkHover);\r\n}\r\n\r\n.roots {\r\n  display: grid;\r\n  gap: 0rem 0.5rem;\r\n  grid-template-columns: repeat(auto-fit, 18rem);\r\n  list-style: none;\r\n}\r\n\r\n@media only screen and (max-width: 800px) {\r\n}\r\n</style>\r\n","\r\n.splash-page\r\n  .scrolly\r\n    .thing-area\r\n      .top-area\r\n        .simwrapper-logo\r\n          img(v-if=\"state.isDarkMode\" src=\"@/assets/simwrapper-logo/SW_logo_yellow.png\")\r\n          img(v-else src=\"@/assets/simwrapper-logo/SW_logo_purple.png\")\r\n\r\n        //- h2.splash-readme(style=\"text-align: center; margin: -0.5rem auto 0 auto\" v-html=\"$t('tagLine')\")\r\n\r\n        //- h2: b {{ $t('more-info') }}\r\n        //- info-bottom.splash-readme\r\n\r\n      .middle-area\r\n        .is-chrome(v-if=\"isChrome\")\r\n          h3 Local Folders\r\n\r\n          p(v-if=\"!localFileHandles.length\") Chrome &amp; Edge can browse folders directly:\r\n\r\n          .roots\r\n            .project-root.local(v-for=\"row in localFileHandles\" :key=\"row.key\"\r\n              @click=\"clickedBrowseChromeLocalFolder(row)\")\r\n\r\n              h5.remove-local(style=\"flex: 1;\") {{ row.handle.name}}\r\n                i.fa.fa-times(@click.stop=\"clickedDelete(row)\")\r\n              p Local folder\r\n\r\n          p.config-sources: a(@click=\"showChromeDirectory\") Add local folder...\r\n\r\n        h3(style=\"margin-top: 1rem\") Browse Data Sources\r\n\r\n        .roots\r\n          .project-root(v-for=\"project in allRoots\" :key=\"project.slug\"\r\n            @click=\"clickedOnFolder({root: project.slug})\"\r\n          )\r\n            h5 {{ project.name }}\r\n            p {{ project.description }}\r\n\r\n        p.config-sources: a(@click=\"configureSources\") Edit data sources...\r\n\r\n\r\n        p.funding Funded by TU Berlin, the German Bundesministerium für Bildung und Forschung, and the ActivitySim Consortium member agencies.\r\n\r\n        .legal\r\n          p SimWrapper is open source and available on&nbsp;\r\n            a(href=\"https://github.com/simwrapper/simwrapper\") GitHub.\r\n\r\n        .legal\r\n          p\r\n              a(href=\"https://vsp.berlin/en/\" target=\"_blank\") VSP&nbsp;TU&nbsp;Berlin\r\n              a(href=\"https://vsp.berlin/impressum/\" target=\"_blank\") Impressum\r\n              a(href=\"https://www.vsp.tu-berlin.de/menue/service/privacy/parameter/en/\" target=\"_blank\") Privacy\r\n\r\n    .links-and-logos\r\n      .logos\r\n        a(v-for=\"logo in allLogos\"\r\n          :href=\"logo.url\"\r\n          :title=\"logo.name\"\r\n          target=\"_blank\"\r\n        )\r\n          img.img-logo(:src=\"logo.image\")\r\n\r\n\r\n","export default \"__VITE_ASSET__abf06ffb__\"","export default \"__VITE_ASSET__175fca9f__\"","<template lang=\"pug\">\r\n.left-nav-panel\r\n  .top\r\n    button.item(v-for=\"section in topSections\" :key=\"section.name\"\r\n      :style=\"buttonStyle(section)\"\r\n      @click=\"select(section)\"\r\n    )\r\n      img.svg-icon(\r\n        :src=\"section.icon\"\r\n        :draggable=\"false\"\r\n        :style=\"{filter: section.colorize ? issueColor : 'invert(100%)'}\"\r\n      )\r\n      p {{ section.name }}\r\n\r\n  .bottom\r\n    button.item(v-for=\"section in bottomSections\" :key=\"section.name\"\r\n      :style=\"buttonStyle(section)\"\r\n      @click=\"select(section)\"\r\n    )\r\n      img.svg-icon(\r\n        :src=\"section.icon\"\r\n        :draggable=\"false\"\r\n        :style=\"{filter: section.colorize ? issueColor : 'invert(100%)'}\"\r\n      )\r\n      p {{ section.name }}\r\n\r\n  //- .hide\r\n  //-   b-button.button(size=\"is-small\" expanded) <<\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\n\r\nimport ICON_FILES from '@/assets/icons/files.svg'\r\nimport ICON_ISSUES from '@/assets/icons/issues.svg'\r\nimport ICON_INFO from '@/assets/icons/settings.svg'\r\nimport ICON_DOCS from '@/assets/icons/readme.svg'\r\n\r\nimport globalStore from '@/store'\r\n\r\nconst DOCS_URL = 'https://simwrapper.github.io/docs'\r\n\r\nexport interface Section {\r\n  name: string\r\n  class: string\r\n  icon?: string\r\n  colorize?: boolean\r\n  link?: string\r\n  onlyIfVisible?: boolean\r\n}\r\n\r\nexport default defineComponent({\r\n  name: 'LeftIconPanel',\r\n  props: {\r\n    activeSection: { type: String, required: true },\r\n  },\r\n  data: () => {\r\n    return {\r\n      state: globalStore.state,\r\n      topSections: [\r\n        { name: 'Files', class: 'BrowserPanel', icon: ICON_FILES },\r\n        { name: 'Issues', class: 'ErrorPanel', icon: ICON_ISSUES, colorize: true },\r\n        // { name: 'Search', class: 'RunFinderPanel', icon: ICON_ARROW },\r\n        // { name: 'Gallery', class: 'RunFinderPanel', icon: ICON_ARROW },\r\n      ] as Section[],\r\n      bottomSections: [\r\n        { name: 'Docs', link: DOCS_URL, icon: ICON_DOCS },\r\n        { name: 'Settings', class: 'SettingsPanel', icon: ICON_INFO },\r\n      ] as Section[],\r\n    }\r\n  },\r\n  computed: {\r\n    issueColor() {\r\n      // red\r\n      if (this.state.statusErrors.length)\r\n        return 'invert(60%) sepia(100%) hue-rotate(310deg) saturate(8.5)'\r\n      // yellow\r\n      if (this.state.statusWarnings.length)\r\n        return 'invert(75%) sepia(100%) hue-rotate(15deg) saturate(5.5)'\r\n      // white\r\n      return 'invert(100%)'\r\n    },\r\n  },\r\n  methods: {\r\n    select(section: Section) {\r\n      this.$emit('activate', section)\r\n    },\r\n\r\n    buttonStyle(section: any) {\r\n      const colorizedOpacity =\r\n        this.state.statusErrors.length || this.state.statusWarnings.length ? 0.8 : 0.4\r\n\r\n      if (this.activeSection !== section.name) {\r\n        return { opacity: section.colorize ? colorizedOpacity : 0.4 }\r\n      }\r\n\r\n      return {\r\n        opacity: 1.0,\r\n        borderLeft: '3px solid white',\r\n      }\r\n    },\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.left-nav-panel {\r\n  background-color: #313135;\r\n  display: flex;\r\n  flex-direction: column;\r\n  user-select: none;\r\n}\r\n\r\n.top {\r\n  margin-bottom: auto;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding-top: 4px;\r\n}\r\n\r\n.bottom {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.item {\r\n  width: 60px;\r\n  text-align: center;\r\n  margin-bottom: 16px;\r\n  border-left: 3px solid #00000000;\r\n  border-right: 3px solid #00000000;\r\n  opacity: 0.4;\r\n}\r\n\r\np {\r\n  margin-top: -6px;\r\n  font-size: 11px;\r\n  color: #c6c1b9;\r\n}\r\n\r\n.item img {\r\n  margin: 5px 4px;\r\n  width: 26px;\r\n}\r\n\r\n.item:hover {\r\n  cursor: pointer;\r\n  opacity: 1;\r\n}\r\n\r\n.button {\r\n  background-color: #444;\r\n  border: none;\r\n  color: #ccc;\r\n  height: 20px;\r\n}\r\n\r\n.button:hover,\r\n.button:active {\r\n  background-color: #555;\r\n}\r\n</style>\r\n","export default \"__VITE_ASSET__4e6d24ab__\"","export default \"__VITE_ASSET__45ff9b99__\"","export default \"__VITE_ASSET__bff70382__\"","export default \"__VITE_ASSET__6e19bc2b__\"","\r\n.left-nav-panel\r\n  .top\r\n    button.item(v-for=\"section in topSections\" :key=\"section.name\"\r\n      :style=\"buttonStyle(section)\"\r\n      @click=\"select(section)\"\r\n    )\r\n      img.svg-icon(\r\n        :src=\"section.icon\"\r\n        :draggable=\"false\"\r\n        :style=\"{filter: section.colorize ? issueColor : 'invert(100%)'}\"\r\n      )\r\n      p {{ section.name }}\r\n\r\n  .bottom\r\n    button.item(v-for=\"section in bottomSections\" :key=\"section.name\"\r\n      :style=\"buttonStyle(section)\"\r\n      @click=\"select(section)\"\r\n    )\r\n      img.svg-icon(\r\n        :src=\"section.icon\"\r\n        :draggable=\"false\"\r\n        :style=\"{filter: section.colorize ? issueColor : 'invert(100%)'}\"\r\n      )\r\n      p {{ section.name }}\r\n\r\n  //- .hide\r\n  //-   b-button.button(size=\"is-small\" expanded) <<\r\n\r\n","<template lang=\"pug\">\r\n.panel\r\n\r\n  .top-panel\r\n    h4(:style=\"headerTextColor\") Issues\r\n\r\n    .warnings\r\n      .no-error(v-if=\"!state.statusErrors.length && !state.statusWarnings.length\")\r\n        p.check ☑️\r\n        p No issues for this page.\r\n\r\n      .message-area(v-else)\r\n        h3(v-if=\"state.statusErrors.length\") Errors: {{state.statusErrors.length}}\r\n        .single-message(v-for=\"err,i in state.statusErrors\")\r\n          p(v-html=\"cleanError(err.msg)\" @click=\"toggleShowDescription(i, true)\")\r\n          .description(v-if=\"descriptionIndexListError.includes(i)\")\r\n            p(v-html=\"err.desc\")\r\n        h3(v-if=\"state.statusWarnings.length\") Warnings: {{state.statusWarnings.length}}\r\n        .single-message(v-for=\"err,i in state.statusWarnings\")\r\n          p(v-html=\"err.msg\" @click=\"toggleShowDescription(i, false)\")\r\n          .description(v-if=\"descriptionIndexListWarning.includes(i)\")\r\n            p(v-html=\"err.desc\")\r\n\r\n\r\n  .bottom-panel\r\n    b-button.clear-button(\r\n      v-if=\"state.statusErrors.length || state.statusWarnings.length\"\r\n      expanded\r\n      @click=\"clearAllButtons()\"\r\n    ) Clear all messages\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: { sync: 'Sync folders', theme: 'Light/Dark', lang: 'EN/DE', split: 'Split view' },\r\n    de: { sync: 'Sync', theme: 'Hell/Dunkel', lang: 'DE/EN', split: 'Aufteilen' },\r\n  },\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\n\r\nimport globalStore from '@/store'\r\n\r\nexport default defineComponent({\r\n  name: 'ErrorPanel',\r\n  i18n,\r\n  data: () => {\r\n    return {\r\n      state: globalStore.state,\r\n      showDescription: false,\r\n      descriptionIndexListWarning: [] as number[],\r\n      descriptionIndexListError: [] as number[],\r\n      isError: false,\r\n    }\r\n  },\r\n  watch: {\r\n    '$route.path'() {\r\n      this.clearAllButtons()\r\n    },\r\n  },\r\n  computed: {\r\n    headerTextColor() {\r\n      let color = {}\r\n      if (this.state.statusWarnings.length) color = { color: '#fe8' }\r\n      if (this.state.statusErrors.length) color = { color: '#f66' }\r\n      return color\r\n    },\r\n  },\r\n  methods: {\r\n    cleanError(message: string) {\r\n      if (message.startsWith('Error: ')) return message.slice(7)\r\n      return message\r\n    },\r\n\r\n    clearAllButtons() {\r\n      this.$store.commit('clearAllErrors')\r\n\r\n      // if error panel is actually open and visible, switch to file panel\r\n      this.$emit('activate', { name: 'Files', class: 'BrowserPanel', onlyIfVisible: true })\r\n    },\r\n\r\n    toggleShowDescription(i: number, isError: boolean) {\r\n      this.isError = isError\r\n      if (isError) {\r\n        if (this.descriptionIndexListError.includes(i)) {\r\n          var index = this.descriptionIndexListError.indexOf(i)\r\n          this.descriptionIndexListError.splice(index, 1)\r\n        } else {\r\n          this.descriptionIndexListError.push(i)\r\n        }\r\n      } else {\r\n        if (this.descriptionIndexListWarning.includes(i)) {\r\n          var index = this.descriptionIndexListWarning.indexOf(i)\r\n          this.descriptionIndexListWarning.splice(index, 1)\r\n        } else {\r\n          this.descriptionIndexListWarning.push(i)\r\n        }\r\n      }\r\n    },\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.panel {\r\n  user-select: none;\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  padding: 0.25rem 0;\r\n  color: var(--text);\r\n}\r\n\r\nh4 {\r\n  background-color: #00000080;\r\n  text-transform: uppercase;\r\n  text-align: center;\r\n  padding: 0.25rem 0.5rem;\r\n  margin-bottom: 0.5rem;\r\n  font-weight: bold;\r\n  color: #ddd;\r\n}\r\n\r\n.top-panel {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow-y: auto;\r\n  margin: 0.25rem 0.5rem 0.5rem 0.5rem;\r\n}\r\n\r\n.bottom-panel {\r\n  margin-top: auto;\r\n  padding: 0 0.5rem 0.25rem 0.5rem;\r\n}\r\n\r\na {\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.top {\r\n  margin-top: 1rem;\r\n}\r\n\r\n.commands {\r\n  display: flex;\r\n  flex-direction: row;\r\n  // margin-right: -0.5rem;\r\n}\r\n\r\n.commands .button {\r\n  flex: 1;\r\n  color: #a19ebb;\r\n  margin-right: 0.25rem;\r\n  padding: 0 0;\r\n}\r\n\r\n.commands .button:hover {\r\n  color: var(--link);\r\n}\r\n\r\n.warnings {\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 0rem 0rem;\r\n  margin: 0 0 0 0.25rem;\r\n  text-align: left;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.message-area {\r\n  text-indent: -20px;\r\n  margin-left: 20px;\r\n}\r\n\r\n.message-area h3 {\r\n  margin-top: 1rem;\r\n  font-size: 1.2rem;\r\n}\r\n\r\n.single-message {\r\n  list-style-position: outside;\r\n  cursor: pointer;\r\n}\r\n\r\n.description {\r\n  width: 100%;\r\n  height: min-content;\r\n  background-color: rgb(95, 123, 167);\r\n  margin-top: 0.25rem;\r\n  margin-bottom: 0.25rem;\r\n  padding: 0 0.25rem;\r\n  text-indent: 0;\r\n  margin-left: 0px;\r\n  color: white;\r\n}\r\n\r\n.no-error p {\r\n  user-select: none;\r\n  text-align: center;\r\n}\r\n\r\n.check {\r\n  margin-top: 2rem;\r\n  margin-bottom: 0.5rem;\r\n  font-size: 2rem;\r\n}\r\n\r\n::-webkit-scrollbar-corner {\r\n  background: rgba(0, 0, 0, 0);\r\n}\r\n\r\np {\r\n  padding-bottom: 0.5rem;\r\n  line-height: 1.1rem;\r\n  list-style-type: square;\r\n  word-wrap: break-word;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n}\r\n</style>\r\n","\r\n.panel\r\n\r\n  .top-panel\r\n    h4(:style=\"headerTextColor\") Issues\r\n\r\n    .warnings\r\n      .no-error(v-if=\"!state.statusErrors.length && !state.statusWarnings.length\")\r\n        p.check ☑️\r\n        p No issues for this page.\r\n\r\n      .message-area(v-else)\r\n        h3(v-if=\"state.statusErrors.length\") Errors: {{state.statusErrors.length}}\r\n        .single-message(v-for=\"err,i in state.statusErrors\")\r\n          p(v-html=\"cleanError(err.msg)\" @click=\"toggleShowDescription(i, true)\")\r\n          .description(v-if=\"descriptionIndexListError.includes(i)\")\r\n            p(v-html=\"err.desc\")\r\n        h3(v-if=\"state.statusWarnings.length\") Warnings: {{state.statusWarnings.length}}\r\n        .single-message(v-for=\"err,i in state.statusWarnings\")\r\n          p(v-html=\"err.msg\" @click=\"toggleShowDescription(i, false)\")\r\n          .description(v-if=\"descriptionIndexListWarning.includes(i)\")\r\n            p(v-html=\"err.desc\")\r\n\r\n\r\n  .bottom-panel\r\n    b-button.clear-button(\r\n      v-if=\"state.statusErrors.length || state.statusWarnings.length\"\r\n      expanded\r\n      @click=\"clearAllButtons()\"\r\n    ) Clear all messages\r\n\r\n","<template lang=\"pug\">\r\n.add-data\r\n  .add\r\n    .markdown(v-html=\"notes\")\r\n    .flex-row\r\n      p.flex1: b Label\r\n      b-input.flex5(size=\"is-small\" placeholder=\"e.g. server1\" maxlength=\"32\" v-model=\"labelField\")\r\n    .flex-row\r\n      p.flex1: b URL\r\n      b-input.flex5(size=\"is-small\" placeholder=\"http://localhost:8001\" maxlength=\"512\" v-model=\"urlField\")\r\n    .flex-row\r\n      p.flex1: b Note\r\n      b-input.flex5(size=\"is-small\" placeholder=\"optional\" maxlength=\"255\" v-model=\"noteField\")\r\n    .flex-row\r\n      p.flex1 &nbsp;\r\n      b-button.is-primary(\r\n        size=\"is-small\"\r\n        :disabled=\"!isValidURL\"\r\n        :type=\"isValidURL ? '' : 'is-outlined'\"\r\n        @click=\"addURL\"\r\n      ) Add Data URL\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from 'vue'\r\nimport type { PropType } from 'vue'\r\nimport MarkdownIt from 'markdown-it'\r\n\r\nimport globalStore from '@/store'\r\n\r\nconst mdAddNotes = `\r\nAdd a local shortcut for any URL-based resource.\r\nSimWrapper requires several server settings, including:\r\n\r\n- Open access (no login)\r\n- File and directory listings\r\n-  CORS \"Access-Control-Allow-Origin\"\r\n`\r\n\r\nexport default defineComponent({\r\n  name: 'AddDataSource',\r\n  props: {},\r\n  data: () => {\r\n    return {\r\n      labelField: '',\r\n      urlField: '',\r\n      noteField: '',\r\n      notes: '',\r\n      mdParser: new MarkdownIt(),\r\n    }\r\n  },\r\n  mounted() {\r\n    this.notes = this.mdParser.render(mdAddNotes)\r\n  },\r\n  watch: {\r\n    labelField() {\r\n      this.fixField()\r\n    },\r\n  },\r\n  computed: {\r\n    isValidURL() {\r\n      if (!this.labelField) return false\r\n      if (!this.urlField) return false\r\n      if (!this.urlField.startsWith('http')) return false\r\n      return true\r\n    },\r\n  },\r\n  methods: {\r\n    addURL() {\r\n      this.fixField()\r\n      console.log('Adding', this.labelField, this.urlField)\r\n\r\n      const KEY = 'projectShortcuts'\r\n      try {\r\n        let existingRoot = localStorage.getItem(KEY) || ('{}' as any)\r\n\r\n        let roots = JSON.parse(existingRoot)\r\n\r\n        roots[this.labelField] = {\r\n          name: `${this.labelField}`,\r\n          slug: `${this.labelField}`,\r\n          description: this.noteField,\r\n          baseURL: this.urlField,\r\n        }\r\n\r\n        console.log('NEW ROOTS', roots)\r\n        localStorage.setItem(KEY, JSON.stringify(roots))\r\n        globalStore.commit('setURLShortcuts', roots)\r\n      } catch (e) {\r\n        // you failed\r\n        console.error('' + e)\r\n      }\r\n    },\r\n\r\n    fixField() {\r\n      this.labelField = this.labelField.toLowerCase().replaceAll(/[^a-z\\-0-9@]*/g, '')\r\n    },\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.add {\r\n  gap: 0.25rem;\r\n  margin: 0.5rem 0.25rem 0rem 0;\r\n  color: var(--text);\r\n\r\n  b-field {\r\n    color: white;\r\n  }\r\n}\r\n\r\n.flex-row {\r\n  width: 100%;\r\n  margin-bottom: 4px;\r\n}\r\n.flex1 {\r\n  text-align: right;\r\n  margin: auto 0.5rem;\r\n}\r\n\r\n.markdown {\r\n  margin-bottom: 1rem;\r\n  line-height: 1.3rem;\r\n}\r\n\r\nb-button {\r\n  text-align: right;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n}\r\n</style>\r\n","\r\n.add-data\r\n  .add\r\n    .markdown(v-html=\"notes\")\r\n    .flex-row\r\n      p.flex1: b Label\r\n      b-input.flex5(size=\"is-small\" placeholder=\"e.g. server1\" maxlength=\"32\" v-model=\"labelField\")\r\n    .flex-row\r\n      p.flex1: b URL\r\n      b-input.flex5(size=\"is-small\" placeholder=\"http://localhost:8001\" maxlength=\"512\" v-model=\"urlField\")\r\n    .flex-row\r\n      p.flex1: b Note\r\n      b-input.flex5(size=\"is-small\" placeholder=\"optional\" maxlength=\"255\" v-model=\"noteField\")\r\n    .flex-row\r\n      p.flex1 &nbsp;\r\n      b-button.is-primary(\r\n        size=\"is-small\"\r\n        :disabled=\"!isValidURL\"\r\n        :type=\"isValidURL ? '' : 'is-outlined'\"\r\n        @click=\"addURL\"\r\n      ) Add Data URL\r\n\r\n","<template lang=\"pug\">\r\n.panel\r\n\r\n  .top-panel\r\n    h4 Files\r\n\r\n    .trail(v-if=\"root\")\r\n      .x-home\r\n        p(@click=\"clickedBreadcrumb({url: '//'})\")\r\n          i.fa.fa-home\r\n\r\n      .x-breadcrumbs(v-if=\"root\")\r\n        p(v-for=\"crumb,i in globalState.breadcrumbs.slice(1)\" :key=\"crumb.url\"\r\n          @click=\"clickedBreadcrumb(crumb)\"\r\n        ) &nbsp;/&nbsp;{{ crumb.label }}\r\n\r\n  .middle-panel\r\n      //- Starting point if not in a project root: list all existing roots\r\n      .curated-sections(v-if=\"!root\")\r\n\r\n        .hint-clicks(style=\"margin-bottom: 1rem; opacity: 1\")\r\n          p You can browse to another folder from here. Drag panels into the main window area to open them side-by-side.\r\n\r\n        .is-chrome(v-if=\"isChrome\")\r\n          h3 Local Folders\r\n\r\n          p(v-if=\"!localFileHandles.length\") Chrome & Edge can browse folders directly:\r\n          .project-root.local(v-for=\"row in localFileHandles\" :key=\"row.key\"\r\n            @click=\"clickedBrowseChromeLocalFolder(row)\")\r\n\r\n            h5.remove-local(style=\"flex: 1;\") {{ row.handle.name}}\r\n              i.fa.fa-times(@click.stop=\"clickedDelete(row)\")\r\n            p Local folder\r\n\r\n          p.config-sources: a(@click=\"showChromeDirectory\") Add local folder...\r\n\r\n        h3(style=\"margin-top: 1rem\") Data Sources\r\n\r\n        .project-root(v-for=\"project in allRoots\" :key=\"project.slug\"\r\n          @click=\"clickedOnFolder({root: project.slug})\"\r\n        )\r\n          h5 {{ project.name }}\r\n          p {{ project.description }}\r\n\r\n        p.config-sources: a(@click=\"configureSources\") Edit data sources...\r\n\r\n      //- Starting point if in a project folder: -------------------------\r\n      .curated-sections(v-else)\r\n\r\n        h3.curate-heading {{ globalState.breadcrumbs[globalState.breadcrumbs.length - 1].label }}\r\n\r\n        .curate-content(v-if=\"myState.folders.length\")\r\n          .folder-table\r\n            .folder(v-for=\"folder,i in myState.folders\" :key=\"folder\"\r\n                :class=\"{fade: myState.isLoading, upfolder: i == 0}\"\r\n                @click=\"clickedOnFolder({folder, i})\")\r\n              i.fa(:class=\"i == 0 ? 'fa-arrow-up' : 'fa-folder-open'\")\r\n              p {{ cleanName(folder) }}\r\n\r\n          p(v-if=\"myState.folders.length==1\" style=\"font-size: 0.9rem; opacity: 0.7; margin: 0.5rem 0; text-align: right\") No subfolders.\r\n\r\n        //- MAPS: thumbnails of each viz map here\r\n        .section-maps(v-if=\"vizMaps.size\")\r\n\r\n          h3.curate-heading {{ $t('Maps')}}\r\n          .curate-content\r\n            .viz-table\r\n              .viz-grid-item(\r\n                v-for=\"[index, viz] of vizMaps.entries()\" :key=\"index\"\r\n                @click=\"clickedVisualization(index)\"\r\n              )\r\n                .viz-frame(\r\n                  :class=\"{highlighted: index === highlightedViz }\"\r\n                  draggable\r\n                  @dragstart=\"dragStart($event, viz)\"\r\n                  @dragend=\"dragEnd\"\r\n                )\r\n                  p.v-title: b {{ viz.title }}\r\n                  p.v-filename {{ viz.config }}\r\n                  p.v-plugin(:style=\"getTabColor(viz.component)\") {{ viz.component || 'dashboard' }}\r\n\r\n                  component.viz-frame-component(\r\n                        v-show=\"false\"\r\n                        :is=\"viz.component\"\r\n                        :root=\"myState.svnProject.slug\"\r\n                        :subfolder=\"myState.subfolder\"\r\n                        :yamlConfig=\"viz.config\"\r\n                        :thumbnail=\"true\"\r\n                        :fileApi=\"myState.svnRoot\"\r\n                        :style=\"{'pointer-events': 'none'}\"\r\n                        @title=\"updateTitle(index, $event)\")\r\n\r\n            .hint-clicks(:style=\"{opacity : needDoubleClickHint ? 1 : 0}\")\r\n              p\r\n                b Drag\r\n                | &nbsp;or&nbsp;\r\n                b double-click\r\n                | &nbsp;a tile\r\n                br\r\n                | to open it in the main panel\r\n\r\n        //- IMAGES here\r\n        .section-images(v-if=\"Object.keys(vizImages).length\")\r\n          h3.curate-heading {{ $t('Images')}}\r\n          .curate-content\r\n            .viz-image-table\r\n              .viz-image-grid-item(v-for=\"[index, viz] of Object.entries(vizImages)\" :key=\"index\"\r\n                        @click=\"clickedVisualization(index)\")\r\n\r\n                .viz-image-frame\r\n                  component.viz-image-frame-component(\r\n                        :is=\"viz.component\"\r\n                        :root=\"myState.svnProject.slug\"\r\n                        :subfolder=\"myState.subfolder\"\r\n                        :yamlConfig=\"viz.config\"\r\n                        :thumbnail=\"true\"\r\n                        :fileApi=\"myState.svnRoot\"\r\n                        :style=\"{'pointer-events': 'auto'}\"\r\n                        @title=\"updateTitle(index, $event)\")\r\n                  p {{ viz.title }}\r\n\r\n\r\n  //- .bottom-panel(v-if=\"!root\")\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\n// Typescript doesn't know the Chrome File System API\r\ndeclare const window: any\r\nconst BASE_URL = import.meta.env.BASE_URL\r\nconst NO_DASHBOARDS = ['.nodashboards', 'nodashboards', 'nodashboards.txt']\r\n\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      Maps: 'Maps & Dashboards',\r\n      Images: 'Images',\r\n      Analysis: 'Analysis',\r\n      Files: 'Files',\r\n      Folders: 'Folders',\r\n      Topsheet: 'Table',\r\n      privacy:\r\n        'SimWrapper is a client-side app, which means there is no upstream server collecting or storing data.\\n\\nSimWrapper does not collect, handle or process any data about you while you use the site. SimWrapper does not contain any tracking devices or analytics software. No user cookies are stored or transmitted.',\r\n    },\r\n    de: {\r\n      Maps: 'Karten',\r\n      Images: 'Bilder',\r\n      Analysis: 'Ergebnisse',\r\n      Files: 'Dateien',\r\n      Folders: 'Ordner',\r\n      Topsheet: 'Tabelle',\r\n    },\r\n  },\r\n}\r\n\r\nconst tabColors = {\r\n  // blank means dashboard:\r\n  '': '#118860',\r\n  // others are kebab-case:\r\n  'aggregate-od': '#E98B52',\r\n  'vehicle-anim': '#330033',\r\n  'x-y-t': '#583270',\r\n  carriers: '#c97A2C',\r\n  events: '#4400ff',\r\n  hexagons: '#900564',\r\n  map: '#c94264',\r\n  network: '#894654',\r\n  sankey: '#D8A672',\r\n  summary: '#2EA95B',\r\n  transit: '#3B6FE4',\r\n} as any\r\n\r\ninterface VizEntry {\r\n  component: string\r\n  config: string\r\n  title: string\r\n}\r\n\r\ninterface IMyState {\r\n  errorStatus: string\r\n  folders: string[]\r\n  files: string[]\r\n  isLoading: boolean\r\n  readme: string\r\n  svnProject: FileSystemConfig | null\r\n  svnRoot?: HTTPFileSystem\r\n  subfolder: string\r\n  summary: boolean\r\n  vizes: VizEntry[]\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\nimport type { PropType } from 'vue'\r\nimport { get, set, clear } from 'idb-keyval'\r\nimport markdown from 'markdown-it'\r\nimport mediumZoom from 'medium-zoom'\r\nimport micromatch from 'micromatch'\r\nimport yaml from 'yaml'\r\n\r\nimport globalStore from '@/store'\r\nimport { BreadCrumb, FileSystemConfig, YamlConfigs } from '@/Globals'\r\nimport plugins from '@/plugins/pluginRegistry'\r\nimport fileSystems, { addLocalFilesystem } from '@/fileSystemConfig'\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\nimport TopsheetsFinder from '@/components/TopsheetsFinder/TopsheetsFinder.vue'\r\nimport FileSystemProjects from '@/components/FileSystemProjects.vue'\r\nimport AddDataSource from './AddDataSource.vue'\r\n\r\nconst components = Object.assign({ AddDataSource, FileSystemProjects, TopsheetsFinder }, plugins)\r\n\r\nexport default defineComponent({\r\n  name: 'BrowserPanel',\r\n  i18n,\r\n  components,\r\n  data: () => {\r\n    return {\r\n      globalState: globalStore.state,\r\n      subfolder: '/',\r\n      root: '',\r\n      summaryYamlFilename: 'viz-summary.yml',\r\n      highlightedViz: -2, // -2:none, -1: dashboard, 0-x: tile\r\n      needDoubleClickHint: false,\r\n      allConfigFiles: { dashboards: {}, topsheets: {}, vizes: {}, configs: {} } as YamlConfigs,\r\n      allRoots: [] as FileSystemConfig[],\r\n      mdRenderer: new markdown({ html: true, linkify: true, typographer: true }),\r\n      myState: {\r\n        errorStatus: '',\r\n        folders: [],\r\n        files: [],\r\n        isLoading: false,\r\n        readme: '',\r\n        svnProject: null,\r\n        svnRoot: undefined,\r\n        subfolder: '',\r\n        vizes: [],\r\n        summary: false,\r\n      } as IMyState,\r\n      // we have really weird double-clicks; we want the single click to pass thru\r\n      // after a long delay. so this is how we do it\r\n      clicks: 0,\r\n      clickTimer: {} as any,\r\n    }\r\n  },\r\n  mounted() {\r\n    this.setupHints()\r\n    this.updateShortcuts()\r\n    this.getRootAndRoute(this.$route.params.pathMatch)\r\n  },\r\n\r\n  watch: {\r\n    'globalState.svnProjects'() {\r\n      this.updateShortcuts()\r\n    },\r\n    'globalState.colorScheme'() {\r\n      // medium-zoom freaks out if color theme is swapped.\r\n      // so let's reload images just in case.\r\n      this.fetchFolderContents()\r\n    },\r\n    subfolder() {\r\n      this.updateRoute()\r\n    },\r\n    'globalState.authAttempts'() {\r\n      this.authenticationChanged()\r\n    },\r\n    'myState.files'() {\r\n      this.filesChanged()\r\n    },\r\n  },\r\n  computed: {\r\n    hasDashboards(): boolean {\r\n      return !!Object.keys(this.allConfigFiles.dashboards).length\r\n      // const d = /^dashboard.*ml/\r\n      // for (const viz of this.myState.files) {\r\n      //   if (d.test(viz)) return true\r\n      // }\r\n      // return false\r\n    },\r\n\r\n    vizImages() {\r\n      const images: { [index: number]: any } = {}\r\n      for (let i = 0; i < this.myState.vizes.length; i++) {\r\n        if (this.myState.vizes[i].component === 'image-view') {\r\n          images[i] = this.myState.vizes[i]\r\n        }\r\n      }\r\n      return images\r\n    },\r\n\r\n    vizMaps() {\r\n      const skipList = ['image-view', 'dashboard']\r\n      const maps = new Map()\r\n\r\n      // Dashboards first\r\n      if (this.hasDashboards) {\r\n        maps.set(-1, {\r\n          component: '',\r\n          title: 'Dashboard Panel',\r\n        })\r\n      }\r\n\r\n      // Then vizes\r\n      for (let i = 0; i < this.myState.vizes.length; i++) {\r\n        if (!skipList.includes(this.myState.vizes[i].component)) {\r\n          maps.set(i, this.myState.vizes[i])\r\n        }\r\n      }\r\n\r\n      return maps\r\n    },\r\n    isChrome() {\r\n      return !!window.showDirectoryPicker\r\n    },\r\n\r\n    localFileHandles(): any[] {\r\n      // sort a copy of the array so we don't get an infinite loop\r\n      return this.$store.state.localFileHandles\r\n        .concat()\r\n        .sort((a: any, b: any) =>\r\n          parseInt(a.key.substring(2)) < parseInt(b.key.substring(2)) ? -1 : 1\r\n        )\r\n    },\r\n  },\r\n  methods: {\r\n    updateRoute() {\r\n      if (!this.root) return\r\n\r\n      const svnProject = this.getFileSystem(this.root)\r\n\r\n      this.myState.svnProject = svnProject\r\n      this.myState.subfolder = this.subfolder || ''\r\n      this.myState.readme = ''\r\n      this.highlightedViz = -2\r\n\r\n      if (!this.myState.svnProject) return\r\n\r\n      this.myState.svnRoot = new HTTPFileSystem(this.myState.svnProject, globalStore)\r\n\r\n      this.generateBreadcrumbs()\r\n\r\n      // this happens async\r\n      this.fetchFolderContents()\r\n    },\r\n\r\n    authenticationChanged() {\r\n      console.log('AUTH CHANGED - Reload')\r\n      this.updateRoute()\r\n    },\r\n\r\n    async filesChanged() {\r\n      // clear visualizations\r\n      this.myState.vizes = []\r\n      if (this.myState.files.length === 0) return\r\n\r\n      this.showReadme()\r\n\r\n      this.myState.summary = this.myState.files.indexOf(this.summaryYamlFilename) !== -1\r\n\r\n      if (this.myState.summary) {\r\n        await this.buildCuratedSummaryView()\r\n      } else {\r\n        this.buildShowEverythingView()\r\n      }\r\n\r\n      // make sure page is rendered before we attach zoom semantics\r\n      await this.$nextTick()\r\n      mediumZoom('.medium-zoom', {\r\n        background: '#444450',\r\n      })\r\n    },\r\n\r\n    updateShortcuts() {\r\n      const roots = this.globalState.svnProjects.filter(\r\n        source => !source.hidden && !source.slug.startsWith('fs')\r\n      )\r\n\r\n      this.allRoots = roots\r\n    },\r\n\r\n    cleanName(text: string) {\r\n      return decodeURIComponent(text)\r\n    },\r\n\r\n    getFileSystem(name: string) {\r\n      const svnProject: FileSystemConfig[] = globalStore.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === name\r\n      )\r\n\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n\r\n      return svnProject[0]\r\n    },\r\n\r\n    generateBreadcrumbs() {\r\n      if (!this.myState.svnProject) return []\r\n\r\n      const crumbs = [\r\n        {\r\n          label: 'SimWrapper',\r\n          url: '/',\r\n        },\r\n        {\r\n          label: this.myState.svnProject.name,\r\n          url: '/' + this.myState.svnProject.slug,\r\n        },\r\n      ]\r\n\r\n      const subfolders = this.myState.subfolder.split('/')\r\n      let buildFolder = '/'\r\n      for (const folder of subfolders) {\r\n        if (!folder) continue\r\n\r\n        buildFolder += folder + '/'\r\n        crumbs.push({\r\n          label: folder,\r\n          url: '/' + this.myState.svnProject.slug + buildFolder,\r\n        })\r\n      }\r\n\r\n      // save them!\r\n      globalStore.commit('setBreadCrumbs', crumbs)\r\n      return crumbs\r\n    },\r\n\r\n    setupHints() {\r\n      // if user has seen the hints a few times, drop them\r\n      let hints: any = localStorage.getItem('needsClickHint')\r\n      if (hints) {\r\n        hints = JSON.parse(hints) as number\r\n      } else {\r\n        hints = 0\r\n      }\r\n\r\n      if (hints > 5000) {\r\n        this.needDoubleClickHint = false\r\n      } else {\r\n        hints++\r\n        localStorage.setItem('needsClickHint', JSON.stringify(hints))\r\n      }\r\n    },\r\n\r\n    clickedBreadcrumb(crumb: { url: string }) {\r\n      this.getRootAndRoute(crumb.url.slice(1)) // drop leading slash\r\n    },\r\n\r\n    getRootAndRoute(pathMatch: string | undefined) {\r\n      if (!pathMatch) {\r\n        // console.log('NOPE')\r\n        return\r\n      }\r\n\r\n      // splash page:\r\n      if (pathMatch === '/') {\r\n        this.root = ''\r\n        return\r\n      }\r\n\r\n      // split panel:\r\n      if (pathMatch.startsWith('split/')) {\r\n        console.log('SPLIT')\r\n        // ?????\r\n        const payload = pathMatch.substring(6)\r\n        try {\r\n          // const content = atob(payload)\r\n          // const json = JSON.parse(content)\r\n          // this.panels = json\r\n        } catch (e) {\r\n          // couldn't do; you failed!\r\n          this.$router.replace('/')\r\n        }\r\n        return\r\n      }\r\n\r\n      // split out project root and subfolder\r\n      // console.log(777, pathMatch, JSON.stringify(this.myState))\r\n      let root = pathMatch\r\n      let subfolder = ''\r\n      const slash = pathMatch.indexOf('/')\r\n      if (slash > -1) {\r\n        root = pathMatch.substring(0, slash)\r\n        subfolder = pathMatch.substring(slash + 1)\r\n      }\r\n      this.root = root\r\n      this.subfolder = subfolder\r\n    },\r\n\r\n    activateVisualization(vizNumber: number) {\r\n      // if this is not a valid viz, just open the file/dashboard browser\r\n      const viz = this.myState.vizes[vizNumber] || {\r\n        component: 'TabbedDashboardView',\r\n        title: 'Dashboard',\r\n      }\r\n\r\n      // special case: images don't click thru\r\n      if (viz.component === 'image-view') return\r\n\r\n      if (!this.myState.svnProject) return\r\n\r\n      this.highlightedViz = -2\r\n\r\n      const cleanSubfolder = this.myState.subfolder.replaceAll('//', '/')\r\n      const props = {\r\n        root: this.myState.svnProject.slug,\r\n        xsubfolder: cleanSubfolder,\r\n        subfolder: cleanSubfolder,\r\n        yamlConfig: viz.config,\r\n        thumbnail: false,\r\n      }\r\n\r\n      this.$emit('navigate', { component: viz.component, props })\r\n    },\r\n\r\n    updateTitle(viz: number, title: string) {\r\n      this.myState.vizes[viz].title = title\r\n    },\r\n\r\n    configureSources() {\r\n      this.$emit('activate', { name: 'Settings', class: 'SettingsPanel' })\r\n    },\r\n\r\n    getTabColor(kebabName: string) {\r\n      const color = tabColors[kebabName] || '#8778BB'\r\n      return { backgroundColor: color }\r\n    },\r\n    async showReadme() {\r\n      this.myState.readme = ''\r\n      const readme = 'readme.md'\r\n      if (this.myState.files.map(f => f.toLocaleLowerCase()).indexOf(readme) > -1) {\r\n        if (!this.myState.svnRoot) return\r\n        const text = await this.myState.svnRoot.getFileText(this.myState.subfolder + '/' + readme)\r\n        this.myState.readme = this.mdRenderer.render(text)\r\n      }\r\n    },\r\n\r\n    buildShowEverythingView() {\r\n      // loop on each viz type\r\n      for (const viz of this.globalState.visualizationTypes.values()) {\r\n        // filter based on file matching\r\n        const matches = micromatch(this.myState.files, viz.filePatterns)\r\n        for (const file of matches) {\r\n          // add thumbnail for each matching file\r\n          this.myState.vizes.push({ component: viz.kebabName, config: file, title: '..' })\r\n        }\r\n      }\r\n    },\r\n\r\n    // Curate the view, if viz-summary.yml exists\r\n    async buildCuratedSummaryView() {\r\n      if (!this.myState.svnRoot) return\r\n\r\n      const summaryYaml = yaml.parse(\r\n        await this.myState.svnRoot.getFileText(\r\n          this.myState.subfolder + '/' + this.summaryYamlFilename\r\n        )\r\n      )\r\n\r\n      // loop on each curated viz type\r\n      for (const vizName of summaryYaml.plugins) {\r\n        // load plugin user asked for\r\n        const viz = this.globalState.visualizationTypes.get(vizName)\r\n        if (!viz) continue\r\n\r\n        // curate file list if provided for this plugin\r\n        if (summaryYaml[viz.kebabName]) {\r\n          for (const pattern of summaryYaml[viz.kebabName]) {\r\n            // add thumbnail for each matching file\r\n            const matches = await this.findMatchingFiles(pattern)\r\n            for (const file of matches) {\r\n              this.myState.vizes.push({ component: viz.kebabName, config: file, title: file })\r\n            }\r\n          }\r\n        } else {\r\n          // filter based on file matching\r\n          const matches = micromatch(this.myState.files, viz.filePatterns)\r\n          for (const file of matches) {\r\n            // add thumbnail for each matching file\r\n            this.myState.vizes.push({ component: viz.kebabName, config: file, title: '..' })\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    async findMatchingFiles(glob: string): Promise<string[]> {\r\n      // first see if file itself is in this folder\r\n      if (this.myState.files.indexOf(glob) > -1) return [glob]\r\n\r\n      // return globs in this folder\r\n      const matches = micromatch(this.myState.files, glob)\r\n      if (matches.length) return matches\r\n\r\n      // search subfolder for glob, for now just one subfolder down\r\n      if (!this.myState.svnRoot) return []\r\n      try {\r\n        const split = glob.split('/')\r\n        const subsubfolder = this.myState.subfolder + '/' + split[0]\r\n        console.log(subsubfolder)\r\n        const contents = await this.myState.svnRoot.getDirectory(subsubfolder)\r\n        const matches = micromatch(contents.files, split[1])\r\n        return matches.map(f => split[0] + '/' + f)\r\n      } catch (e) {\r\n        // oh well, we tried\r\n      }\r\n\r\n      return []\r\n    },\r\n\r\n    async fetchFolderContents() {\r\n      if (!this.myState.svnRoot) return []\r\n\r\n      this.myState.isLoading = true\r\n      this.myState.errorStatus = ''\r\n      this.myState.files = []\r\n\r\n      try {\r\n        this.allConfigFiles = await this.findAllConfigsAndDashboards()\r\n        const folderContents = await this.myState.svnRoot.getDirectory(this.myState.subfolder)\r\n\r\n        // hide dot folders\r\n        const folders = folderContents.dirs.filter(f => !f.startsWith('.')).sort()\r\n        const files = folderContents.files.filter(f => !f.startsWith('.')).sort()\r\n\r\n        // Also show any project-level viz thumbnails from other folders\r\n        // (but, ensure that files in this folder supercede any project viz files\r\n        // with the same name)\r\n        const mergedFilesAndVizes = Object.assign({}, this.allConfigFiles.vizes)\r\n        for (const file of files) {\r\n          mergedFilesAndVizes[file] = file\r\n        }\r\n\r\n        const allVizes = Object.values(mergedFilesAndVizes)\r\n\r\n        this.myState.errorStatus = ''\r\n        this.myState.folders = ['UP'].concat(folders)\r\n\r\n        this.myState.files = allVizes\r\n      } catch (err) {\r\n        // First see if we can get the one-up folder\r\n        const parent = this.myState.subfolder.lastIndexOf('/')\r\n\r\n        if (parent > -1) {\r\n          // subfolder is @Watched, this triggers a reset:\r\n          this.subfolder = this.myState.subfolder.slice(0, parent)\r\n          return\r\n        } else {\r\n          // top level fail?\r\n          this.subfolder = ''\r\n          return\r\n        }\r\n\r\n        // Bad things happened! Tell user\r\n        // const e = err as any\r\n        // console.log('BAD PAGE')\r\n        // console.log({ eeee: e })\r\n\r\n        // this.myState.folders = []\r\n        // this.myState.files = []\r\n\r\n        // this.myState.errorStatus = '<h3>'\r\n        // if (e.status) this.myState.errorStatus += `${e.status} `\r\n        // if (e.statusText) this.myState.errorStatus += `${e.statusText}`\r\n        // if (this.myState.errorStatus === '<h3>') this.myState.errorStatus += 'Error'\r\n        // this.myState.errorStatus += `</h3>`\r\n        // if (e.url) this.myState.errorStatus += `<p>${e.url}</p>`\r\n        // if (e.message) this.myState.errorStatus += `<p>${e.message}</p>`\r\n        // if (this.myState.errorStatus === '<h3>Error</h3>') this.myState.errorStatus = '' + e\r\n\r\n        // if (this.myState.svnProject) {\r\n        //   this.myState.errorStatus += `<p><i>${this.myState.svnProject.baseURL}${this.myState.subfolder}</i></p>`\r\n        // }\r\n\r\n        // // maybe it failed because password?\r\n        // if (this.myState.svnProject && this.myState.svnProject.needPassword && e.status === 401) {\r\n        //   globalStore.commit('requestLogin', this.myState.svnProject.slug)\r\n        // }\r\n      } finally {\r\n        this.myState.isLoading = false\r\n      }\r\n    },\r\n\r\n    clickedVisualization(index: number) {\r\n      // (props: { folder: string; i: number; root: string }) {\r\n      if (this.myState.isLoading) return\r\n\r\n      const DBL_CLICK_DELAY = 450\r\n\r\n      this.highlightedViz = index\r\n\r\n      this.clicks++\r\n      if (this.clicks === 1) {\r\n        // start timer to see if we get a second click\r\n        this.clickTimer = setTimeout(() => {\r\n          // nothing to do, just un-double click\r\n          // this.handleSingleClickFolder(props)\r\n          this.needDoubleClickHint = true\r\n          this.clicks = 0\r\n          // this.highlightedViz = -1\r\n        }, DBL_CLICK_DELAY)\r\n      } else {\r\n        // got a second click in time!\r\n        clearTimeout(this.clickTimer)\r\n        this.needDoubleClickHint = false\r\n        this.activateVisualization(index)\r\n        // do my double-click thing here\r\n        this.clicks = 0\r\n      }\r\n    },\r\n\r\n    clickedOnFolder(props: { folder: string; i: number; root: string }) {\r\n      this.needDoubleClickHint = false\r\n\r\n      const { folder, root, i } = props\r\n\r\n      if (root) {\r\n        this.root = root\r\n        this.subfolder = ''\r\n        this.updateRoute()\r\n        return\r\n      }\r\n\r\n      if (this.myState.isLoading) return\r\n      if (!this.myState.svnProject) return\r\n\r\n      // up button is a non-navigate case: might revisit this\r\n      if (i == 0 && folder === 'UP') {\r\n        if (this.subfolder === '/' || this.subfolder === '') {\r\n          this.root = ''\r\n        } else {\r\n          const lastSlash = this.subfolder.lastIndexOf('/')\r\n          this.subfolder = lastSlash > -1 ? this.subfolder.slice(0, lastSlash) : '/'\r\n        }\r\n        return\r\n      }\r\n\r\n      this.subfolder = `${this.subfolder}/${folder}`\r\n    },\r\n\r\n    handleSingleClickFolder(xprops: { folder: string; i: number; root: string }) {\r\n      const { folder, root, i } = xprops\r\n\r\n      if (root) {\r\n        this.root = root\r\n        this.subfolder = ''\r\n        this.updateRoute()\r\n        return\r\n      }\r\n\r\n      if (this.myState.isLoading) return\r\n      if (!this.myState.svnProject) return\r\n\r\n      if (i == 0 && folder === 'UP') return\r\n\r\n      const target =\r\n        folder === '..'\r\n          ? this.myState.subfolder.substring(0, this.myState.subfolder.lastIndexOf('/'))\r\n          : this.myState.subfolder + '/' + folder\r\n\r\n      const props = {\r\n        root: this.myState.svnProject.slug,\r\n        xsubfolder: target,\r\n      }\r\n\r\n      // if we are at top of hierarchy, jump to splashpage\r\n      if (!target && !this.myState.subfolder) {\r\n        this.$emit('navigate', { component: 'SplashPage', props: {} })\r\n      } else {\r\n        this.$emit('navigate', { component: 'TabbedDashboardView', props })\r\n      }\r\n    },\r\n\r\n    dragEnd() {\r\n      this.$emit('isDragging', false)\r\n    },\r\n\r\n    dragStart(event: DragEvent, item: any) {\r\n      this.$emit('isDragging', true)\r\n\r\n      const bundle = Object.assign({}, item, {\r\n        root: this.root,\r\n        subfolder: this.myState.subfolder,\r\n        xsubfolder: this.myState.subfolder,\r\n      }) as any\r\n\r\n      bundle.yamlConfig = bundle.config\r\n      delete bundle.config\r\n\r\n      const text = JSON.stringify(bundle) as any\r\n      event.dataTransfer?.setData('bundle', text)\r\n    },\r\n\r\n    clickedLogo() {\r\n      this.$router.push('/')\r\n    },\r\n\r\n    async findAllConfigsAndDashboards() {\r\n      if (!this.myState.svnRoot) return { dashboards: {}, configs: {}, vizes: {}, topsheets: {} }\r\n\r\n      let loadErrorMessage = ''\r\n\r\n      try {\r\n        const { files } = await this.myState.svnRoot.getDirectory(this.subfolder)\r\n\r\n        // if folder has .nodashboards, then skip all dashboards!\r\n        let showDashboards = true\r\n        NO_DASHBOARDS.forEach(filename => {\r\n          if (files.indexOf(filename) > -1) {\r\n            showDashboards = false\r\n          }\r\n        })\r\n\r\n        const allConfigs = await this.myState.svnRoot.findAllYamlConfigs(this.subfolder)\r\n\r\n        // force hide dashboards if user has a .nodashboards file\r\n        if (!showDashboards) allConfigs.dashboards = {}\r\n        return allConfigs\r\n      } catch (e) {\r\n        // console.error('' + e)\r\n        return { dashboards: {}, configs: {}, vizes: {}, topsheets: {} }\r\n        // throw Error('' + e)\r\n      }\r\n    },\r\n\r\n    async clickedBrowseChromeLocalFolder(row: { key: string; handle: any }) {\r\n      try {\r\n        const status = await row.handle.requestPermission({ mode: 'read' })\r\n        console.log(row.handle, status)\r\n\r\n        if (status !== 'granted') return\r\n\r\n        // if first time, add its key to the fileSystemConfig\r\n        const exists = fileSystems.find(f => f.slug == row.key)\r\n        if (!exists) addLocalFilesystem(row.handle, row.key)\r\n\r\n        const props = { root: row.key } as any\r\n        this.clickedOnFolder(props)\r\n      } catch (e) {\r\n        console.error('' + e)\r\n      }\r\n    },\r\n\r\n    async showChromeDirectory() {\r\n      try {\r\n        const FileSystemDirectoryHandle = window.showDirectoryPicker()\r\n        const dir = await FileSystemDirectoryHandle\r\n        const slug = addLocalFilesystem(dir, null) // no key yet\r\n        this.$router.push(`${BASE_URL}${slug}/`)\r\n      } catch (e) {\r\n        // shrug\r\n      }\r\n    },\r\n\r\n    async clickedDelete(row: { key: string; handle: any }) {\r\n      const handles = this.$store.state.localFileHandles\r\n      // just filter out the key I guess?\r\n      const filtered = handles.filter((f: any) => f.key !== row.key)\r\n\r\n      // and save it everywhere\r\n      await set('fs', filtered)\r\n      this.$store.commit('setLocalFileSystem', filtered)\r\n    },\r\n    // - END Chrome File System Access API support\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n.panel {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  padding-top: 0.25rem;\r\n  user-select: none;\r\n  font-size: 0.9rem;\r\n  color: var(--text);\r\n}\r\n\r\n.top-panel {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin: 0.25rem 1rem 1rem 1rem;\r\n}\r\n\r\nh4 {\r\n  background-color: #00000080;\r\n  text-transform: uppercase;\r\n  text-align: center;\r\n  padding: 0.25rem 0.5rem;\r\n  margin-bottom: 0.25rem;\r\n  font-weight: bold;\r\n  text-transform: uppercase;\r\n  color: #ddd;\r\n}\r\n\r\n.middle-panel,\r\n.bottom-panel {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  // width: 100%;\r\n  margin-bottom: 0rem;\r\n  padding: 0 1rem;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n  text-align: left;\r\n  user-select: none;\r\n\r\n  h1 {\r\n    letter-spacing: -1px;\r\n  }\r\n  h3 {\r\n    font-size: 1.2rem;\r\n    border-bottom: 1px solid #cccccc80;\r\n    margin-top: 0rem;\r\n    margin-bottom: 0.25rem;\r\n  }\r\n\r\n  p,\r\n  a {\r\n    max-width: 100%;\r\n    overflow-wrap: break-word;\r\n  }\r\n}\r\n\r\n.bottom-panel {\r\n  padding: 0 0.5rem 0.25rem 0.5rem;\r\n  flex: unset;\r\n}\r\n\r\n.white {\r\n  background-color: var(--bgBold);\r\n}\r\n\r\n.cream {\r\n  background-color: var(--bgCream);\r\n}\r\n\r\nh2 {\r\n  font-size: 1.8rem;\r\n}\r\n\r\n.badnews {\r\n  border-left: 3rem solid #af232f;\r\n  margin: 0rem 0rem;\r\n  padding: 0.5rem 0rem;\r\n  background-color: #ffc;\r\n  color: $matsimBlue;\r\n}\r\n\r\n.viz-table {\r\n  display: flex;\r\n  flex-direction: column;\r\n  list-style: none;\r\n}\r\n\r\n.viz-grid-item {\r\n  z-index: 1;\r\n  margin: 4px 0;\r\n  // padding: 2px 2px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  cursor: pointer;\r\n  background-color: var(--bgMapPanel);\r\n  border-radius: 4px;\r\n}\r\n\r\n.viz-frame-component {\r\n  background-color: var(--bgPanel);\r\n}\r\n\r\n.folder-table {\r\n  display: grid;\r\n  gap: 2px;\r\n  grid-template-columns: repeat(auto-fit, minmax(115px, 1fr));\r\n  list-style: none;\r\n  margin-top: 0.5rem;\r\n  padding-left: 0px;\r\n}\r\n\r\n.folder {\r\n  cursor: pointer;\r\n  display: flex;\r\n  flex-direction: row;\r\n  background-color: var(--bgMapPanel);\r\n  color: var(--text);\r\n  line-height: 1.05rem;\r\n  padding: 3px 4px;\r\n  border-radius: 0;\r\n  word-wrap: break-word;\r\n\r\n  i {\r\n    margin-top: 1px;\r\n  }\r\n  p {\r\n    margin-left: 4px;\r\n  }\r\n}\r\n\r\n.folder:hover {\r\n  background-color: var(--bgHover);\r\n  // box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.08), 0 3px 10px 0 rgba(0, 0, 0, 0.08);\r\n  transition: background-color 0.08s ease-in-out;\r\n}\r\n\r\n.fade {\r\n  opacity: 0.4;\r\n  pointer-events: none;\r\n}\r\n\r\n.curated-sections {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.curate-heading {\r\n  padding: 0rem 0rem;\r\n  margin: 0rem 0rem;\r\n}\r\n\r\n.curate-content {\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.viz-image-table {\r\n  display: grid;\r\n  grid-gap: 2rem;\r\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\r\n  list-style: none;\r\n}\r\n\r\n.viz-image-grid-item {\r\n  z-index: 1;\r\n  text-align: center;\r\n  margin: 0 0;\r\n  padding: 0 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  cursor: pointer;\r\n  vertical-align: top;\r\n  background-color: var(--bgBold);\r\n  border: var(--borderThin);\r\n  border-radius: 16px;\r\n}\r\n\r\n.viz-image-frame {\r\n  position: relative;\r\n  z-index: 1;\r\n  flex: 1;\r\n  min-height: $thumbnailHeight;\r\n  border-radius: 16px;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n\r\n  p {\r\n    margin: 0 0 0 0;\r\n    background-color: var(--bgBold);\r\n    font-weight: bold;\r\n    line-height: 1.2rem;\r\n    padding: 1rem 0.5rem;\r\n    color: var(--text);\r\n    word-wrap: break-word;\r\n    /* Required for text-overflow to do anything */\r\n    // text-overflow: ellipsis;\r\n    // white-space: nowrap;\r\n    // overflow: hidden;\r\n  }\r\n}\r\n\r\n.viz-image-frame:hover {\r\n  box-shadow: var(--shadowMode);\r\n  transition: box-shadow 0.1s ease-in-out;\r\n}\r\n\r\n.viz-image-frame-component {\r\n  background-color: var(--bgPanel);\r\n}\r\n\r\n.upfolder {\r\n  background-color: var(--bgBold);\r\n}\r\n\r\n.fa-arrow-up {\r\n  margin-right: 2px;\r\n}\r\n\r\n.project-root {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-top: 0.75rem;\r\n  padding: 0.5rem 0.5rem;\r\n  background-color: var(--bgMapPanel);\r\n  border-left: 3px solid var(--sliderThumb);\r\n\r\n  h5 {\r\n    font-size: 1rem;\r\n    line-height: 1rem;\r\n    font-weight: bold;\r\n    margin-bottom: 0.25rem;\r\n  }\r\n\r\n  p {\r\n    line-height: 1.1rem;\r\n  }\r\n}\r\n\r\n.project-root.local {\r\n  border-left: 3px solid $matsimBlue;\r\n}\r\n\r\n.project-root:hover {\r\n  cursor: pointer;\r\n  background-color: var(--bgHover);\r\n  transition: background-color 0.1s ease-in-out;\r\n}\r\n\r\n.flex-row {\r\n  display: flex;\r\n  flex-direction: row;\r\n}\r\n\r\n.hint-clicks {\r\n  margin: 0 0 0 0;\r\n  line-height: 1.2rem;\r\n  opacity: 0;\r\n  transition: opacity 0.2s ease-in;\r\n\r\n  p {\r\n    padding-bottom: 0.5rem;\r\n    text-align: center;\r\n  }\r\n\r\n  b {\r\n    color: var(--textFancy);\r\n  }\r\n}\r\n\r\n.config-sources {\r\n  margin-top: 0.5rem;\r\n  text-align: right;\r\n  a {\r\n    color: var(--text);\r\n  }\r\n}\r\n\r\n.config-sources a:hover {\r\n  cursor: pointer;\r\n  color: var(--linkHover);\r\n}\r\n\r\n.viz-frame {\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: relative;\r\n  z-index: 1;\r\n  flex: 1;\r\n  overflow: hidden;\r\n  padding: 4px 0 0 4px;\r\n  border-radius: 3px;\r\n  p {\r\n    margin: 0 0 0 0;\r\n    line-height: 1rem;\r\n    padding: 0 0;\r\n    color: var(--text);\r\n    word-wrap: break-word;\r\n    /* Required for text-overflow to do anything */\r\n    // text-overflow: ellipsis;\r\n    // white-space: nowrap;\r\n    // overflow: hidden;\r\n  }\r\n}\r\n\r\n.viz-frame:hover {\r\n  background-color: var(--bgHover);\r\n  border-radius: 3px;\r\n  transition: background-color 0.08s ease-in-out;\r\n}\r\n\r\n.highlighted {\r\n  background-color: var(--bgHover);\r\n}\r\n\r\n// p.v-title {\r\n//   // font-size: 1rem;\r\n// }\r\n\r\np.v-filename {\r\n  margin: 5px 0;\r\n}\r\n\r\np.v-plugin {\r\n  text-align: right;\r\n  text-transform: lowercase;\r\n  margin-left: auto;\r\n  color: white;\r\n  background-color: var(--bgCream3);\r\n  padding: 2px 3px;\r\n  border-radius: 0 0 4px 0;\r\n}\r\n\r\n.trail {\r\n  display: flex;\r\n  width: 100%;\r\n  // color: var(--link);\r\n  p:hover {\r\n    color: var(--linkHover);\r\n    cursor: pointer;\r\n  }\r\n}\r\n\r\n.x-breadcrumbs {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-flow: row wrap;\r\n  line-height: 1.2rem;\r\n  max-width: 100%;\r\n  margin-top: 2px;\r\n\r\n  p {\r\n    width: max-content;\r\n  }\r\n\r\n  p:hover {\r\n    color: var(--linkHover);\r\n    cursor: pointer;\r\n  }\r\n}\r\n\r\n.add-folder {\r\n  margin-top: 1rem;\r\n}\r\n\r\n.fa-times {\r\n  opacity: 0;\r\n  float: right;\r\n  padding: 1px 1px;\r\n}\r\n\r\n.fa-times:hover {\r\n  color: red;\r\n}\r\n\r\n.fa-times:active {\r\n  color: darkred;\r\n}\r\n\r\n.project-root:hover .fa-times {\r\n  opacity: 0.15;\r\n}\r\n\r\n.project-root:hover .fa-times:hover {\r\n  opacity: 1;\r\n}\r\n\r\n.logo {\r\n  margin: 1.5rem auto 0.5rem auto;\r\n}\r\n\r\n.logo:hover {\r\n  color: var(--linkHover);\r\n  cursor: pointer;\r\n}\r\n</style>\r\n","\r\n.panel\r\n\r\n  .top-panel\r\n    h4 Files\r\n\r\n    .trail(v-if=\"root\")\r\n      .x-home\r\n        p(@click=\"clickedBreadcrumb({url: '//'})\")\r\n          i.fa.fa-home\r\n\r\n      .x-breadcrumbs(v-if=\"root\")\r\n        p(v-for=\"crumb,i in globalState.breadcrumbs.slice(1)\" :key=\"crumb.url\"\r\n          @click=\"clickedBreadcrumb(crumb)\"\r\n        ) &nbsp;/&nbsp;{{ crumb.label }}\r\n\r\n  .middle-panel\r\n      //- Starting point if not in a project root: list all existing roots\r\n      .curated-sections(v-if=\"!root\")\r\n\r\n        .hint-clicks(style=\"margin-bottom: 1rem; opacity: 1\")\r\n          p You can browse to another folder from here. Drag panels into the main window area to open them side-by-side.\r\n\r\n        .is-chrome(v-if=\"isChrome\")\r\n          h3 Local Folders\r\n\r\n          p(v-if=\"!localFileHandles.length\") Chrome & Edge can browse folders directly:\r\n          .project-root.local(v-for=\"row in localFileHandles\" :key=\"row.key\"\r\n            @click=\"clickedBrowseChromeLocalFolder(row)\")\r\n\r\n            h5.remove-local(style=\"flex: 1;\") {{ row.handle.name}}\r\n              i.fa.fa-times(@click.stop=\"clickedDelete(row)\")\r\n            p Local folder\r\n\r\n          p.config-sources: a(@click=\"showChromeDirectory\") Add local folder...\r\n\r\n        h3(style=\"margin-top: 1rem\") Data Sources\r\n\r\n        .project-root(v-for=\"project in allRoots\" :key=\"project.slug\"\r\n          @click=\"clickedOnFolder({root: project.slug})\"\r\n        )\r\n          h5 {{ project.name }}\r\n          p {{ project.description }}\r\n\r\n        p.config-sources: a(@click=\"configureSources\") Edit data sources...\r\n\r\n      //- Starting point if in a project folder: -------------------------\r\n      .curated-sections(v-else)\r\n\r\n        h3.curate-heading {{ globalState.breadcrumbs[globalState.breadcrumbs.length - 1].label }}\r\n\r\n        .curate-content(v-if=\"myState.folders.length\")\r\n          .folder-table\r\n            .folder(v-for=\"folder,i in myState.folders\" :key=\"folder\"\r\n                :class=\"{fade: myState.isLoading, upfolder: i == 0}\"\r\n                @click=\"clickedOnFolder({folder, i})\")\r\n              i.fa(:class=\"i == 0 ? 'fa-arrow-up' : 'fa-folder-open'\")\r\n              p {{ cleanName(folder) }}\r\n\r\n          p(v-if=\"myState.folders.length==1\" style=\"font-size: 0.9rem; opacity: 0.7; margin: 0.5rem 0; text-align: right\") No subfolders.\r\n\r\n        //- MAPS: thumbnails of each viz map here\r\n        .section-maps(v-if=\"vizMaps.size\")\r\n\r\n          h3.curate-heading {{ $t('Maps')}}\r\n          .curate-content\r\n            .viz-table\r\n              .viz-grid-item(\r\n                v-for=\"[index, viz] of vizMaps.entries()\" :key=\"index\"\r\n                @click=\"clickedVisualization(index)\"\r\n              )\r\n                .viz-frame(\r\n                  :class=\"{highlighted: index === highlightedViz }\"\r\n                  draggable\r\n                  @dragstart=\"dragStart($event, viz)\"\r\n                  @dragend=\"dragEnd\"\r\n                )\r\n                  p.v-title: b {{ viz.title }}\r\n                  p.v-filename {{ viz.config }}\r\n                  p.v-plugin(:style=\"getTabColor(viz.component)\") {{ viz.component || 'dashboard' }}\r\n\r\n                  component.viz-frame-component(\r\n                        v-show=\"false\"\r\n                        :is=\"viz.component\"\r\n                        :root=\"myState.svnProject.slug\"\r\n                        :subfolder=\"myState.subfolder\"\r\n                        :yamlConfig=\"viz.config\"\r\n                        :thumbnail=\"true\"\r\n                        :fileApi=\"myState.svnRoot\"\r\n                        :style=\"{'pointer-events': 'none'}\"\r\n                        @title=\"updateTitle(index, $event)\")\r\n\r\n            .hint-clicks(:style=\"{opacity : needDoubleClickHint ? 1 : 0}\")\r\n              p\r\n                b Drag\r\n                | &nbsp;or&nbsp;\r\n                b double-click\r\n                | &nbsp;a tile\r\n                br\r\n                | to open it in the main panel\r\n\r\n        //- IMAGES here\r\n        .section-images(v-if=\"Object.keys(vizImages).length\")\r\n          h3.curate-heading {{ $t('Images')}}\r\n          .curate-content\r\n            .viz-image-table\r\n              .viz-image-grid-item(v-for=\"[index, viz] of Object.entries(vizImages)\" :key=\"index\"\r\n                        @click=\"clickedVisualization(index)\")\r\n\r\n                .viz-image-frame\r\n                  component.viz-image-frame-component(\r\n                        :is=\"viz.component\"\r\n                        :root=\"myState.svnProject.slug\"\r\n                        :subfolder=\"myState.subfolder\"\r\n                        :yamlConfig=\"viz.config\"\r\n                        :thumbnail=\"true\"\r\n                        :fileApi=\"myState.svnRoot\"\r\n                        :style=\"{'pointer-events': 'auto'}\"\r\n                        @title=\"updateTitle(index, $event)\")\r\n                  p {{ viz.title }}\r\n\r\n\r\n  //- .bottom-panel(v-if=\"!root\")\r\n\r\n","<template lang=\"pug\">\r\n.panel\r\n\r\n  .top-panel\r\n    h4 Settings\r\n\r\n  .middle-panel\r\n\r\n    // theme ------------------\r\n    .option\r\n      h5 {{ $t('theme') }}\r\n      b-button.button.is-white(@click=\"setTheme('light')\"\r\n        outlined\r\n        :style=\"isLight\") {{ $t('light') }}\r\n\r\n      b-button.button.is-gray(@click=\"setTheme('dark')\"\r\n        outlined\r\n        :style=\"isDark\") {{ $t('dark') }}\r\n\r\n    // language ---------------\r\n    .option\r\n      h5 {{ $t('language') }}\r\n      b-button.button.is-white(@click=\"setLanguage('en')\"\r\n        outlined\r\n        :style=\"isEN\") EN\r\n\r\n      b-button.button.is-gray(@click=\"setLanguage('de')\"\r\n        outlined\r\n        :style=\"isDE\") DE\r\n\r\n    .option\r\n      h5 {{ $t('dataSources') }}\r\n      .source.flex-row(v-for=\"root in shortcuts\" :key=\"root.slug\")\r\n        .desc.flex1\r\n          p: b {{ root.slug }}\r\n          p {{ root.description}}\r\n        .delete(@click=\"deleteShortcut(root.slug)\")\r\n\r\n    .option\r\n      h5 {{ $t('addDataSources') }}\r\n      add-data-source\r\n\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      translate: 'Note: German translations are incomplete, but steadily improving',\r\n      theme: 'Theme',\r\n      light: 'Light',\r\n      dark: 'Dark',\r\n      language: 'Language',\r\n      dataSources: 'Data Sources',\r\n      addDataSources: 'Add Data Source',\r\n    },\r\n    de: {\r\n      translate: 'Die Übersetzungen sind unvollständig, werden aber immer besser...',\r\n      theme: 'Thema',\r\n      light: 'Hell',\r\n      dark: 'Dunkel',\r\n      language: 'Sprache',\r\n      dataSources: 'Datenquellen',\r\n    },\r\n  },\r\n}\r\n\r\nimport { defineComponent } from 'vue'\r\n\r\nimport globalStore from '@/store'\r\nimport AddDataSource from './AddDataSource.vue'\r\n\r\nexport default defineComponent({\r\n  name: 'SettingsPanel',\r\n  components: { AddDataSource },\r\n  i18n,\r\n  data: () => {\r\n    return {\r\n      state: globalStore.state,\r\n      theme: '',\r\n      shortcuts: [] as any[],\r\n    }\r\n  },\r\n  mounted() {\r\n    this.theme = this.state.isDarkMode ? 'dark' : 'light'\r\n    this.setupShortcuts()\r\n  },\r\n  watch: {\r\n    'state.svnProjects'() {\r\n      this.setupShortcuts()\r\n    },\r\n    'state.isDarkMode'() {\r\n      console.log('ooop!', this.state.isDarkMode)\r\n      this.theme = this.state.isDarkMode ? 'dark' : 'light'\r\n    },\r\n  },\r\n  computed: {\r\n    isLight(): any {\r\n      return this.theme == 'light'\r\n        ? {\r\n            backgroundColor: '#ffdd57',\r\n            color: '#222',\r\n            borderColor: '#aaa',\r\n          }\r\n        : {\r\n            backgroundColor: 'unset',\r\n            color: '#888',\r\n            borderColor: '#aaa',\r\n          }\r\n    },\r\n\r\n    isDark(): any {\r\n      return this.theme == 'dark'\r\n        ? {\r\n            backgroundColor: '#7957d5',\r\n            color: 'white',\r\n            borderColor: '#aaa',\r\n          }\r\n        : {\r\n            backgroundColor: 'unset',\r\n            color: '#888',\r\n            borderColor: '#aaa',\r\n          }\r\n    },\r\n\r\n    isEN(): any {\r\n      return this.state.locale == 'en'\r\n        ? {\r\n            backgroundColor: '#ffdd57',\r\n            color: '#222',\r\n            borderColor: '#aaa',\r\n          }\r\n        : {\r\n            backgroundColor: 'unset',\r\n            color: '#888',\r\n            borderColor: '#aaa',\r\n          }\r\n    },\r\n\r\n    isDE(): any {\r\n      return this.state.locale == 'de'\r\n        ? {\r\n            backgroundColor: '#ffdd57',\r\n            color: '#222',\r\n            borderColor: '#aaa',\r\n          }\r\n        : {\r\n            backgroundColor: 'unset',\r\n            color: '#888',\r\n            borderColor: '#aaa',\r\n          }\r\n    },\r\n  },\r\n  methods: {\r\n    setupShortcuts() {\r\n      try {\r\n        const storedShortcuts = localStorage.getItem('projectShortcuts')\r\n        if (storedShortcuts) {\r\n          const roots = JSON.parse(storedShortcuts) as any\r\n          this.shortcuts = Object.values(roots)\r\n        }\r\n      } catch (e) {\r\n        console.error('ERROR MERGING URL SHORTCUTS:', '' + e)\r\n      }\r\n    },\r\n\r\n    deleteShortcut(slug: string) {\r\n      try {\r\n        const storedShortcuts = localStorage.getItem('projectShortcuts')\r\n        if (storedShortcuts) {\r\n          const roots = JSON.parse(storedShortcuts) as any\r\n          delete roots[slug]\r\n\r\n          localStorage.setItem('projectShortcuts', JSON.stringify(roots))\r\n          globalStore.commit('removeURLShortcut', slug)\r\n          this.shortcuts = Object.values(roots)\r\n        }\r\n      } catch (e) {\r\n        console.error('ERROR MERGING URL SHORTCUTS:', '' + e)\r\n      }\r\n    },\r\n\r\n    setTheme(theme: string) {\r\n      this.theme = theme\r\n      console.log(this.theme)\r\n      globalStore.commit('setTheme', theme)\r\n    },\r\n\r\n    setLanguage(lang: string) {\r\n      this.$store.commit('setLocale', lang)\r\n      this.$root.$i18n.locale = lang\r\n    },\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.panel {\r\n  user-select: none;\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  padding: 0.25rem 0;\r\n  color: var(--text);\r\n  font-size: 0.9rem;\r\n}\r\n\r\nh4 {\r\n  background-color: #00000080;\r\n  text-transform: uppercase;\r\n  text-align: center;\r\n  padding: 0.25rem 0.5rem;\r\n  margin-bottom: 0.5rem;\r\n  font-weight: bold;\r\n  color: #ddd;\r\n}\r\n\r\nh5 {\r\n  color: var(--textBold);\r\n  font-weight: bold;\r\n  margin-top: 0rem;\r\n  margin-bottom: 0.25rem;\r\n}\r\n\r\n.top-panel {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin: 0.25rem 0.5rem 0rem 0.5rem;\r\n}\r\n\r\n.bottom-panel {\r\n  margin: 1rem 0.5rem;\r\n}\r\n\r\n.settings-area {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 0rem 0rem;\r\n  overflow-y: auto;\r\n}\r\n\r\n.message-area h3 {\r\n  margin-top: 1rem;\r\n  font-size: 1.2rem;\r\n}\r\n\r\n::-webkit-scrollbar-corner {\r\n  background: rgba(0, 0, 0, 0);\r\n}\r\n\r\n.button {\r\n  margin-right: 0.25rem;\r\n  width: 60px;\r\n}\r\n\r\n.button:hover {\r\n  border: 1px solid white !important;\r\n}\r\n\r\n.option {\r\n  margin-top: 2rem;\r\n\r\n  h5 {\r\n    text-transform: uppercase;\r\n  }\r\n\r\n  p {\r\n    margin-top: 0.5rem;\r\n    line-height: 1.2rem;\r\n  }\r\n}\r\n\r\n.middle-panel {\r\n  flex: 1;\r\n  display: flex;\r\n  width: 100%;\r\n  flex-direction: column;\r\n  margin-bottom: 0.5rem;\r\n  padding: 0 0.5rem 0rem 0.5rem;\r\n  overflow-y: auto;\r\n  user-select: none;\r\n}\r\n\r\n.slide-right {\r\n  padding-left: 1rem;\r\n}\r\n\r\n.source {\r\n  // margin-left: 1rem;\r\n  margin-bottom: 3px;\r\n  background-color: var(--bgCream4);\r\n}\r\n\r\n.source .desc p {\r\n  margin: 0 0;\r\n  padding: 1px 4px;\r\n}\r\n\r\n.delete {\r\n  margin: 2px 2px;\r\n  opacity: 0.4;\r\n}\r\n\r\n.delete:hover {\r\n  opacity: 1;\r\n  background-color: red;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n}\r\n</style>\r\n","\r\n.panel\r\n\r\n  .top-panel\r\n    h4 Settings\r\n\r\n  .middle-panel\r\n\r\n    // theme ------------------\r\n    .option\r\n      h5 {{ $t('theme') }}\r\n      b-button.button.is-white(@click=\"setTheme('light')\"\r\n        outlined\r\n        :style=\"isLight\") {{ $t('light') }}\r\n\r\n      b-button.button.is-gray(@click=\"setTheme('dark')\"\r\n        outlined\r\n        :style=\"isDark\") {{ $t('dark') }}\r\n\r\n    // language ---------------\r\n    .option\r\n      h5 {{ $t('language') }}\r\n      b-button.button.is-white(@click=\"setLanguage('en')\"\r\n        outlined\r\n        :style=\"isEN\") EN\r\n\r\n      b-button.button.is-gray(@click=\"setLanguage('de')\"\r\n        outlined\r\n        :style=\"isDE\") DE\r\n\r\n    .option\r\n      h5 {{ $t('dataSources') }}\r\n      .source.flex-row(v-for=\"root in shortcuts\" :key=\"root.slug\")\r\n        .desc.flex1\r\n          p: b {{ root.slug }}\r\n          p {{ root.description}}\r\n        .delete(@click=\"deleteShortcut(root.slug)\")\r\n\r\n    .option\r\n      h5 {{ $t('addDataSources') }}\r\n      add-data-source\r\n\r\n\r\n","<template lang=\"pug\">\r\n#split-screen(\r\n  @mousemove=\"dividerDragging\"\r\n  @mouseup=\"dividerDragEnd\"\r\n  :style=\"{'userSelect': isDraggingDivider ? 'none' : 'unset'}\"\r\n)\r\n  .left-panel(v-show=\"showLeftBar\")\r\n    left-icon-panel(\r\n      :activeSection=\"activeLeftSection.name\"\r\n      @activate=\"setActiveLeftSection({section: $event, toggle:true})\"\r\n    )\r\n\r\n    .left-panel-active-section(v-show=\"isShowingActiveSection\"\r\n                               :style=\"activeSectionStyle\"\r\n    )\r\n      component(v-for=\"section of leftSections\" :key=\"section\"\r\n                :is=\"section\"\r\n                v-show=\"section==activeLeftSection.class\"\r\n                @navigate=\"onNavigate($event,0,0)\"\r\n                @activate=\"setActiveLeftSection({section: $event, toggle:false})\"\r\n                @isDragging=\"handleDragStartStop\"\r\n      )\r\n\r\n    .left-panel-divider(v-show=\"activeLeftSection\"\r\n                        @mousedown=\"dividerDragStart\"\r\n                        @mouseup=\"dividerDragEnd\"\r\n                        @mousemove.stop=\"dividerDragging\"\r\n    )\r\n\r\n  .table-of-tiles(ref=\"tileTable\")\r\n    .authorization-strip(v-if=\"authHandles.length\")\r\n      .auth-row(v-for=\"auth in authHandles\")\r\n        p.flex1 {{ '' + auth }}\r\n        b-button hello\r\n\r\n    .row-drop-target(:style=\"buildDragHighlightStyle(-1,-1)\"\r\n        @drop=\"onDrop({event: $event, row: 'rowTop'})\"\r\n        @dragover=\"stillDragging({event: $event, row: 'rowTop'})\"\r\n        @dragover.prevent\r\n        @dragenter.prevent\r\n        @dragleave=\"dragEnd\"\r\n    )\r\n\r\n    .tile-row(v-for=\"panelRow,y in panels\" :key=\"y\"\r\n        v-show=\"fullScreenPanel.y == -1 || fullScreenPanel.y == y\"\r\n    )\r\n\r\n      .drag-container(\r\n        v-for=\"panel,x in panelRow\" :key=\"panel.key\"\r\n        @drop=\"onDrop({event: $event,x,y})\"\r\n        @dragover.prevent\r\n        @dragenter.prevent\r\n        @dragover=\"stillDragging({event: $event,x,y})\"\r\n        @dragleave=\"dragEnd\"\r\n        :ref=\"`dragContainer${x}-${y}`\"\r\n        :style=\"getContainerStyle(panel,x,y)\"\r\n      )\r\n        .tile-header.flex-row(v-if=\"getShowHeader(panel)\")\r\n\r\n          .tile-labels\r\n            h3(:style=\"{textAlign: isMultipanel ? 'left' : 'center'}\") {{ panel.title }}\r\n            p(v-if=\"panel.description\") {{ panel.description }}\r\n\r\n          .tile-buttons\r\n            .nav-button.is-small.is-white(\r\n              v-if=\"panel.info\"\r\n              @click=\"handleToggleInfoClicked(panel)\"\r\n            ): i.fa.fa-info-circle\r\n            //- :title=\"infoToggle[panel.id] ? 'Hide Info':'Show Info'\"\r\n\r\n            .nav-button.is-small.is-white(\r\n              v-show=\"panels.length > 1 || panels[0].length > 1\"\r\n              @click=\"toggleZoom(panel, x, y)\"\r\n              :title=\"fullScreenPanel.x > -1 ? 'Restore':'Enlarge'\"\r\n            ): i.fa.fa-expand\r\n\r\n            .nav-button.is-small.is-white(\r\n              @click=\"onClose(x,y)\"\r\n              title=\"Close\"\r\n            ): i.fa.fa-times-circle\r\n\r\n        //- here is the actual viz component:\r\n        component.map-tile(\r\n          :is=\"panel.component\"\r\n          :style=\"getTileStyle(panel)\"\r\n          v-bind=\"cleanProps(panel.props)\"\r\n          @navigate=\"onNavigate($event,x,y)\"\r\n          @title=\"setCardTitles(panel, $event)\"\r\n          @activate=\"setActiveLeftSection({section: $event, toggle:true})\"\r\n        )\r\n\r\n        .drag-highlight(v-if=\"isDragHappening\" :style=\"buildDragHighlightStyle(x,y)\")\r\n\r\n    .row-drop-target(v-if=\"isDragHappening\" :style=\"buildDragHighlightStyle(-2,-2)\"\r\n                    @drop=\"onDrop({event: $event, row: 'rowBottom'})\"\r\n                    @dragover=\"stillDragging({event: $event, row: 'rowBottom'})\"\r\n                    @dragover.prevent\r\n                    @dragenter.prevent\r\n                    @dragleave=\"dragEnd\"\r\n    )\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: { close: 'Close panel', back: 'Go back' },\r\n    de: { close: 'Schließen', back: 'Zurück' },\r\n  },\r\n}\r\n\r\nimport Vue, { defineComponent } from 'vue'\r\n\r\nimport { Route } from 'vue-router'\r\nimport micromatch from 'micromatch'\r\n\r\nimport globalStore from '@/store'\r\nimport plugins from '@/plugins/pluginRegistry'\r\n\r\nimport TabbedDashboardView from './TabbedDashboardView.vue'\r\nimport SplashPage from './SplashPage.vue'\r\nimport FolderBrowser from './FolderBrowser.vue'\r\n\r\nimport LeftIconPanel, { Section } from '@/components/left-panels/LeftIconPanel.vue'\r\nimport ErrorPanel from '@/components/left-panels/ErrorPanel.vue'\r\nimport BrowserPanel from '@/components/left-panels/BrowserPanel.vue'\r\nimport SettingsPanel from '@/components/left-panels/SettingsPanel.vue'\r\nimport { FileSystemConfig } from '@/Globals'\r\n\r\nconst BASE_URL = import.meta.env.BASE_URL\r\nconst DEFAULT_LEFT_WIDTH = 300\r\n\r\nexport default defineComponent({\r\n  name: 'LayoutManager',\r\n  i18n,\r\n  components: Object.assign(\r\n    {\r\n      LeftIconPanel,\r\n      BrowserPanel,\r\n      FolderBrowser,\r\n      ErrorPanel,\r\n      SettingsPanel,\r\n      SplashPage,\r\n      TabbedDashboardView,\r\n    },\r\n    plugins\r\n  ),\r\n  data: () => {\r\n    return {\r\n      // panels is an array of arrays: each row, with its vizes in order.\r\n      panels: [] as any[][],\r\n      leftSections: ['BrowserPanel', 'ErrorPanel', 'SettingsPanel'],\r\n      // scrollbars for dashboards and kebab-case name of any plugins that need them:\r\n      panelsWithScrollbars: ['TabbedDashboardView', 'FolderBrowser', 'calc-table'],\r\n      zoomed: false,\r\n      isEmbedded: false,\r\n      fullScreenPanel: { x: -1, y: -1 },\r\n      activeLeftSection: { name: 'Files', class: 'BrowserPanel' } as Section,\r\n      leftSectionWidth: DEFAULT_LEFT_WIDTH,\r\n      isDraggingDivider: 0,\r\n      dragStartWidth: 0,\r\n      quadrant: null as any,\r\n      dragX: -1,\r\n      dragY: -1,\r\n      isDragHappening: false,\r\n      isShowingActiveSection: false,\r\n      authHandles: [] as any[],\r\n    }\r\n  },\r\n  computed: {\r\n    isMultipanel(): boolean {\r\n      if (this.panels.length > 1) return true\r\n      return this.panels[0].length > 1\r\n    },\r\n\r\n    showLeftBar(): boolean {\r\n      return this.$store.state.isShowingLeftBar\r\n    },\r\n\r\n    activeSectionStyle(): any {\r\n      if (this.activeLeftSection) {\r\n        return {\r\n          width: `${this.leftSectionWidth}px`,\r\n        }\r\n      } else return { display: 'none' }\r\n    },\r\n  },\r\n  watch: {\r\n    '$store.state.statusErrors'() {\r\n      if (this.$store.state.statusErrors.length) {\r\n        this.activeLeftSection = { name: 'Issues', class: 'ErrorPanel' }\r\n      }\r\n    },\r\n\r\n    $route(to: Route, from: Route) {\r\n      if (to.path === BASE_URL) {\r\n        // root node is not a normal splitpane, so we instead replace\r\n        // with a brand new clean startpage.\r\n        this.panels = [[{ component: 'SplashPage', key: Math.random(), props: {} as any }]]\r\n      } else {\r\n        this.buildLayoutFromURL()\r\n        globalStore.commit('resize')\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    setActiveLeftSection(props: { toggle: boolean; section: Section }) {\r\n      // don't open the left bar if it's optional, meaning it's currently closed\r\n      if (props.section.onlyIfVisible && !this.isShowingActiveSection) return\r\n\r\n      // clicked same section as is already shown\r\n      if (this.isShowingActiveSection && props.section.name === this.activeLeftSection.name) {\r\n        if (props.toggle) this.isShowingActiveSection = false\r\n        return\r\n      }\r\n\r\n      // if there's a link, open a tab\r\n      if (props.section.link) {\r\n        window.open(props.section.link, '_blank')\r\n        return\r\n      }\r\n\r\n      this.isShowingActiveSection = true\r\n      this.activeLeftSection = props.section\r\n      localStorage.setItem('activeLeftSection', JSON.stringify(props.section))\r\n      if (this.leftSectionWidth < 48) this.leftSectionWidth = DEFAULT_LEFT_WIDTH\r\n    },\r\n\r\n    buildLayoutFromURL() {\r\n      let pathMatch = this.$route.params.pathMatch\r\n      if (pathMatch.startsWith('/')) pathMatch = pathMatch.slice(1)\r\n\r\n      // splash page:\r\n      if (!pathMatch || pathMatch === '/') {\r\n        this.panels = [[{ component: 'SplashPage', key: Math.random(), props: {} as any }]]\r\n        return\r\n      }\r\n\r\n      // split panel?\r\n      if (pathMatch.startsWith('split/')) {\r\n        const payload = pathMatch.substring(6)\r\n        try {\r\n          const content = atob(payload)\r\n          const json = JSON.parse(content)\r\n          this.panels = json\r\n        } catch (e) {\r\n          // couldn't do\r\n          console.error('PARSING SPLIT' + e)\r\n          this.$router.replace('/')\r\n        }\r\n        return\r\n      }\r\n\r\n      // figure out project root and subfolder\r\n      let root = pathMatch\r\n      let xsubfolder = ''\r\n      const slash = pathMatch.indexOf('/')\r\n      if (slash > -1) {\r\n        root = pathMatch.substring(0, slash)\r\n        xsubfolder = pathMatch.substring(slash + 1)\r\n      }\r\n\r\n      // single visualization?\r\n      const fileNameWithoutPath = pathMatch.substring(1 + pathMatch.lastIndexOf('/'))\r\n      const lowerCaseFileName = fileNameWithoutPath.toLocaleLowerCase()\r\n\r\n      for (const vizPlugin of globalStore.state.visualizationTypes.values()) {\r\n        // be case insensitive for the matching itself\r\n        if (micromatch.isMatch(lowerCaseFileName, vizPlugin.filePatterns)) {\r\n          // plugin matched!\r\n          if (this.panels.length === 1 && this.panels[0].length === 1) {\r\n            this.panels = [[this.panels[0][0]]]\r\n          } else {\r\n            let key = Math.random()\r\n            this.panels = [\r\n              [\r\n                {\r\n                  key,\r\n                  component: vizPlugin.kebabName,\r\n                  title: '',\r\n                  description: '',\r\n                  props: {\r\n                    root,\r\n                    subfolder: xsubfolder.substring(0, xsubfolder.lastIndexOf('/')),\r\n                    yamlConfig: fileNameWithoutPath,\r\n                    thumbnail: false,\r\n                  } as any,\r\n                },\r\n              ],\r\n            ]\r\n          }\r\n\r\n          // this.$store.commit('setShowLeftBar', false)\r\n          return\r\n        }\r\n      }\r\n\r\n      // Last option: folder browser/dashboard panel\r\n      let key = Math.random()\r\n      if (this.panels.length === 1 && this.panels[0].length === 1) key = this.panels[0][0].key\r\n\r\n      // figure out filesystem\r\n      const svnProjects: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: any) => a.slug === root\r\n      )\r\n      if (!svnProjects.length) throw Error('no such project')\r\n      const fileSystem = svnProjects[0]\r\n\r\n      const folder = xsubfolder.startsWith('/') ? xsubfolder.slice(1) : xsubfolder\r\n      const title = `${fileSystem.name}: ${folder}`\r\n\r\n      this.panels = [\r\n        [\r\n          {\r\n            key,\r\n            title,\r\n            component: 'TabbedDashboardView',\r\n            props: { root, xsubfolder } as any,\r\n          },\r\n        ],\r\n      ]\r\n    },\r\n\r\n    handleDragStartStop(dragState: boolean) {\r\n      this.isDragHappening = dragState\r\n    },\r\n\r\n    buildDragHighlightStyle(x: number, y: number) {\r\n      // top row\r\n      if (x == -1) {\r\n        const opacity = this.quadrant == 'rowTop' ? '1' : '0'\r\n        const pointerEvents = this.isDragHappening ? 'auto' : 'none'\r\n\r\n        return { top: 0, opacity, pointerEvents, backgroundColor: '#ffcc4480' }\r\n      }\r\n\r\n      // bottom row\r\n      if (x == -2) {\r\n        const opacity = this.quadrant == 'rowBottom' ? '1' : '0'\r\n        const pointerEvents = this.isDragHappening ? 'auto' : 'none'\r\n        return { bottom: 0, opacity, pointerEvents, backgroundColor: '#ffcc4480' }\r\n      }\r\n\r\n      // tiles\r\n      if (x !== this.dragX || y !== this.dragY || !this.quadrant) return {}\r\n\r\n      const backgroundColor = this.quadrant.quadrant == 'center' ? '#079f6f80' : '#4444dd90'\r\n      const area: any = { opacity: 1.0, backgroundColor }\r\n      Object.entries(this.quadrant).forEach(e => (area[e[0]] = `${e[1]}px`))\r\n      return area\r\n    },\r\n\r\n    stillDragging(props: { event: DragEvent; x: number; y: number; row: string }) {\r\n      const { event, x, y, row } = props\r\n\r\n      // row is special\r\n      if (row) {\r\n        this.quadrant = row\r\n        return\r\n      }\r\n\r\n      this.dragX = x\r\n      this.dragY = y\r\n\r\n      const ref = this.$refs[`dragContainer${x}-${y}`] as any[]\r\n\r\n      // only parent knows its true position\r\n      const table = this.$refs['tileTable'] as any\r\n      const navOffset = table.offsetLeft\r\n\r\n      const panel = ref[0]\r\n      const pctX = (event.clientX - panel.offsetLeft - navOffset) / panel.offsetWidth\r\n      const pctY = (event.clientY - panel.offsetTop) / panel.offsetHeight\r\n\r\n      let BORDER = 8\r\n\r\n      if (pctX < 0.3) {\r\n        this.quadrant = {\r\n          quadrant: 'left',\r\n          width: panel.offsetWidth / 2 - BORDER * 2,\r\n          height: panel.offsetHeight - BORDER * 2,\r\n          marginLeft: BORDER,\r\n          marginTop: BORDER,\r\n        }\r\n      } else if (pctX > 0.7) {\r\n        this.quadrant = {\r\n          quadrant: 'right',\r\n          width: panel.offsetWidth / 2 - BORDER * 2,\r\n          height: panel.offsetHeight - BORDER * 2,\r\n          marginLeft: panel.offsetWidth / 2 + BORDER,\r\n          marginTop: BORDER,\r\n        }\r\n        // } else if (pctY < 0.4) {\r\n        //   this.quadrant = {\r\n        //     quadrant: 'top',\r\n        //     width: panel.offsetWidth - BORDER * 2,\r\n        //     height: panel.offsetHeight / 2 - BORDER * 2,\r\n        //     marginLeft: BORDER,\r\n        //     marginTop: BORDER,\r\n        //   }\r\n        // } else if (pctY > 0.6) {\r\n        //   this.quadrant = {\r\n        //     quadrant: 'bottom',\r\n        //     width: panel.offsetWidth - BORDER * 2,\r\n        //     height: panel.offsetHeight / 2 - BORDER * 2,\r\n        //     marginLeft: BORDER,\r\n        //     marginTop: panel.offsetHeight / 2 + BORDER,\r\n        //   }\r\n      } else {\r\n        BORDER *= 5\r\n        const w = (panel.offsetWidth - BORDER * 2) * 0.95\r\n        const h = (panel.offsetHeight - BORDER * 2) * 0.95\r\n        this.quadrant = {\r\n          quadrant: 'center',\r\n          width: w,\r\n          height: h,\r\n          marginLeft: (panel.offsetWidth - w) / 2,\r\n          marginTop: (panel.offsetHeight - h) / 2,\r\n        }\r\n      }\r\n    },\r\n\r\n    dragEnd() {\r\n      this.quadrant = null\r\n      this.dragX = -1\r\n      this.dragY = -1\r\n    },\r\n\r\n    onDrop(props: { event: DragEvent; x: number; y: number; row: string }) {\r\n      if (!this.quadrant) return\r\n\r\n      const { event, x, y, row } = props\r\n\r\n      try {\r\n        const bundle = event.dataTransfer?.getData('bundle') as string\r\n        const componentConfig = JSON.parse(bundle)\r\n\r\n        // dashboard is not a plugin, it is special\r\n        const component = componentConfig.component || 'TabbedDashboardView'\r\n\r\n        const viz = { component, props: componentConfig }\r\n        this.onSplit({ x, y, row, quadrant: this.quadrant.quadrant, viz })\r\n      } catch (e) {\r\n        console.warn('' + e)\r\n      }\r\n\r\n      this.dragEnd()\r\n    },\r\n\r\n    async onSplit(props: {\r\n      x: number\r\n      y: number\r\n      row: string\r\n      quadrant: string\r\n      viz: { component: string; props: any }\r\n    }) {\r\n      const { x, y, row, quadrant, viz } = props\r\n\r\n      const newPanel = {\r\n        component: viz.component,\r\n        props: viz.props,\r\n        title: '',\r\n        description: '',\r\n        key: Math.random(),\r\n      }\r\n\r\n      if (row) {\r\n        switch (row) {\r\n          case 'rowTop':\r\n            // add new row at the top\r\n            this.panels.unshift([newPanel])\r\n            break\r\n          case 'rowBottom':\r\n            // add new row at the bottom\r\n            this.panels.push([newPanel])\r\n            break\r\n          default:\r\n            console.warn('HUH?', row)\r\n            break\r\n        }\r\n      } else {\r\n        switch (quadrant) {\r\n          case 'center':\r\n            this.panels[y][x] = newPanel\r\n            break\r\n          case 'left':\r\n            this.panels[y].splice(x, 0, newPanel)\r\n            break\r\n          case 'right':\r\n            this.panels[y].splice(x + 1, 0, newPanel)\r\n            break\r\n          default:\r\n            console.warn('TOP AND BOTTOM to be added later')\r\n            return\r\n        }\r\n      }\r\n\r\n      this.updateURL()\r\n      globalStore.commit('resize')\r\n    },\r\n\r\n    onNavigate(newPanel: { component: string; props: any }, x: number, y: number) {\r\n      if (newPanel.component === 'SplashPage') {\r\n        this.panels[y][x] = { component: 'SplashPage', props: {}, key: Math.random() }\r\n      } else {\r\n        this.panels[y][x] = Object.assign({ key: Math.random() }, newPanel)\r\n      }\r\n\r\n      this.updateURL()\r\n      this.buildLayoutFromURL()\r\n    },\r\n\r\n    onClose(x: number, y: number) {\r\n      // kill the element\r\n      this.panels[y][x].component = null\r\n\r\n      // remove the panel\r\n      this.panels[y].splice(x, 1) // at column x of row y, remove 1 item\r\n\r\n      // if whole row is empty, deal with it\r\n      if (!this.panels[y].length) {\r\n        if (this.panels.length > 1) {\r\n          // remove row y if there are other rows\r\n          this.panels.splice(y, 1)\r\n        } else {\r\n          // if EVERYTHING is empty, show the previous page\r\n          // (does this work if there is no \"previous\" page, i.e. user got here from a direct url?)\r\n          // doesn't work!\r\n          // this.$router.back()\r\n\r\n          this.panels[0].push({ component: 'SplashPage', key: Math.random(), props: {} as any })\r\n        }\r\n      }\r\n\r\n      this.updateURL()\r\n      globalStore.commit('resize')\r\n    },\r\n\r\n    onBack(x: number, y: number) {\r\n      this.panels[y][x].component = 'TabbedDashboardView'\r\n      this.panels[y][x].props.xsubfolder = this.panels[y][x].props.subfolder\r\n      delete this.panels[y][x].props.yamlConfig\r\n\r\n      this.updateURL()\r\n    },\r\n\r\n    getShowHeader(panel: any) {\r\n      // whether or not to show the panel header is a bit convoluted:\r\n      if (panel.component === 'SplashPage') return false\r\n      if (this.showLeftBar) return true\r\n      if (this.panels.length == 1 && this.panels[0].length == 1) return false\r\n      return true\r\n    },\r\n\r\n    updateURL() {\r\n      if (this.panels.length === 1 && this.panels[0].length === 1) {\r\n        const props = this.panels[0][0].props\r\n\r\n        const root = props.root || ''\r\n        const xsubfolder = props.xsubfolder || props.subfolder || ''\r\n        const yaml = props.yamlConfig || ''\r\n\r\n        if (yaml.indexOf('/') > -1) {\r\n          // a YAML from a config folder will have a path in it:\r\n          const yamlFileWithoutPath = yaml.substring(yaml.lastIndexOf('/'))\r\n          this.$router.replace(`${BASE_URL}${root}/${xsubfolder}/${yamlFileWithoutPath}`)\r\n        } else if (yaml) {\r\n          // YAML config specified\r\n          this.$router.push(`${BASE_URL}${root}/${xsubfolder}/${yaml}`)\r\n        } else {\r\n          // Just the folder and viz file itself\r\n          let finalUrl = `${BASE_URL}${root}/${xsubfolder}`\r\n          if (props.config) finalUrl += `/${props.config}`\r\n          this.$router.push(finalUrl)\r\n        }\r\n      } else {\r\n        const base64 = btoa(JSON.stringify(this.panels))\r\n        this.$router.push(`${BASE_URL}split/${base64}`)\r\n      }\r\n    },\r\n\r\n    // remove title from properties to avoid weird tooltips on components\r\n    cleanProps(props: any) {\r\n      const { title, ...propsWithoutTitle } = props\r\n      return propsWithoutTitle\r\n    },\r\n\r\n    dividerDragStart(e: MouseEvent) {\r\n      this.isDraggingDivider = e.clientX\r\n      this.dragStartWidth = this.leftSectionWidth\r\n    },\r\n\r\n    dividerDragEnd(e: MouseEvent) {\r\n      this.isDraggingDivider = 0\r\n    },\r\n\r\n    dividerDragging(e: MouseEvent) {\r\n      if (!this.isDraggingDivider) return\r\n\r\n      const deltaX = e.clientX - this.isDraggingDivider\r\n      this.leftSectionWidth = Math.max(0, this.dragStartWidth + deltaX)\r\n      localStorage.setItem('leftPanelWidth', `${this.leftSectionWidth}`)\r\n    },\r\n\r\n    setCardTitles(card: any, event: any) {\r\n      if (typeof event == 'string') {\r\n        // card.title = event // this isn't working, use Vue.set() instead\r\n        Vue.set(card, 'title', event)\r\n        card.description = ''\r\n      } else {\r\n        card.title = event.title\r\n        card.description = event.description || ''\r\n      }\r\n    },\r\n\r\n    async handleToggleInfoClicked(card: any) {\r\n      console.log('CARD INFO?', card)\r\n    },\r\n\r\n    async toggleZoom(card: any, x: number, y: number) {\r\n      console.log('ZOOM', card)\r\n      if (this.fullScreenPanel.x > -1) {\r\n        this.fullScreenPanel = { x: -1, y: -1 }\r\n      } else {\r\n        this.fullScreenPanel = { x, y }\r\n      }\r\n\r\n      // this.$emit('zoom', this.fullScreenCardId)\r\n      // // allow vue to resize everything\r\n      // await this.$nextTick()\r\n      // // tell plotly to resize everything\r\n      // this.updateDimensions(card.id)\r\n    },\r\n\r\n    updateDimensions(cardId: string) {\r\n      // const element = document.getElementById(cardId)\r\n      // if (element) {\r\n      //   const dimensions = { width: element.clientWidth, height: element.clientHeight }\r\n      //   if (this.resizers[cardId]) this.resizers[cardId](dimensions)\r\n      // }\r\n      // if (!this.isResizing) globalStore.commit('resize')\r\n    },\r\n\r\n    getTileStyle(panel: any) {\r\n      return {\r\n        overflow: this.panelsWithScrollbars.includes(panel.component) ? 'auto' : 'hidden',\r\n        // padding: '5px 5px',\r\n      }\r\n    },\r\n\r\n    getContainerStyle(panel: any, x: number, y: number) {\r\n      let style: any = {\r\n        padding: this.isMultipanel ? '5px 5px' : '0',\r\n      }\r\n\r\n      // // figure out height. If card has registered a resizer with changeDimensions(),\r\n      // // then it needs a default height (300)\r\n      // const defaultHeight = plotlyChartTypes[card.type] ? 300 : undefined\r\n      // const height = card.height ? card.height * 60 : defaultHeight\r\n\r\n      // const flex = card.width || 1\r\n\r\n      // let style: any = {\r\n      //   flex: flex,\r\n      // }\r\n\r\n      // if (height) style.minHeight = `${height}px`\r\n\r\n      if (this.fullScreenPanel.x == -1) return style\r\n\r\n      // full screen ?\r\n      if (this.fullScreenPanel.x !== x) {\r\n        style.display = 'none'\r\n      } else {\r\n        style = {\r\n          position: 'absolute',\r\n          top: 0,\r\n          bottom: 0,\r\n          left: 0,\r\n          right: 0,\r\n          margin: '5px 5px',\r\n        }\r\n      }\r\n\r\n      return style\r\n    },\r\n  },\r\n  mounted() {\r\n    // EMBEDDED MODE? We'll hide some chrome\r\n    if ('embed' in this.$route.query) this.isEmbedded = true\r\n\r\n    const width = localStorage.getItem('leftPanelWidth')\r\n    this.leftSectionWidth = width == null ? DEFAULT_LEFT_WIDTH : parseInt(width)\r\n    if (this.leftSectionWidth < 0) this.leftSectionWidth = 2\r\n\r\n    const section = localStorage.getItem('activeLeftSection')\r\n    if (section) {\r\n      try {\r\n        this.activeLeftSection = JSON.parse(section)\r\n      } catch (e) {\r\n        this.activeLeftSection = { name: 'Files', class: 'BrowserPanel' }\r\n      }\r\n    } else {\r\n      this.activeLeftSection = { name: 'Files', class: 'BrowserPanel' }\r\n    }\r\n\r\n    this.buildLayoutFromURL()\r\n  },\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n#split-screen {\r\n  display: flex;\r\n  flex-direction: row;\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n}\r\n\r\n.left-panel {\r\n  position: relative;\r\n  display: flex;\r\n  flex-direction: row;\r\n}\r\n\r\n.table-of-tiles {\r\n  position: relative;\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.tile-row {\r\n  position: relative;\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: row;\r\n}\r\n\r\n.map-tile {\r\n  grid-row: 2 / 3;\r\n  grid-column: 1 / 2;\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  overflow-y: hidden;\r\n}\r\n\r\n.drag-container {\r\n  position: relative;\r\n  flex: 1;\r\n  height: 100%;\r\n  display: grid;\r\n  grid-template-rows: auto 1fr;\r\n  grid-template-columns: 1fr;\r\n  background-color: var(--bgBrowser);\r\n}\r\n\r\n.drag-highlight {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin-left: 0px;\r\n  margin-top: 0px;\r\n  width: 100%;\r\n  height: 100%;\r\n  grid-row: 1 / 2;\r\n  grid-column: 1 / 2;\r\n  opacity: 0;\r\n  z-index: 50000;\r\n  border: 8px solid #00000000;\r\n  transition: background-color 0.2s, opacity 0.2s, height 0.2s, width 0.2s, margin-top 0.2s,\r\n    margin-left 0.2s;\r\n  transition-timing-function: ease-in;\r\n  pointer-events: none;\r\n}\r\n\r\n// .control-buttons {\r\n//   // background-color: var(--bgPanel);\r\n//   padding: 0.25rem 0.5rem;\r\n//   z-index: 250;\r\n//   grid-row: 1 / 2;\r\n//   grid-column: 1 / 2;\r\n//   display: flex;\r\n//   flex-direction: column;\r\n//   margin: 0 auto auto 0;\r\n\r\n//   a {\r\n//     color: var(--textVeryPale);\r\n//     font-size: 0.9rem;\r\n//     margin: 2px 0rem 0.1rem -4px;\r\n//     padding: 2px 4px 1px 4px;\r\n//     border-radius: 10px;\r\n//   }\r\n\r\n//   a:hover {\r\n//     color: var(--textBold);\r\n//     background-color: var(--bgHover);\r\n//   }\r\n// }\r\n\r\n.left-panel-divider {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  width: 4px;\r\n  height: 100%;\r\n  background-color: #00000000;\r\n  margin-right: -4px;\r\n  transition: 0.25s background-color;\r\n  z-index: 1000;\r\n}\r\n\r\n.left-panel-divider:hover {\r\n  background-color: var(--sliderThumb); // matsimBlue;\r\n  transition-delay: 0.25s;\r\n  cursor: ew-resize;\r\n}\r\n\r\n.left-panel-active-section {\r\n  background-color: var(--bgBrowser);\r\n  color: white;\r\n  width: 300px;\r\n  padding: 0 0rem 0 0.25rem;\r\n}\r\n\r\n.row-drop-target {\r\n  position: absolute;\r\n  width: 100%;\r\n  height: 48px;\r\n  opacity: 0;\r\n  z-index: 60000;\r\n  transition: background-color 0.2s, opacity 0.2s, height 0.2s, width 0.2s, margin-top 0.2s;\r\n}\r\n\r\n.tile-labels {\r\n  flex: 1;\r\n  grid-row: 1 / 2;\r\n  grid-column: 1 / 2;\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-left: 5px;\r\n\r\n  h3 {\r\n    font-size: 1.1rem;\r\n    line-height: 1rem;\r\n    margin: 4px 0 5px 0;\r\n    color: var(--textFancy);\r\n  }\r\n  p {\r\n    margin-top: -0.5rem;\r\n    margin-bottom: 0.5rem;\r\n  }\r\n}\r\n\r\n.tile-buttons {\r\n  display: flex;\r\n  flex-direction: row;\r\n  // margin-right: 5px;\r\n  margin-left: auto;\r\n  color: var(--textFancy);\r\n}\r\n\r\n.nav-button {\r\n  opacity: 0.3;\r\n  margin-right: 0px;\r\n  i {\r\n    font-size: 0.8rem;\r\n    padding: 0px 6px;\r\n  }\r\n}\r\n\r\n.nav-button:hover {\r\n  background-color: #ffffff20;\r\n  opacity: 1;\r\n  cursor: pointer;\r\n}\r\n.nav-button:hover .fa-expand {\r\n  color: var(--linkHover);\r\n}\r\n.nav-button:hover .fa-times-circle {\r\n  color: red;\r\n}\r\n\r\n.tile-header {\r\n  user-select: none;\r\n  background-color: var(--bgDashboardHeader);\r\n  padding: 1px 0px;\r\n}\r\n\r\n.authorization-strip {\r\n  z-index: 10000;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background-color: #ffc;\r\n  border: 2px solid blue;\r\n  border-left: 1rem solid blue;\r\n  margin: 0.25rem;\r\n  padding: 0.5rem;\r\n  filter: $filterShadow;\r\n}\r\n\r\n.auth-row {\r\n  display: flex;\r\n}\r\n</style>\r\n","\r\n#split-screen(\r\n  @mousemove=\"dividerDragging\"\r\n  @mouseup=\"dividerDragEnd\"\r\n  :style=\"{'userSelect': isDraggingDivider ? 'none' : 'unset'}\"\r\n)\r\n  .left-panel(v-show=\"showLeftBar\")\r\n    left-icon-panel(\r\n      :activeSection=\"activeLeftSection.name\"\r\n      @activate=\"setActiveLeftSection({section: $event, toggle:true})\"\r\n    )\r\n\r\n    .left-panel-active-section(v-show=\"isShowingActiveSection\"\r\n                               :style=\"activeSectionStyle\"\r\n    )\r\n      component(v-for=\"section of leftSections\" :key=\"section\"\r\n                :is=\"section\"\r\n                v-show=\"section==activeLeftSection.class\"\r\n                @navigate=\"onNavigate($event,0,0)\"\r\n                @activate=\"setActiveLeftSection({section: $event, toggle:false})\"\r\n                @isDragging=\"handleDragStartStop\"\r\n      )\r\n\r\n    .left-panel-divider(v-show=\"activeLeftSection\"\r\n                        @mousedown=\"dividerDragStart\"\r\n                        @mouseup=\"dividerDragEnd\"\r\n                        @mousemove.stop=\"dividerDragging\"\r\n    )\r\n\r\n  .table-of-tiles(ref=\"tileTable\")\r\n    .authorization-strip(v-if=\"authHandles.length\")\r\n      .auth-row(v-for=\"auth in authHandles\")\r\n        p.flex1 {{ '' + auth }}\r\n        b-button hello\r\n\r\n    .row-drop-target(:style=\"buildDragHighlightStyle(-1,-1)\"\r\n        @drop=\"onDrop({event: $event, row: 'rowTop'})\"\r\n        @dragover=\"stillDragging({event: $event, row: 'rowTop'})\"\r\n        @dragover.prevent\r\n        @dragenter.prevent\r\n        @dragleave=\"dragEnd\"\r\n    )\r\n\r\n    .tile-row(v-for=\"panelRow,y in panels\" :key=\"y\"\r\n        v-show=\"fullScreenPanel.y == -1 || fullScreenPanel.y == y\"\r\n    )\r\n\r\n      .drag-container(\r\n        v-for=\"panel,x in panelRow\" :key=\"panel.key\"\r\n        @drop=\"onDrop({event: $event,x,y})\"\r\n        @dragover.prevent\r\n        @dragenter.prevent\r\n        @dragover=\"stillDragging({event: $event,x,y})\"\r\n        @dragleave=\"dragEnd\"\r\n        :ref=\"`dragContainer${x}-${y}`\"\r\n        :style=\"getContainerStyle(panel,x,y)\"\r\n      )\r\n        .tile-header.flex-row(v-if=\"getShowHeader(panel)\")\r\n\r\n          .tile-labels\r\n            h3(:style=\"{textAlign: isMultipanel ? 'left' : 'center'}\") {{ panel.title }}\r\n            p(v-if=\"panel.description\") {{ panel.description }}\r\n\r\n          .tile-buttons\r\n            .nav-button.is-small.is-white(\r\n              v-if=\"panel.info\"\r\n              @click=\"handleToggleInfoClicked(panel)\"\r\n            ): i.fa.fa-info-circle\r\n            //- :title=\"infoToggle[panel.id] ? 'Hide Info':'Show Info'\"\r\n\r\n            .nav-button.is-small.is-white(\r\n              v-show=\"panels.length > 1 || panels[0].length > 1\"\r\n              @click=\"toggleZoom(panel, x, y)\"\r\n              :title=\"fullScreenPanel.x > -1 ? 'Restore':'Enlarge'\"\r\n            ): i.fa.fa-expand\r\n\r\n            .nav-button.is-small.is-white(\r\n              @click=\"onClose(x,y)\"\r\n              title=\"Close\"\r\n            ): i.fa.fa-times-circle\r\n\r\n        //- here is the actual viz component:\r\n        component.map-tile(\r\n          :is=\"panel.component\"\r\n          :style=\"getTileStyle(panel)\"\r\n          v-bind=\"cleanProps(panel.props)\"\r\n          @navigate=\"onNavigate($event,x,y)\"\r\n          @title=\"setCardTitles(panel, $event)\"\r\n          @activate=\"setActiveLeftSection({section: $event, toggle:true})\"\r\n        )\r\n\r\n        .drag-highlight(v-if=\"isDragHappening\" :style=\"buildDragHighlightStyle(x,y)\")\r\n\r\n    .row-drop-target(v-if=\"isDragHappening\" :style=\"buildDragHighlightStyle(-2,-2)\"\r\n                    @drop=\"onDrop({event: $event, row: 'rowBottom'})\"\r\n                    @dragover=\"stillDragging({event: $event, row: 'rowBottom'})\"\r\n                    @dragover.prevent\r\n                    @dragenter.prevent\r\n                    @dragleave=\"dragEnd\"\r\n    )\r\n\r\n"],"names":["DEFAULT_LIGHT_COLOR","DEFAULT_LIGHT_INTENSITY","DEFAULT_ATTENUATION","DEFAULT_LIGHT_POSITION","idCount","PointLight","constructor","props","_defineProperty","this","color","intensity","position","id","concat","type","attenuation","getAttenuation","projectedLight","__spreadValues","getProjectedLight","layer","viewport","context","coordinateSystem","coordinateOrigin","projectPosition","fromCoordinateSystem","isGeospatial","COORDINATE_SYSTEM","LNGLAT","CARTESIAN","fromCoordinateOrigin","__vue2_script$f","defineComponent","name","isRunning","Boolean","required","timeStart","Number","timeEnd","currentTime","data","pauseWhileDragging","sliderValue","sliderOptions","min","max","clickable","duration","lazy","tooltip","mounted","v","convertSecondsToClockTimeMinutes","window","addEventListener","onKeyPressed","beforeDestroy","removeEventListener","watch","methods","toggleSimulation","$emit","index","seconds","getSecondsFromSlider","hms","timeConvert","minutes","slice","hours","e","dragStart","dragEnd","dragging","value","ev","code","_vm","_h","$createElement","_c","_self","staticClass","_b","attrs","size","on","dragstart","dragend","model","callback","$$v","expression","click","__vue2_script$e","i18n","messages","en","requests","passengers","search","showhide","vehicles","routes","speed","backgroundTraffic","de","components","ToggleButton","items","Object","_v","_s","$t","_l","keys","label","key","width","labels","checked","unchecked","change","$event","domProps","innerHTML","EventParser","__publicField","Infinity","params","fileApi","HTTPFileSystem","fileSystem","boundBox","loadFiles","network","linkIdLookup","loadNetwork","filename","subfolder","vizDetails","events","streamEventFile","console","error","Error","networkFilename","replace","dataManager","getRoadNetwork","assign","projection","linkIds","forEach","link","i","Promise","resolve","reject","finishedLoadingData","totalRows2","log","timeRange","eventWorker","terminate","eventLayers","length","totalRows","range","time","MATSimEventStreamer","formatter","Intl","NumberFormat","onmessage","async","event","message","status","finished","format","Math","vehicleTrips","t0","t1","orig","source","dest","filter","trip","offset","numTrips","tripData","locO","Float32Array","fill","NaN","locD","push","postMessage","filePath","DrtRequestArcLayer$1","ArcLayer","getShaders","shaders","super","inject","initializeState","getAttributeManager","addInstanced","accessor","draw","uniforms","DrtRequestArcLayer","layerName","defaultProps","getTimeStart","getTimeEnd","searchFlag","vertShader","fragShader","noop","DEFAULT_TEXTURE_PARAMETERS","GL","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","resizeImage","ctx","imageData","height","canvas","clearRect","drawImage","getIconId","icon","url","buildRowMapping","mapping","columns","yOffset","xOffset","__spreadProps","x","y","IconManager","gl","onUpdate","onError","_loadOptions","_getIcon","_texture","_externalTexture","_mapping","_pendingCount","_autoPacking","_xOffset","_yOffset","_rowHeight","_buffer","_canvasWidth","_canvasHeight","_canvas","finalize","_a","delete","getTexture","getIconMapping","setProps","loadOptions","autoPacking","iconAtlas","iconMapping","getIcon","_updateIconAtlas","document","createElement","_updateAutoPacking","isLoaded","icons","values","cachedIcons","iterable","objectInfo","createIterable","object","sourceIndex","getDiffIcons","rowHeight","canvasHeight","buffer","canvasWidth","number","pow","ceil","log2","buildMapping","Texture2D","parameters","texture","oldWidth","oldHeight","newTexture","cloneTextureFrom","copyToTexture","targetY","resizeTexture","_loadIcons","getContext","load","ImageLoader","then","setSubImageData","generateMipmap","catch","finally","DEFAULT_COLOR","sizeScale","billboard","sizeUnits","sizeMinPixels","sizeMaxPixels","MAX_SAFE_INTEGER","alphaCutoff","iconStill","getColor","getSize","getAngle","getPixelOffset","getPathStart","getPathEnd","pickable","onIconError","compare","optional","IconLayer$1","Layer","vs","fs","modules","project32","picking","state","iconManager","_onUpdate","bind","_onError","instanceTimestamps","instanceTimestampsNext","instanceStartPositions","instanceEndPositions","instanceSizes","transition","defaultValue","instanceOffsets","transform","getInstanceOffset","instanceIconFrames","getInstanceIconFrame","instanceColorModes","UNSIGNED_BYTE","getInstanceColorMode","instanceColors","colorFormat","normalized","instanceAngles","instancePixelOffset","updateState","oldProps","changeFlags","attributeManager","iconMappingChanged","internalState","isAsyncPropLoading","dataChanged","updateTriggersChanged","all","invalidate","extensionsChanged","_getModel","invalidateAll","finalizeState","iconsTexture","setUniforms","iconsTextureDim","metersPerPixel","iconStillOffsets","iconStillFrames","Model","geometry","Geometry","drawMode","TRIANGLE_FAN","attributes","positions","isInstanced","setNeedsRedraw","evt","getCurrentLayer","rect","anchorX","anchorY","mask","IconLayer","getBOffsets","getBIconFrames","getBColorModes","PathTraceLayer","LineLayer","ICON_MAPPING","marker","info","vehicle","diamond","DEFAULT_THEME","vehicleColor","trailColor0","trailColor1","effects","LightingEffect","AmbientLight","pointLight","DRT_REQUEST","MyComponent","CollapsiblePanel","SettingsPanel","LegendColors","regStyle","display","mobileStyle","boxSizing","float","marginRight","listItems","map","item","style","mobile","margin","fontWeight","marginTop","backgroundColor","React","textAlign","fontSize","title","description","listStyle","padding","TripViz","simulationTime","paths","traces","drtRequests","settingsShowLayers","center","dark","vehicleLookup","searchEnabled","onClick","viewId","trafficLayers","theme","viewState","setViewState","useState","longitude","latitude","pitch","bearing","zoom","globalStore","REACT_VIEW_HANDLES","hoverInfo","setHoverInfo","exports","layers","layerIndex","outOfRange","MovingVehiclesLayer","iconMoving","opacity","shadowEnabled","depthTest","autoHighlight","highlightColor","visible","getSourcePosition","d","p0","getTargetPosition","p1","colors","occ","getWidth","widthMinPixels","rounded","onHover","MovingIconsLayer","noAlloc","DrtRequestLayer","getSourceColor","getTargetColor","DeckGL","pickingRadius","controller","getCursor","onViewStateChange","commit","StaticMap","mapStyle","getters","mapboxApiAccessToken","MAPBOX_TOKEN","hoverInfo2","vehicleId","className","borderLeft","boxShadow","left","top","renderTooltip","PlaybackControls","ZoomButtons","root","String","yamlConfig","config","thumbnail","computed","svnProject","$store","svnProjects","a","slug","urlThumbnail","thumbnailUrl","textColor","myState","colorScheme","ColorScheme","DarkMode","text","bg","COLOR_OCCUPANCY","floor","random","SETTINGS","legendItems","LegendItemType","line","legendRequests","drtTrips","mapIsIndependent","eventBlobs","statusMessage","clock","isShowingHelp","crossfilter","traceStart","traceEnd","traceVehicle","pathStart","pathEnd","pathVehicle","requestStart","requestEnd","requestVehicle","timeElapsedSinceLastFrame","searchTerm","globalState","isDarkMode","showHelp","speedStops","legendBits","isEmbedded","vehicleLookupString","isPausedDueToHiding","buildRouteFromUrl","getVizDetails","updateLegendColors","vehicleNumber","filterExact","_d","filterAll","_e","_f","_g","updateDatasetFilters","setEmbeddedMode","setWallClock","trips","parseVehicles","dimension","parseRouteTraces","parseDrtRequests","loadBackgroundTraffic","handleVisibilityChange","Date","now","animate","handleClick","vehId","arrayBufferToBase64","binary","bytes","Uint8Array","len","byteLength","fromCharCode","btoa","hour","minute","setTime","$options","allFiltered","blobFilename","loadBackgroundChunk","parser","DashboardDataManager","exportJSON","gzipFetcher","GzipFetcher","blob","Blob","blobURL","URL","createObjectURL","element","setAttribute","body","appendChild","removeChild","$route","query","handleSettingChange","project","pathMatch","sep","lastIndexOf","substring","indexOf","text2","getFileText","YAML","parse","err","needPassword","jump","t","buildThumbnail","getFileBlob","readBlob","arraybuffer","base64","request","allTrips","vehNumber","coroutines.forEachAsync","forEachAsync","path","timestamps","elapsed","requestAnimationFrame","hidden","nextTime","segments","segment","endsWith","json","getFileJson","blobString","blobToBinaryString","coroutines.run","run","pako","inflateAsync","to","JSON","toggleLoaded","loaded","rotateColors","LightMode","localStorage","setItem","kebabName","prettyName","filePatterns","component","class","background","oncontextmenu","direction","dotSize","val","Controller","parent","property","widgetTag","_disabled","_hidden","initialValue","getValue","domElement","classList","add","$name","nextNameID","$widget","$disable","children","controllers","$children","_listenCallback","_name","onChange","_onChange","_callOnChange","call","_changed","onFinishChange","_onFinishChange","_callOnFinishChange","reset","setValue","enable","enabled","disable","disabled","toggle","toggleAttribute","show","hide","options","destroy","step","decimals","listen","_listening","_listenCallbackID","cancelAnimationFrame","curValue","save","_listenPrevValue","updateDisplay","splice","BooleanController","$input","normalizeColorString","string","match","result","parseInt","toString","padStart","STRING","isPrimitive","fromHexString","toHexString","INT","ARRAY","Array","isArray","target","rgbScale","int","r","g","b","OBJECT","FORMATS","ColorController","$text","$display","_format","find","_rgbScale","_initialValueHexString","_textFocused","_setValueFromHexString","tryParse","select","newValue","FunctionController","$button","preventDefault","passive","NumberController","_initInput","stepExplicit","_getImplicitStep","_decimals","_min","_onUpdateMinMax","_max","explicit","_step","_stepExplicit","_hasSlider","percent","$fill","_inputFocused","toFixed","increment","delta","parseFloat","isNaN","_snapClampSetValue","initClientX","initClientY","prevClientY","initValue","dragDelta","testingForVerticalDrag","onMouseMove","dx","clientX","dy","clientY","abs","blur","_setDraggingStyle","onMouseUp","_arrowKeyMultiplier","_snap","_clamp","_normalizeMouseWheel","_initSlider","$slider","insertBefore","setValueFromX","getBoundingClientRect","right","c","mouseMove","mouseUp","prevClientX","testingForScroll","beginTouchDrag","touches","onTouchMove","onTouchEnd","callOnFinishChange","wheelFinishChangeTimeout","_hasScrollBar","deltaX","deltaY","clearTimeout","setTimeout","active","axis","_hasMin","_hasMax","wheelDelta","mult","shiftKey","altKey","round","toPrecision","scrollHeight","clientHeight","OptionController","$select","_values","_names","$option","selectedIndex","remove","StringController","stylesInjected","GUI","autoPlace","container","injectStyles","touchStyles","folders","_closed","$title","openAnimated","cssContent","injected","before","querySelector","head","_injectStyles","setProperty","stopPropagation","$1","addColor","addFolder","obj","recursive","f","_title","open","close","initialHeight","onTransitionEnd","targetHeight","controllersRecursive","parentElement","from","foldersRecursive","DRAGTYPE","DRAGTYPE2","__vue2_script$d","activeTimeExtent","isAnimating","componentWidth","dragStartX","dragType","isDragging","isSetupComplete","leftPosition","rightPosition","datasetRange","resizer","fullDatasetTimeSpan","extentLeftToRight","hasNonZeroTimeRange","calculateActiveMargins","usableWidth","marginLeft","getDimensions","setupInitialValues","setupResizer","updateExtent","updateLabels","emitValues","ResizeObserver","sliderElement","getElementById","observe","start","end","$refs","slider","clientWidth","durationWidth","offsetX","currentExtent","newLeft","newRight","directives","rawName","ref","mousemove","mousedown","mouseup","apply","arguments","dataFilter","DataFilterExtension","filterSize","INITIAL_VIEW","loading","sorting","aggregate","maxHeight","showDetails","selection","areas","count","promptCRS","DrawingTool","EventMap","timeFilter","breakpoints","radius","getTooltip","allLayers","times","ScatterplotLayer","getFilterValue","getPosition","extensions","filled","filterRange","getRadius","getFillColor","radiusScale","stroked","updateTriggers","BASE_URL","useDevicePixels","handleViewState","view","preventStyleDiffing","LegendBox","TimeSlider","datamanager","myDataManager","guiConfig","buckets","exponent","flip","colorRamps","configId","timeLabels","startTime","legendStore","standaloneYAMLconfig","file","YAMLrequirementsXY","columnLookup","gzipWorker","animator","guiController","ANIMATE_SPEED","animationElapsedTime","animationClockTime","handleTimeSliderValues","timeValues","setupLogoMover","moveLogo","deckmap","logo","setupGui","setColors","solveProjection","validateYAML","RegExp","test","loadStandaloneYAMLConfig","setConfigForRawCSV","setVizDetails","Status","ERROR","msg","desc","configuration","WARNING","arrayBuffer","util","linkEvents","row","setFirstZoom","coordinates","rows","isFinite","toggleAnimation","EXPONENT","colors256","colormap","nshades","alpha","reverse","max2","raw","breakpoint","setLegend","LegendStore","setLegendSection","section","column","rgb","dataArray","span","h","m","s","$i18n","warn","corner","timeExtent","drag","__vue2_script$c","ambientLight","VueSlider","autocomplete","placeholder","input","composing","Component","TopSheet","allConfigFiles","dashboards","topsheets","vizes","configs","files","findAllYamlConfigs","getDirectory","src","tag","fileSystemConfig","yaml","cardTitle","cardId","movieSource","playerOptions","muted","language","playbackRates","preload","responsive","fluid","playsInline","controls","sources","getFileSystem","buildMovieSource","baseURL","generateBreadcrumbs","filesystem","crumbs","subfolders","split","buildFolder","folder","loop","allowfullscreen","autoplay","href","matsimPngTitles","dataUrl","dataurl","newTitle","zthumbnail","ScatterplotColorBinsLayer","MAX_COLORS","instanceValue","uniformColors","uniformBreakpoints","combinedUniforms","numBreakpoints","XyTimeDeckMap","pointLayers","layerId","humanTime","html","points","parseCSVFile","XytDataParser","needCRS","userCRS","prompt","toUpperCase","filepath","getChromePermission","handle","plugins","Summary","AggregateOd","Events","AreaMap","Network","Transit","CarrierViewer","Hexagons","Sankey","Plotly","VegaLite","VehicleView","XYT","VidPlayer","ImageView","XmasKelheim","Flowmap","_typeof","Symbol","iterator","obj2","prototype","_setPrototypeOf","o","p","setPrototypeOf","o2","p2","__proto__","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","valueOf","_construct","Parent","args","Class","Parent2","args2","Class2","instance","Function","_toConsumableArray","arr","_arrayLikeToArray","_arrayWithoutHoles","iter","_iterableToArray","minLen","n","_unsupportedIterableToArray","TypeError","_nonIterableSpread","arr2","hasOwnProperty","isFrozen","getPrototypeOf","getOwnPropertyDescriptor","freeze","seal","create","_ref","fun","thisValue","Func","func","arrayForEach","unapply","arrayPop","pop","arrayPush","stringToLowerCase","toLowerCase","stringMatch","stringReplace","stringIndexOf","stringTrim","trim","regExpTest","typeErrorCreate","_len2","_key2","thisArg","_len","_key","addToSet","set2","array","transformCaseFunc","l","lcElement","clone","newObject","lookupGetter","prop","get","html$1","svg$1","svgFilters","svgDisallowed","mathMl$1","mathMlDisallowed","svg","mathMl","xml","MUSTACHE_EXPR","ERB_EXPR","DATA_ATTR","ARIA_ATTR","IS_ALLOWED_URI","IS_SCRIPT_OR_DATA","ATTR_WHITESPACE","DOCTYPE_NAME","getGlobal","_createTrustedTypesPolicy","trustedTypes","document2","createPolicy","suffix","ATTR_NAME","currentScript","hasAttribute","getAttribute","policyName","createHTML","html2","createScriptURL","scriptUrl","_","purify","createDOMPurify","window2","DOMPurify","version","removed","nodeType","isSupported","originalDocument","DocumentFragment","HTMLTemplateElement","Node","Element","NodeFilter","_window$NamedNodeMap","NamedNodeMap","MozNamedAttrMap","HTMLFormElement","DOMParser","ElementPrototype","cloneNode","getNextSibling","getChildNodes","getParentNode","template","content","ownerDocument","trustedTypesPolicy","emptyHTML","_document","implementation","createNodeIterator","createDocumentFragment","getElementsByTagName","importNode","documentMode","hooks","createHTMLDocument","PARSER_MEDIA_TYPE","MUSTACHE_EXPR$1","ERB_EXPR$1","DATA_ATTR$1","ARIA_ATTR$1","IS_SCRIPT_OR_DATA$1","ATTR_WHITESPACE$1","IS_ALLOWED_URI$1","ALLOWED_TAGS","DEFAULT_ALLOWED_TAGS","ALLOWED_ATTR","DEFAULT_ALLOWED_ATTR","CUSTOM_ELEMENT_HANDLING","tagNameCheck","writable","configurable","enumerable","attributeNameCheck","allowCustomizedBuiltInElements","FORBID_TAGS","FORBID_ATTR","ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","SAFE_FOR_TEMPLATES","WHOLE_DOCUMENT","SET_CONFIG","FORCE_BODY","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_TRUSTED_TYPE","SANITIZE_DOM","SANITIZE_NAMED_PROPS","SANITIZE_NAMED_PROPS_PREFIX","KEEP_CONTENT","IN_PLACE","USE_PROFILES","FORBID_CONTENTS","DEFAULT_FORBID_CONTENTS","DATA_URI_TAGS","DEFAULT_DATA_URI_TAGS","URI_SAFE_ATTRIBUTES","DEFAULT_URI_SAFE_ATTRIBUTES","MATHML_NAMESPACE","SVG_NAMESPACE","HTML_NAMESPACE","NAMESPACE","IS_EMPTY_INPUT","SUPPORTED_PARSER_MEDIA_TYPES","DEFAULT_PARSER_MEDIA_TYPE","CONFIG","formElement","isRegexOrFunction","testValue","_parseConfig","cfg","ADD_URI_SAFE_ATTR","ADD_DATA_URI_TAGS","ALLOWED_URI_REGEXP","ADD_TAGS","ADD_ATTR","table","tbody","MATHML_TEXT_INTEGRATION_POINTS","HTML_INTEGRATION_POINTS","COMMON_SVG_AND_HTML_ELEMENTS","ALL_SVG_TAGS","ALL_MATHML_TAGS","_checkValidNamespace","tagName","namespaceURI","parentTagName","_forceRemove","node","parentNode","outerHTML","_2","_removeAttribute","attribute","getAttributeNode","removeAttribute","_initDocument","dirty","doc","leadingWhitespace","matches","dirtyPayload","parseFromString","documentElement","createDocument","createTextNode","childNodes","_createIterator","SHOW_ELEMENT","SHOW_COMMENT","SHOW_TEXT","_isClobbered","elm","nodeName","textContent","_isNode","_executeHook","entryPoint","currentNode","hook","_sanitizeElements","allowedTags","hasChildNodes","firstElementChild","_basicCustomElementTest","_isValidAttribute","lcTag","lcName","_sanitizeAttributes","attr","hookEvent","attrName","attrValue","keepAttr","allowedAttributes","_attr","forceKeepAttr","getAttributeType","setAttributeNS","_sanitizeShadowDOM","fragment","shadowNode","shadowIterator","nextNode","_sanitizeShadowDOM2","sanitize","importedNode","oldNode","returnNode","toStaticHTML","firstChild","nodeIterator","shadowroot","serializedHTML","doctype","setConfig","clearConfig","isValidAttribute","addHook","hookFunction","removeHook","removeHooks","removeAllHooks","_extends","isNode","selector","isSvg","image","currentSrc","substr","getImagesFromSelector","NodeList","isPrototypeOf","isNodeList","querySelectorAll","createOverlay","overlay","cloneTarget","_template$getBounding","clone2","scrollTop","pageYOffset","scrollLeft","pageXOffset","createCustomEvent","eventParams","bubbles","cancelable","detail","CustomEvent","customEvent","createEvent","initCustomEvent","css2","insertAt","styleSheet","cssText","styleInject","mediumZoom$1","Promise2","fn","noop2","_handleClick","images","_handleScroll","original","currentScroll","zoomOptions","scrollOffset","_handleKeyUp","keyCode","update","options2","newOptions","dispatchEvent","mediumZoom2","attach","selectors","newImages","reduce","imagesAccumulator","currentSelector","newImage","eventListeners","_ref2","listener","detach","zoomed","imagesToDetach","off","eventListener","_animate","bottom","viewportWidth","viewportHeight","_zoomContainer$getBou","_width","_height","_left","_top","zoomTarget","zoomedHd","naturalWidth","naturalHeight","_zoomTarget$getBoundi","scaleX","scaleY","scale","_images","_handleOpenEnd2","onerror","clearInterval","getZoomTargetSize","setInterval","complete","loadEventListener","_handleCloseEnd2","_ref3","getOptions","getImages","getZoomedImage","__vue2_script$b","filesUpdated","findTopsheetsForThisFolder","sheet","tabColors","hexagons","sankey","summary","transit","__vue2_script$a","Maps","Images","Analysis","Files","Folders","Topsheet","TopsheetsFinder","xsubfolder","summaryYamlFilename","mdRenderer","markdown","linkify","typographer","errorStatus","isLoading","readme","svnRoot","vizImages","vizMaps","maps","cleanName","decodeURIComponent","clickedVisualization","vizNumber","viz","updateTitle","showReadme","toLocaleLowerCase","render","buildShowEverythingView","visualizationTypes","micromatch","nocase","buildCuratedSummaryView","summaryYaml","vizName","pattern","findMatchingFiles","glob","subsubfolder","contents","fetchFolderContents","folderContents","dirs","startsWith","sort","mergedFilesAndVizes","allVizes","eeee","statusText","openOutputFolder","getTabColor","updateRoute","$nextTick","mediumZoom","_vm$myState","_vm$myState$svnProjec","fade","entries","NO_DASHBOARDS","__vue2_script$9","DashBoard","FolderBrowser","dashboardDataManager","isZoomed","styleElement","loadErrorMessage","activeTab","pageHeader","folderReadme","header","footer","customCSS","dashboardTabWithDelay","showFooter","wiide","isFullWidth","dashWidthCalculator","dashboardWidth","maxWidth","clearStyles","getPageHeader","onNavigate","getFolderReadme","readmes","readmeText","findConfigsAndDashboards","showDashboards","NO_DASHBOARDS$1","fullPath","Vue","set","tab","initDashboard","userSupplied","userTab","setupProjectConfig","yamlFolder","hideLeftBar","fullWidth","css","buildPanel","handleRemoveDashboard","which","locale","triggerPattern","allContents","shortFilename","clearCache","switchTab","$router","handleZoom","handleLayoutComplete","goUpOneFolder","authorizeAfterError","requestPermission","mode","setTitle","staticStyle","layoutComplete","navigate","up","__vue2_script$8","openProjectPage","destination","openProjectTab","metaKey","ctrlKey","button","_m","logos","__vue2_script$6","tagLine","privacy","FileSystemProjects","InfoBottom","allRoots","allLogos","isChrome","showDirectoryPicker","localFileHandles","updateShortcuts","roots","configureSources","clickedOnFolder","clickedBrowseChromeLocalFolder","fileSystems","addLocalFilesystem","showChromeDirectory","FileSystemDirectoryHandle","dir","clickedDelete","filtered","breadcrumbs","flex","__vue2_script$5","activeSection","topSections","colorize","bottomSections","issueColor","statusErrors","statusWarnings","buttonStyle","colorizedOpacity","draggable","__vue2_script$4","sync","lang","showDescription","descriptionIndexListWarning","descriptionIndexListError","isError","clearAllButtons","headerTextColor","cleanError","onlyIfVisible","toggleShowDescription","includes","expanded","__vue2_script$3","labelField","urlField","noteField","notes","mdParser","MarkdownIt","fixField","isValidURL","addURL","KEY","existingRoot","getItem","stringify","replaceAll","maxlength","carriers","__vue2_script$2","AddDataSource","highlightedViz","needDoubleClickHint","clicks","clickTimer","setupHints","getRootAndRoute","authenticationChanged","filesChanged","hasDashboards","skipList","Map","hints","clickedBreadcrumb","crumb","slash","activateVisualization","cleanSubfolder","findAllConfigsAndDashboards","lastSlash","handleSingleClickFolder","xprops","bundle","dataTransfer","setData","clickedLogo","allConfigs","upfolder","highlighted","__vue2_script$1","translate","light","dataSources","addDataSources","shortcuts","setupShortcuts","isLight","borderColor","isDark","isEN","isDE","storedShortcuts","deleteShortcut","setTheme","setLanguage","$root","outlined","__vue2_script","back","LeftIconPanel","BrowserPanel","ErrorPanel","SplashPage","TabbedDashboardView","panels","leftSections","panelsWithScrollbars","fullScreenPanel","activeLeftSection","leftSectionWidth","isDraggingDivider","dragStartWidth","quadrant","dragX","dragY","isDragHappening","isShowingActiveSection","authHandles","isMultipanel","showLeftBar","isShowingLeftBar","activeSectionStyle","buildLayoutFromURL","setActiveLeftSection","payload","atob","fileNameWithoutPath","lowerCaseFileName","vizPlugin","isMatch","key2","handleDragStartStop","dragState","buildDragHighlightStyle","pointerEvents","area","stillDragging","navOffset","offsetLeft","panel","pctX","offsetWidth","offsetTop","offsetHeight","BORDER","w","onDrop","getData","componentConfig","onSplit","newPanel","unshift","updateURL","onClose","onBack","getShowHeader","yamlFileWithoutPath","finalUrl","cleanProps","__objRest","dividerDragStart","dividerDragEnd","dividerDragging","setCardTitles","card","handleToggleInfoClicked","toggleZoom","updateDimensions","getTileStyle","overflow","getContainerStyle","userSelect","activate","auth","drop","dragover","dragenter","dragleave","panelRow","refInFor"],"mappings":"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"}